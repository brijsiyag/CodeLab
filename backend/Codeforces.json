[
  {
    "name": "Robot Factory",
    "question_id": "robot-factory",
    "question": "You have received data from a Bubble bot. You know your task is to make factory facilities, but before you even start, you need to know how big the factory is and how many rooms it has. When you look at the data you see that you have the dimensions of the construction, which is in rectangle shape: N x M. Then in the next N lines you have M numbers. These numbers represent factory tiles and they can go from 0 to 15. Each of these numbers should be looked in its binary form. Because from each number you know on which side the tile has walls. For example number 10 in it's binary form is 1010, which means that it has a wall from the North side, it doesn't have a wall from the East, it has a wall on the South side and it doesn't have a wall on the West side. So it goes North, East, South, West. It is guaranteed that the construction always has walls on it's edges. The input will be correct. Your task is to print the size of the rooms from biggest to smallest. ",
    "input_details": "The first line has two numbers which are N and M, the size of the construction. Both are integers: n (1  n  10^3)m (1  m  10^3)Next N x M numbers represent each tile of construction.",
    "output_details": "Once you finish processing the data your output consists of one line sorted from biggest to smallest room sizes. ",
    "sample_input": "4 5\n9 14 11 12 13\n5 15 11 6 7\n5 9 14 9 14\n3 2 14 3 14",
    "sample_output": "9 4 4 2 1",
    "tags": ["bitmasks", "dfs and similar", "*1400"]
  },
  {
    "name": "Party Organization",
    "question_id": "party-organization",
    "question": "On the great island of Baltia, there live N people, numbered from 1 to N. There are exactly M pairs of people that are friends with each other. The people of Baltia want to organize a successful party, but they have very strict rules on what a party is and when the party is successful. On the island of Baltia, a party is a gathering of exactly 5 people. The party is considered to be successful if either all the people at the party are friends with each other (so that they can all talk to each other without having to worry about talking to someone they are not friends with) or no two people at the party are friends with each other (so that everyone can just be on their phones without anyone else bothering them). Please help the people of Baltia organize a successful party or tell them that it's impossible to do so.",
    "input_details": "The first line contains two integer numbers, N (5  N  2*10^5) and M (0  M  2*10^5) – the number of people that live in Baltia, and the number of friendships. The next M lines each contains two integers U_i and V_i (1  U_i,V_i  N) – meaning that person U_i is friends with person V_i. Two friends can not be in the list of friends twice (no pairs are repeated) and a person can be friends with themselves (U_i \\ne V_i).",
    "output_details": "If it's possible to organize a successful party, print 5 numbers indicating which 5 people should be invited to the party. If it's not possible to organize a successful party, print -1 instead. If there are multiple successful parties possible, print any.",
    "sample_input": "6 3\n1 4\n4 2\n5 4",
    "sample_output": "1 2 3 5 6",
    "tags": ["brute force", "math", "probabilities", "*2300"]
  },
  {
    "name": "Array Game",
    "question_id": "array-game",
    "question": "Alice and Bob are playing a game. They are given an array A of length N. The array consists of integers. They are building a sequence together. In the beginning, the sequence is empty. In one turn a player can remove a number from the left or right side of the array and append it to the sequence. The rule is that the sequence they are building must be strictly increasing. The winner is the player that makes the last move. Alice is playing first. Given the starting array, under the assumption that they both play optimally, who wins the game?",
    "input_details": "The first line contains one integer N (1  N  2*10^5) - the length of the array A.The second line contains N integers A_1, A_2,...,A_N (0  A_i  10^9)",
    "output_details": "The first and only line of output consists of one string, the name of the winner. If Alice won, print \"Alice\", otherwise, print \"Bob\".",
    "sample_input": "1\n5",
    "sample_output": "Alice",
    "tags": ["games", "greedy", "two pointers", "*1900"]
  },
  {
    "name": "Bob's Beautiful Array",
    "question_id": "bobs-beautiful-array",
    "question": "Bob really likes playing with arrays of numbers. That's why for his birthday, his friends bought him a really interesting machine – an array beautifier. The array beautifier takes an array A consisting of N integers, and it outputs a new array B of length N that it constructed based on the array given to it. The array beautifier constructs the new array in the following way: it takes two numbers at different indices from the original array and writes their sum to the end of the new array. It does this step N times - resulting in an output array of length N. During this process, the machine can take the same index multiple times in different steps. Bob was very excited about the gift that his friends gave him, so he put his favorite array in the machine. However, when the machine finished, Bob was not happy with the resulting array. He misses his favorite array very much, and hopes to get it back. Given the array that the machine outputted, help Bob find an array that could be the original array that he put in the machine. Sometimes the machine makes mistakes, so it is possible that no appropriate input array exists for the array it has outputted. In such case, let Bob know that his array is forever lost.",
    "input_details": "The first line contains one positive integer N (2  N  10^3) – the length of Bob's array.The second line contains N integers B_1, B_2, ..., B_N (1  B_i  10^6) – the elements of the array the machine outputted.",
    "output_details": "If an appropriate input array exists, print \"YES\", followed by the input array A_1, A_2, ..., A_N (-10^9  A_i  10^9) in the next line. Otherwise, print \"NO\".",
    "sample_input": "2\n5 5",
    "sample_output": "YES\n2 3",
    "tags": ["bitmasks", "brute force", "greedy", "*2600"]
  },
  {
    "name": "Desert",
    "question_id": "desert",
    "question": "You are given an undirected graph of N nodes and M edges, E_1, E_2, \\dots E_M.A connected graph is a cactus if each of it's edges belogs to at most one simple cycle. A graph is a desert if each of it's connected components is a cactus. Find the number of pairs (L, R), (1  L  R  M) such that, if we delete all the edges except for E_L, E_{L+1}, \\dots E_R, the graph is a desert. ",
    "input_details": "The first line contains two integers N and M (2  N  2.5 \\times 10^5, 1  M  5 \\times 10^5). Each of the next M lines contains two integers. The i-th line describes the i-th edge. It contains integers U_i and V_i, the nodes connected by the i-th edge (E_i=(U_i, V_i)). It is guaranteed that 1  U_i, V_i  N and U_i  V_i. ",
    "output_details": "The output contains one integer number – the answer.",
    "sample_input": "5 6\n1 2\n2 3\n3 4\n4 5\n5 1\n2 4",
    "sample_output": "20",
    "tags": ["data structures", "graphs", "*2700"]
  },
  {
    "name": "Hidden Fortress",
    "question_id": "hidden-fortress",
    "question": "This is an interactive problem!As part of your contribution in the Great Bubble War, you have been tasked with finding the newly built enemy fortress. The world you live in is a giant 10^9 \\times 10^9 grid, with squares having both coordinates between 1 and 10^9. You know that the enemy base has the shape of a rectangle, with the sides parallel to the sides of the grid. The people of your world are extremely scared of being at the edge of the world, so you know that the base doesn't contain any of the squares on the edges of the grid (the x or y coordinate being 1 or 10^9). To help you locate the base, you have been given a device that you can place in any square of the grid, and it will tell you the manhattan distance to the closest square of the base. The manhattan distance from square (a, b) to square (p, q) is calculated as |a−p|+|b−q|. If you try to place the device inside the enemy base, you will be captured by the enemy. Because of this, you need to make sure to never place the device inside the enemy base. Unfortunately, the device is powered by a battery and you can't recharge it. This means that you can use the device at most 40 times. ",
    "input_details": "The input contains the answers to your queries. ",
    "output_details": "ctionYour code is allowed to place the device on any square in the grid by writing \"? i j\" (1  i,j  10^9). In return, it will recieve the manhattan distance to the closest square of the enemy base from square (i,j) or -1 if the square you placed the device on is inside the enemy base or outside the grid. If you recieve -1 instead of a positive number, exit immidiately and you will see the wrong answer verdict. Otherwise, you can get an arbitrary verdict because your solution will continue to read from a closed stream.Your solution should use no more than 40 queries. Once you are sure where the enemy base is located, you should print \"! x y p q\" (1  x  p 10^9, 1  y  q 10^9), where (x, y) is the square inside the enemy base with the smallest x and y coordinates, and (p, q) is the square inside the enemy base with the largest x and y coordinates. Note that answering doesn't count as one of the 40 queries.After printing a query or printing the answer, do not forget to output end of line and flush the output. Otherwise, you will get idleness limit exceeded. To do this, use:   fflush(stdout) or cout.flush() in C++;  System.out.flush() in Java;  flush(output) in Pascal;  stdout.flush() in Python;  See the documentation for other languages.",
    "sample_input": "1\n1\n2\n1",
    "sample_output": "? 2 2\n? 5 5\n? 4 7\n? 1 5\n! 2 3 4 5",
    "tags": ["interactive", "math", "*2100"]
  },
  {
    "name": "Shortest path",
    "question_id": "shortest-path",
    "question": "You are given N points on an infinite plane with the Cartesian coordinate system on it. N-1 points lay on one line, and one point isn't on that line. You are on point K at the start, and the goal is to visit every point. You can move between any two points in a straight line, and you can revisit points. What is the minimum length of the path? ",
    "input_details": "The first line contains two integers: N (3  N  2*10^5) - the number of points, and K (1  K  N) - the index of the starting point.Each of the next N lines contain two integers, A_i, B_i (-10^6  A_i, B_i  10^6) - coordinates of the i-th point.",
    "output_details": "The output contains one number - the shortest path to visit all given points starting from point K. The absolute difference between your solution and the main solution shouldn't exceed 10^-6;",
    "sample_input": "5 2\n0 0\n-1 1\n2 -2\n0 1\n-2 2",
    "sample_output": "7.478709",
    "tags": ["brute force", "geometry", "math", "shortest paths", "*2700"]
  },
  {
    "name": "Mars",
    "question_id": "mars",
    "question": "In the year 2420 humans have finally built a colony on Mars thanks to the work of Elon Tusk. There are 10^9+7 cities arranged in a circle in this colony and none of them are connected yet. Elon Tusk wants to connect some of those cities using only roads of the same size in order to lower the production cost of those roads. Because of that he gave a list on N cites where some cites can appear more than once and Q queries that you need to answer. For the query you need to determine if it is possible to connect all the cities from L_{i} to R_{i} on that list using only roads of length D_{i}. ",
    "input_details": "The first line contains two integers N and Q (1  N, Q  2dot10^5 ) — the length of the array of cities and the number of queries you need to answer. The second lines contains N integers representing the array of cites. Next Q lines contain three integers L, R and D (1  L_{i}, R_{i}  N, 0  D_{i}  10^9+6) — the range of cities that needs to be connected and the length of the road that you can use. ",
    "output_details": "The output contains Q lines. If it is possible to connect all the cities from the i-th query can be connected with roads of length D_{i} the i-th line should contain the word \"Yes\", otherwise it should contain the word \"No\". ",
    "sample_input": "9 8\n17 0 12 6 10 8 2 4 5\n2 3 12\n2 3 6\n2 4 6\n4 6 2\n2 8 2\n1 2 17\n1 8 2\n9 9 14",
    "sample_output": "Yes\nNo\nYes\nYes\nYes\nYes\nNo\nYes",
    "tags": ["hashing", "*2700"]
  },
  {
    "name": "Two Arrays",
    "question_id": "two-arrays",
    "question": "You are given two integer arrays of length N, A1 and A2. You are also given Q queries of 4 types: 1 k l r x: set Ak_i:=min(Ak_i, x) for each l  i  r.2 k l r x: set Ak_i:=max(Ak_i, x) for each l  i  r.3 k l r x: set Ak_i:=Ak_i+x for each l  i  r.4 l r: find the (\\sum_{i=l}^r F(A1_i+A2_i)) \\% (10^9+7) where F(k) is the k-th Fibonacci number (F(0)=0, F(1)=1, F(k)=F(k-1)+F(k-2)), and x \\% y denotes the remainder of the division of x by y.You should process these queries and answer each query of the fourth type.",
    "input_details": "The first line contains two integers N and Q. (1  N, Q  5 \\times 10^4) The second line contains N integers, array A1_1, A1_2, \\dots A1_N. (0  A1_i  10^6)The third line contains N integers, array A2_1, A2_2, \\dots A2_N. (0  A2_i  10^6)The next Q lines describe the queries. Each line contains 5 or 3 integers, where the first integer denotes the type of the query. (k \\in \\{1, 2\\}, 1  l  r  N)For queries of type 1 and 2, 0  x  10^9 holds.For queries of type 3, −10^6  x  10^6 holds.It is guaranteed that after every query each number in arrays A1 and A2 will be nonnegative. ",
    "output_details": "Print the answer to each query of the fourth type, in separate lines. ",
    "sample_input": "3 4\n1 0 2\n2 1 0\n4 1 3\n3 2 2 2 3\n1 1 1 3 0\n4 1 3",
    "sample_output": "4\n4",
    "tags": ["data structures", "matrices", "*3200"]
  },
  {
    "name": "Bubble Popping",
    "question_id": "bubble-popping",
    "question": "There are N bubbles in a coordinate plane. Bubbles are so tiny that it can be assumed that each bubble is a point (X_i, Y_i). Q Bubble Cup finalists plan to play with the bubbles. Each finalist would link to use infinitely long Bubble Cup stick to pop some bubbles. The i-th finalist would like to place the stick in the direction of vector (dxi, dyi), and plays the following game until K_i bubbles are popped. The game starts with finalist placing the stick in the direction of vector (dx_i, dy_i), and sweeping it from the infinity to the left until it hits some bubble, which is immediately popped. It is guaranteed that only one bubble will be hit in this step. After that the finalist starts rotating the stick in the counter clockwise direction with the center of rotation in point where the previous bubble was popped. When the next bubble is hit, it is immediately popped and becomes the new center of rotation. The process continues until K_i bubbles have been popped. It is guaranteed that the stick won't hit two bubbles simultaneously in this process. For each finalist find which bubble would be popped the last. Note that each game starts with the configuration of all N bubbles, so the games don't depend on the previous games. ",
    "input_details": "The first line contains one integer N — the number of bubbles. (1  N  10^5)Each of the next N lines contains two integers. The i-th line contains integers X_i and Y_i — the coordinates of the i-th bubble. (-10^9  X_i, Y_i  10^9, (X_i, Y_i)  (X_j, Y_j) for i  j)The next line contains one integer Q — the number of finalists willing to play with the bubbles. (1  Q  10^5)Each of the next Q lines contains 3 integers. The i-th line contains integers dx_i, dy_i and K_i. (-10^9  dx_i, dy_i  10^9, 1  K_i  N)",
    "output_details": "For each of the Q finalists, print the index of the bubble which would be popped last, in the separate line. ",
    "sample_input": "4\n0 0\n1 0\n0 1\n1 1\n2\n1 -1 3\n-1 1 4",
    "sample_output": "4\n2",
    "tags": ["*3200"]
  },
  {
    "name": "Bubble Strike",
    "question_id": "bubble-strike",
    "question": "Little Johnny Bubbles enjoys spending hours in front of his computer playing video games. His favorite game is Bubble Strike, fast-paced bubble shooting online game for two players.Each game is set in one of the N maps, each having different terrain configuration. First phase of each game decides on which map the game will be played. The game system randomly selects three maps and shows them to the players. Each player must pick one of those three maps to be discarded. The game system then randomly selects one of the maps that were not picked by any of the players and starts the game.Johnny is deeply enthusiastic about the game and wants to spend some time studying maps, thus increasing chances to win games played on those maps. However, he also needs to do his homework, so he does not have time to study all the maps. That is why he asked himself the following question: \"What is the minimum number of maps I have to study, so that the probability to play one of those maps is at least P\"?Can you help Johnny find the answer for this question? You can assume Johnny's opponents do not know him, and they will randomly pick maps.",
    "input_details": "The first line contains two integers N (3  N  10^{3}) and P (0  P  1) – total number of maps in the game and probability to play map Johnny has studied. P will have at most four digits after the decimal point.",
    "output_details": "Output contains one integer number – minimum number of maps Johnny has to study.",
    "sample_input": "7 1.0000",
    "sample_output": "6",
    "tags": [
      "combinatorics",
      "math",
      "probabilities",
      "ternary search",
      "*2000"
    ]
  },
  {
    "name": "Restaurant Game",
    "question_id": "restaurant-game",
    "question": "Alice and Bob always had hard time choosing restaurant for the dinner. Previously they performed Eenie Meenie Miney Mo game, but eventually as their restaurant list grew, they had to create a new game. This new game starts as they write restaurant names on N cards and align the cards in one line. Before the game begins, they both choose starting card and starting direction they are going to. They take turns in order one after another. After each turn, they move one card in their current direction. If they reach the end or beginning of the line of cards they change direction. Once they meet in a card, the card is marked for removal and is removed the first moment they both leave the card.  Example of how card is removed They repeat this process until there is only one restaurant card left. Since there are a lot of restaurant cards, they are bored to simulate this process over and over and need your help to determine the last card that remains. Can you help them? ",
    "input_details": "The first line of the input is one integer T (1  T  10^{4}) representing number of test cases. Each test case contains 3 lines: The first line contains an integer N representing initial number of cards. Next line contains two integer values A,B (0  A, B < N, 2  N  10^{18}) representing starting 0-based index of the card in the array. Last line contains two strings D_A, D_B \\in {\"left\", \"right\"} representing starting direction of their movement.",
    "output_details": "The output contains T integer number – the 0-based index of the last card that remains for every test case in order.",
    "sample_input": "1\n4\n0 1\nleft right",
    "sample_output": "0",
    "tags": ["*3100"]
  },
  {
    "name": "Weights",
    "question_id": "weights",
    "question": "You are given an array A of length N weights of masses A_1, A_2...A_N. No two weights have the same mass. You can put every weight on one side of the balance (left or right). You don't have to put weights in order A_1,...,A_N. There is also a string S consisting of characters \"L\" and \"R\", meaning that after putting the i-th weight (not A_i, but i-th weight of your choice) left or right side of the balance should be heavier. Find the order of putting the weights on the balance such that rules of string S are satisfied. ",
    "input_details": "The first line contains one integer N (1  N  2*10^5) - the length of the array A The second line contains N distinct integers: A_1, A_2,...,A_N (1  A_i  10^9) - the weights given The third line contains string S of length N consisting only of letters \"L\" and \"R\" - string determining which side of the balance should be heavier after putting the i-th weight of your choice",
    "output_details": "The output contains N lines. In every line, you should print one integer and one letter - integer representing the weight you are putting on the balance in that move and the letter representing the side of the balance where you are putting the weight. If there is no solution, print -1.",
    "sample_input": "5\n3 8 2 13 7\nLLRLL",
    "sample_output": "3 L\n2 R\n8 R\n13 L\n7 L",
    "tags": ["constructive algorithms", "greedy", "two pointers", "*2600"]
  },
  {
    "name": "The Sum of Good Numbers",
    "question_id": "the-sum-of-good-numbers",
    "question": "Let's call a positive integer good if there is no digit 0 in its decimal representation.For an array of a good numbers a, one found out that the sum of some two neighboring elements is equal to x (i.e. x = a_i + a_{i + 1} for some i). x had turned out to be a good number as well.Then the elements of the array a were written out one after another without separators into one string s. For example, if a = [12, 5, 6, 133], then s = 1256133.You are given a string s and a number x. Your task is to determine the positions in the string that correspond to the adjacent elements of the array that have sum x. If there are several possible answers, you can print any of them.",
    "input_details": "The first line contains the string s (2  |s|  5 dot 10^5).The second line contains an integer x (2  x < 10^{200000}).An additional constraint on the input: the answer always exists, i.e you can always select two adjacent substrings of the string s so that if you convert these substrings to integers, their sum is equal to x.",
    "output_details": "In the first line, print two integers l_1, r_1, meaning that the first term of the sum (a_i) is in the string s from position l_1 to position r_1.In the second line, print two integers l_2, r_2, meaning that the second term of the sum (a_{i + 1}) is in the string s from position l_2 to position r_2.",
    "sample_input": "1256133\n17",
    "sample_output": "1 2\n3 3",
    "tags": ["hashing", "math", "string suffix structures", "strings", "*3200"]
  },
  {
    "name": "RBS",
    "question_id": "rbs",
    "question": "A bracket sequence is a string containing only characters \"(\" and \")\". A regular bracket sequence (or, shortly, an RBS) is a bracket sequence that can be transformed into a correct arithmetic expression by inserting characters \"1\" and \"+\" between the original characters of the sequence. For example:  bracket sequences \"()()\" and \"(())\" are regular (the resulting expressions are: \"(1)+(1)\" and \"((1+1)+1)\");  bracket sequences \")(\", \"(\" and \")\" are not. Let's denote the concatenation of two strings x and y as x+y. For example, \"()()\" + \")(\" = \"()())(\".You are given n bracket sequences s_1, s_2, \\dots, s_n. You can rearrange them in any order (you can rearrange only the strings themselves, but not the characters in them).Your task is to rearrange the strings in such a way that the string s_1 + s_2 + \\dots + s_n has as many non-empty prefixes that are RBS as possible.",
    "input_details": "The first line contains a single integer n (1  n  20).Then n lines follow, the i-th of them contains s_i — a bracket sequence (a string consisting of characters \"(\" and/or \")\". All sequences s_i are non-empty, their total length does not exceed 4 dot 10^5.",
    "output_details": "Print one integer — the maximum number of non-empty prefixes that are RBS for the string s_1 + s_2 + \\dots + s_n, if the strings s_1, s_2, \\dots, s_n can be rearranged arbitrarily.",
    "sample_input": "2\n(\n)",
    "sample_output": "1",
    "tags": [
      "binary search",
      "bitmasks",
      "brute force",
      "data structures",
      "dp",
      "*2400"
    ]
  },
  {
    "name": "Staircases",
    "question_id": "staircases",
    "question": "You are given a matrix, consisting of n rows and m columns. The rows are numbered top to bottom, the columns are numbered left to right.Each cell of the matrix can be either free or locked.Let's call a path in the matrix a staircase if it:   starts and ends in the free cell;  visits only free cells;  has one of the two following structures:   the second cell is 1 to the right from the first one, the third cell is 1 to the bottom from the second one, the fourth cell is 1 to the right from the third one, and so on;  the second cell is 1 to the bottom from the first one, the third cell is 1 to the right from the second one, the fourth cell is 1 to the bottom from the third one, and so on.  In particular, a path, consisting of a single cell, is considered to be a staircase.Here are some examples of staircases:  Initially all the cells of the matrix are free.You have to process q queries, each of them flips the state of a single cell. So, if a cell is currently free, it makes it locked, and if a cell is currently locked, it makes it free.Print the number of different staircases after each query. Two staircases are considered different if there exists such a cell that appears in one path and doesn't appear in the other path.",
    "input_details": "The first line contains three integers n, m and q (1  n, m  1000; 1  q  10^4) — the sizes of the matrix and the number of queries.Each of the next q lines contains two integers x and y (1  x  n; 1  y  m) — the description of each query.",
    "output_details": "Print q integers — the i-th value should be equal to the number of different staircases after i queries. Two staircases are considered different if there exists such a cell that appears in one path and doesn't appear in the other path.",
    "sample_input": "2 2 8\n1 1\n1 1\n1 1\n2 2\n1 1\n1 2\n2 1\n1 1",
    "sample_output": "5\n10\n5\n2\n5\n3\n1\n0",
    "tags": [
      "brute force",
      "combinatorics",
      "data structures",
      "dfs and similar",
      "dp",
      "implementation",
      "math",
      "*2100"
    ]
  },
  {
    "name": "Training Session",
    "question_id": "training-session",
    "question": "Monocarp is the coach of the Berland State University programming teams. He decided to compose a problemset for a training session for his teams.Monocarp has n problems that none of his students have seen yet. The i-th problem has a topic a_i (an integer from 1 to n) and a difficulty b_i (an integer from 1 to n). All problems are different, that is, there are no two tasks that have the same topic and difficulty at the same time.Monocarp decided to select exactly 3 problems from n problems for the problemset. The problems should satisfy at least one of two conditions (possibly, both):  the topics of all three selected problems are different;  the difficulties of all three selected problems are different. Your task is to determine the number of ways to select three problems for the problemset.",
    "input_details": "The first line contains a single integer t (1  t  50000) — the number of testcases.The first line of each testcase contains an integer n (3  n  2 dot 10^5) — the number of problems that Monocarp have.In the i-th of the following n lines, there are two integers a_i and b_i (1  a_i, b_i  n) — the topic and the difficulty of the i-th problem.It is guaranteed that there are no two problems that have the same topic and difficulty at the same time.The sum of n over all testcases doesn't exceed 2 dot 10^5.",
    "output_details": "Print the number of ways to select three training problems that meet either of the requirements described in the statement.",
    "sample_input": "2\n4\n2 4\n3 4\n2 1\n1 3\n5\n1 5\n2 4\n3 3\n4 2\n5 1",
    "sample_output": "3\n10",
    "tags": [
      "combinatorics",
      "data structures",
      "geometry",
      "implementation",
      "math",
      "*1700"
    ]
  },
  {
    "name": "Delete Two Elements",
    "question_id": "delete-two-elements",
    "question": "Monocarp has got an array a consisting of n integers. Let's denote k as the mathematic mean of these elements (note that it's possible that k is not an integer). The mathematic mean of an array of n elements is the sum of elements divided by the number of these elements (i. e. sum divided by n).Monocarp wants to delete exactly two elements from a so that the mathematic mean of the remaining (n - 2) elements is still equal to k.Your task is to calculate the number of pairs of positions [i, j] (i < j) such that if the elements on these positions are deleted, the mathematic mean of (n - 2) remaining elements is equal to k (that is, it is equal to the mathematic mean of n elements of the original array a).",
    "input_details": "The first line contains a single integer t (1  t  10^4) — the number of testcases.The first line of each testcase contains one integer n (3  n  2 dot 10^5) — the number of elements in the array.The second line contains a sequence of integers a_1, a_2, \\dots, a_n (0  a_i  10^{9}), where a_i is the i-th element of the array.The sum of n over all testcases doesn't exceed 2 dot 10^5.",
    "output_details": "Print one integer — the number of pairs of positions [i, j] (i < j) such that if the elements on these positions are deleted, the mathematic mean of (n - 2) remaining elements is equal to k (that is, it is equal to the mathematic mean of n elements of the original array a).",
    "sample_input": "4\n4\n8 8 8 8\n3\n50 20 10\n5\n1 4 7 3 5\n7\n1 2 3 4 5 6 7",
    "sample_output": "6\n0\n2\n3",
    "tags": [
      "data structures",
      "dp",
      "implementation",
      "math",
      "two pointers",
      "*1200"
    ]
  },
  {
    "name": "Groups",
    "question_id": "groups",
    "question": "n students attended the first meeting of the Berland SU programming course (n is even). All students will be divided into two groups. Each group will be attending exactly one lesson each week during one of the five working days (Monday, Tuesday, Wednesday, Thursday and Friday), and the days chosen for the groups must be different. Furthermore, both groups should contain the same number of students.Each student has filled a survey in which they told which days of the week are convenient for them to attend a lesson, and which are not. Your task is to determine if it is possible to choose two different week days to schedule the lessons for the group (the first group will attend the lesson on the first chosen day, the second group will attend the lesson on the second chosen day), and divide the students into two groups, so the groups have equal sizes, and for each student, the chosen lesson day for their group is convenient.",
    "input_details": "The first line contains a single integer t (1  t  10^4) — the number of testcases.Then the descriptions of t testcases follow.The first line of each testcase contains one integer n (2  n  1\\,000) — the number of students.The i-th of the next n lines contains 5 integers, each of them is 0 or 1. If the j-th integer is 1, then the i-th student can attend the lessons on the j-th day of the week. If the j-th integer is 0, then the i-th student cannot attend the lessons on the j-th day of the week. Additional constraints on the input: for each student, at least one of the days of the week is convenient, the total number of students over all testcases doesn't exceed 10^5.",
    "output_details": "For each testcase print an answer. If it's possible to divide the students into two groups of equal sizes and choose different days for the groups so each student can attend the lesson in the chosen day of their group, print \"YES\" (without quotes). Otherwise, print \"NO\" (without quotes). ",
    "sample_input": "2\n4\n1 0 0 1 0\n0 1 0 0 1\n0 0 0 1 0\n0 1 0 1 0\n2\n0 0 0 1 0\n0 0 0 1 0",
    "sample_output": "YES\nNO",
    "tags": ["brute force", "implementation", "*1000"]
  },
  {
    "name": "Computer Game",
    "question_id": "computer-game",
    "question": "Monocarp is playing a computer game. Now he wants to complete the first level of this game.A level is a rectangular grid of 2 rows and n columns. Monocarp controls a character, which starts in cell (1, 1) — at the intersection of the 1-st row and the 1-st column.Monocarp's character can move from one cell to another in one step if the cells are adjacent by side and/or corner. Formally, it is possible to move from cell (x_1, y_1) to cell (x_2, y_2) in one step if |x_1 - x_2|  1 and |y_1 - y_2|  1. Obviously, it is prohibited to go outside the grid.There are traps in some cells. If Monocarp's character finds himself in such a cell, he dies, and the game ends.To complete a level, Monocarp's character should reach cell (2, n) — at the intersection of row 2 and column n.Help Monocarp determine if it is possible to complete the level.",
    "input_details": "The first line contains a single integer t (1  t  100) — the number of test cases. Then the test cases follow. Each test case consists of three lines.The first line contains a single integer n (3  n  100) — the number of columns.The next two lines describe the level. The i-th of these lines describes the i-th line of the level — the line consists of the characters '0' and '1'. The character '0' corresponds to a safe cell, the character '1' corresponds to a trap cell.Additional constraint on the input: cells (1, 1) and (2, n) are safe.",
    "output_details": "For each test case, output YES if it is possible to complete the level, and NO otherwise.",
    "sample_input": "4\n3\n000\n000\n4\n0011\n1100\n4\n0111\n1110\n6\n010101\n101010",
    "sample_output": "YES\nYES\nNO\nYES",
    "tags": ["brute force", "dfs and similar", "dp", "implementation", "*800"]
  },
  {
    "name": "Ideal Farm",
    "question_id": "ideal-farm",
    "question": "Theofanis decided to visit his uncle's farm. There are s animals and n animal pens on the farm. For utility purpose, animal pens are constructed in one row.Uncle told Theofanis that a farm is lucky if you can distribute all animals in all pens in such a way that there are no empty pens and there is at least one continuous segment of pens that has exactly k animals in total.Moreover, a farm is ideal if it's lucky for any distribution without empty pens.Neither Theofanis nor his uncle knows if their farm is ideal or not. Can you help them to figure it out?",
    "input_details": "The first line contains a single integer t (1  t  10^5) — the number of test cases.The first and only line of each test case contains three integers s, n, and k (1  s, n, k  10^{18}; n  s).",
    "output_details": "For each test case, print YES (case-insensitive), if the farm is ideal, or NO (case-insensitive) otherwise.",
    "sample_input": "4\n1 1 1\n1 1 2\n100 50 200\n56220 47258 14497",
    "sample_output": "YES\nNO\nNO\nYES",
    "tags": ["constructive algorithms", "math", "*2400"]
  },
  {
    "name": " Rubik's Cube Coloring (hard version)",
    "question_id": "rubiks-cube-coloring-hard-version",
    "question": "It is the hard version of the problem. The difference is that in this version, there are nodes with already chosen colors.Theofanis is starving, and he wants to eat his favorite food, sheftalia. However, he should first finish his homework. Can you help him with this problem?You have a perfect binary tree of 2^k - 1 nodes — a binary tree where all vertices i from 1 to 2^{k - 1} - 1 have exactly two children: vertices 2i and 2i + 1. Vertices from 2^{k - 1} to 2^k - 1 don't have any children. You want to color its vertices with the 6 Rubik's cube colors (White, Green, Red, Blue, Orange and Yellow).Let's call a coloring good when all edges connect nodes with colors that are neighboring sides in the Rubik's cube.  A picture of Rubik's cube and its 2D map. More formally:   a white node can not be neighboring with white and yellow nodes;  a yellow node can not be neighboring with white and yellow nodes;  a green node can not be neighboring with green and blue nodes;  a blue node can not be neighboring with green and blue nodes;  a red node can not be neighboring with red and orange nodes;  an orange node can not be neighboring with red and orange nodes; However, there are n special nodes in the tree, colors of which are already chosen.You want to calculate the number of the good colorings of the binary tree. Two colorings are considered different if at least one node is colored with a different color.The answer may be too large, so output the answer modulo 10^9+7.",
    "input_details": "The first line contains the integers k (1  k  60) — the number of levels in the perfect binary tree you need to color.The second line contains the integer n (1  n  \\min(2^k - 1, 2000)) — the number of nodes, colors of which are already chosen.The next n lines contains integer v (1  v  2^k - 1) and string s — the index of the node and the color of the node (s is one of the white, yellow, green, blue, red and orange).It is guaranteed that each node v appears in the input at most once.",
    "output_details": "Print one integer — the number of the different colorings modulo 10^9+7.",
    "sample_input": "3\n2\n5 orange\n2 white",
    "sample_output": "1024",
    "tags": ["brute force", "dp", "implementation", "math", "trees", "*2300"]
  },
  {
    "name": " Rubik's Cube Coloring (easy version)",
    "question_id": "rubiks-cube-coloring-easy-version",
    "question": "It is the easy version of the problem. The difference is that in this version, there are no nodes with already chosen colors.Theofanis is starving, and he wants to eat his favorite food, sheftalia. However, he should first finish his homework. Can you help him with this problem?You have a perfect binary tree of 2^k - 1 nodes — a binary tree where all vertices i from 1 to 2^{k - 1} - 1 have exactly two children: vertices 2i and 2i + 1. Vertices from 2^{k - 1} to 2^k - 1 don't have any children. You want to color its vertices with the 6 Rubik's cube colors (White, Green, Red, Blue, Orange and Yellow).Let's call a coloring good when all edges connect nodes with colors that are neighboring sides in the Rubik's cube.  A picture of Rubik's cube and its 2D map. More formally:   a white node can not be neighboring with white and yellow nodes;  a yellow node can not be neighboring with white and yellow nodes;  a green node can not be neighboring with green and blue nodes;  a blue node can not be neighboring with green and blue nodes;  a red node can not be neighboring with red and orange nodes;  an orange node can not be neighboring with red and orange nodes; You want to calculate the number of the good colorings of the binary tree. Two colorings are considered different if at least one node is colored with a different color.The answer may be too large, so output the answer modulo 10^9+7.",
    "input_details": "The first and only line contains the integers k (1  k  60) — the number of levels in the perfect binary tree you need to color.",
    "output_details": "Print one integer — the number of the different colorings modulo 10^9+7.",
    "sample_input": "3",
    "sample_output": "24576",
    "tags": ["combinatorics", "math", "*1300"]
  },
  {
    "name": "The Number of Imposters",
    "question_id": "the-number-of-imposters",
    "question": "Theofanis started playing the new online game called \"Among them\". However, he always plays with Cypriot players, and they all have the same name: \"Andreas\" (the most common name in Cyprus).In each game, Theofanis plays with n other players. Since they all have the same name, they are numbered from 1 to n.The players write m comments in the chat. A comment has the structure of \"i j c\" where i and j are two distinct integers and c is a string (1  i, j  n; i  j; c is either imposter or crewmate). The comment means that player i said that player j has the role c.An imposter always lies, and a crewmate always tells the truth. Help Theofanis find the maximum possible number of imposters among all the other Cypriot players, or determine that the comments contradict each other (see the notes for further explanation).Note that each player has exactly one role: either imposter or crewmate.",
    "input_details": "The first line contains a single integer t (1  t  10^4) — the number of test cases. Description of each test case follows.The first line of each test case contains two integers n and m (1  n  2 dot 10^5; 0  m  5 dot 10^5) — the number of players except Theofanis and the number of comments.Each of the next m lines contains a comment made by the players of the structure \"i j c\" where i and j are two distinct integers and c is a string (1  i, j  n; i  j; c is either imposter or crewmate).There can be multiple comments for the same pair of (i, j).It is guaranteed that the sum of all n does not exceed 2 dot 10^5 and the sum of all m does not exceed 5 dot 10^5.",
    "output_details": "For each test case, print one integer — the maximum possible number of imposters. If the comments contradict each other, print -1.",
    "sample_input": "5\n3 2\n1 2 imposter\n2 3 crewmate\n5 4\n1 3 crewmate\n2 5 crewmate\n2 4 imposter\n3 4 imposter\n2 2\n1 2 imposter\n2 1 crewmate\n3 5\n1 2 imposter\n1 2 imposter\n3 2 crewmate\n3 2 crewmate\n1 3 imposter\n5 0",
    "sample_output": "2\n4\n-1\n2\n5",
    "tags": [
      "constructive algorithms",
      "dfs and similar",
      "dp",
      "dsu",
      "graphs",
      "*1700"
    ]
  },
  {
    "name": "Make Them Equal",
    "question_id": "make-them-equal",
    "question": "Theofanis has a string s_1 s_2 \\dots s_n and a character c. He wants to make all characters of the string equal to c using the minimum number of operations.In one operation he can choose a number x (1  x  n) and for every position i, where i is not divisible by x, replace s_i with c. Find the minimum number of operations required to make all the characters equal to c and the x-s that he should use in his operations.",
    "input_details": "The first line contains a single integer t (1  t  10^4) — the number of test cases.The first line of each test case contains the integer n (3  n  3 dot 10^5) and a lowercase Latin letter c — the length of the string s and the character the resulting string should consist of.The second line of each test case contains a string s of lowercase Latin letters — the initial string.It is guaranteed that the sum of n over all test cases does not exceed 3 dot 10^5.",
    "output_details": "For each test case, firstly print one integer m — the minimum number of operations required to make all the characters equal to c.Next, print m integers x_1, x_2, \\dots, x_m (1  x_j  n) — the x-s that should be used in the order they are given.It can be proved that under given constraints, an answer always exists. If there are multiple answers, print any.",
    "sample_input": "3\n4 a\naaaa\n4 a\nbaaa\n4 b\nbzyx",
    "sample_output": "0\n1\n2\n2 \n2 3",
    "tags": ["brute force", "greedy", "math", "strings", "*1200"]
  },
  {
    "name": "Special Numbers",
    "question_id": "special-numbers",
    "question": "Theofanis really likes sequences of positive integers, thus his teacher (Yeltsa Kcir) gave him a problem about a sequence that consists of only special numbers.Let's call a positive number special if it can be written as a sum of different non-negative powers of n. For example, for n = 4 number 17 is special, because it can be written as 4^0 + 4^2 = 1 + 16 = 17, but 9 is not.Theofanis asks you to help him find the k-th special number if they are sorted in increasing order. Since this number may be too large, output it modulo 10^9+7.",
    "input_details": "The first line contains a single integer t (1  t  10^4) — the number of test cases.The first and only line of each test case contains two integers n and k (2  n  10^9; 1  k  10^9).",
    "output_details": "For each test case, print one integer — the k-th special number in increasing order modulo 10^9+7.",
    "sample_input": "3\n3 4\n2 12\n105 564",
    "sample_output": "9\n12\n3595374",
    "tags": ["bitmasks", "math", "*1100"]
  },
  {
    "name": "Consecutive Sum Riddle",
    "question_id": "consecutive-sum-riddle",
    "question": "Theofanis has a riddle for you and if you manage to solve it, he will give you a Cypriot snack halloumi for free (Cypriot cheese).You are given an integer n. You need to find two integers l and r such that -10^{18}  l < r  10^{18} and l + (l + 1) + ....... + (r - 1) + r = n.",
    "input_details": "The first line contains a single integer t (1  t  10^4) — the number of test cases.The first and only line of each test case contains a single integer n (1  n  10^{18}).",
    "output_details": "For each test case, print the two integers l and r such that -10^{18}  l < r  10^{18} and l + (l + 1) + ....... + (r - 1) + r = n. It can be proven that an answer always exists. If there are multiple answers, print any.",
    "sample_input": "7\n1\n2\n3\n6\n100\n25\n3000000000000",
    "sample_output": "0 1\n-1 2 \n1 2 \n1 3 \n18 22\n-2 7\n999999999999 1000000000001",
    "tags": ["math", "*800"]
  },
  {
    "name": "Changing Brackets",
    "question_id": "changing-brackets",
    "question": "A sequence of round and square brackets is given. You can change the sequence by performing the following operations:  change the direction of a bracket from opening to closing and vice versa without changing the form of the bracket: i.e. you can change '(' to ')' and ')' to '('; you can change '[' to ']' and ']' to '['. The operation costs 0 burles. change any square bracket to round bracket having the same direction: i.e. you can change '[' to '(' but not from '(' to '['; similarly, you can change ']' to ')' but not from ')' to ']'. The operation costs 1 burle. The operations can be performed in any order any number of times.You are given a string s of the length n and q queries of the type \"l r\" where 1  l < r  n. For every substring s[l \\dots r], find the minimum cost to pay to make it a correct bracket sequence. It is guaranteed that the substring s[l \\dots r] has an even length.The queries must be processed independently, i.e. the changes made in the string for the answer to a question i don't affect the queries j (j > i). In other words, for every query, the substring s[l \\dots r] is given from the initially given string s.A correct bracket sequence is a sequence that can be built according the following rules:  an empty sequence is a correct bracket sequence;  if \"s\" is a correct bracket sequence, the sequences \"(s)\" and \"[s]\" are correct bracket sequences.  if \"s\" and \"t\" are correct bracket sequences, the sequence \"st\" (the concatenation of the sequences) is a correct bracket sequence. E.g. the sequences \"\", \"(()[])\", \"[()()]()\" and \"(())()\" are correct bracket sequences whereas \"(\", \"[(])\" and \")))\" are not.",
    "input_details": "The first line contains one integer t (1  t  100) — the number of test cases. Then t test cases follow.For each test case, the first line contains a non-empty string s containing only round ('(', ')') and square ('[', ']') brackets. The length of the string doesn't exceed 10^6. The string contains at least 2 characters.The second line contains one integer q (1  q  2 dot 10^5) — the number of queries.Then q lines follow, each of them contains two integers l and r (1  l < r  n where n is the length of s). It is guaranteed that the substring s[l \\dots r] has even length.It is guaranteed that the sum of the lengths of all strings given in all test cases doesn't exceed 10^6. The sum of all q given in all test cases doesn't exceed 2 dot 10^5.",
    "output_details": "For each test case output in a separate line for each query one integer x (x \\ge 0) — the minimum cost to pay to make the given substring a correct bracket sequence.",
    "sample_input": "3\n([))[)()][]]\n3\n1 12\n4 9\n3 6\n))))))\n2\n2 3\n1 4\n[]\n1\n1 2",
    "sample_output": "0\n2\n1\n0\n0\n0",
    "tags": [
      "constructive algorithms",
      "data structures",
      "dp",
      "greedy",
      "*2200"
    ]
  },
  {
    "name": "Red-Black Number",
    "question_id": "red-black-number",
    "question": "It is given a non-negative integer x, the decimal representation of which contains n digits. You need to color each its digit in red or black, so that the number formed by the red digits is divisible by A, and the number formed by the black digits is divisible by B.At least one digit must be colored in each of two colors. Consider, the count of digits colored in red is r and the count of digits colored in black is b. Among all possible colorings of the given number x, you need to output any such that the value of |r - b| is the minimum possible.Note that the number x and the numbers formed by digits of each color, may contain leading zeros.  Example of painting a number for A = 3 and B = 13 The figure above shows an example of painting the number x = 02165 of n = 5 digits for A = 3 and B = 13. The red digits form the number 015, which is divisible by 3, and the black ones — 26, which is divisible by 13. Note that the absolute value of the difference between the counts of red and black digits is 1, it is impossible to achieve a smaller value.",
    "input_details": "The first line contains one integer t (1  t  10) — the number of test cases. Then t test cases follow.Each test case consists of two lines. The first line contains three integers n, A, B (2  n  40, 1  A, B  40). The second line contains a non-negative integer x containing exactly n digits and probably containing leading zeroes.",
    "output_details": "For each test case, output in a separate line:  -1 if the desired coloring does not exist;  a string s of n characters, each of them is a letter 'R' or 'B'. If the i-th digit of the number x is colored in red, then the i-th character of the string s must be the letter 'R', otherwise the letter 'B'. The number formed by digits colored red should divisible by A. The number formed by digits colored black should divisible by B. The value |r-b| should be minimal, where r is the count of red digits, b is the count of black digits. If there are many possible answers, print any of them.",
    "sample_input": "4\n5 3 13\n02165\n4 2 1\n1357\n8 1 1\n12345678\n2 7 9\n90",
    "sample_output": "RBRBR\n-1\nBBRRRRBB\nBR",
    "tags": [
      "dfs and similar",
      "dp",
      "implementation",
      "math",
      "meet-in-the-middle",
      "*2100"
    ]
  },
  {
    "name": "Gardener and Tree",
    "question_id": "gardener-and-tree",
    "question": "A tree is an undirected connected graph in which there are no cycles. This problem is about non-rooted trees. A leaf of a tree is a vertex that is connected to at most one vertex.The gardener Vitaly grew a tree from n vertices. He decided to trim the tree. To do this, he performs a number of operations. In one operation, he removes all leaves of the tree.  Example of a tree. For example, consider the tree shown in the figure above. The figure below shows the result of applying exactly one operation to the tree.  The result of applying the operation \"remove all leaves\" to the tree. Note the special cases of the operation:  applying an operation to an empty tree (of 0 vertices) does not change it;  applying an operation to a tree of one vertex removes this vertex (this vertex is treated as a leaf);  applying an operation to a tree of two vertices removes both vertices (both vertices are treated as leaves). Vitaly applied k operations sequentially to the tree. How many vertices remain?",
    "input_details": "The first line contains one integer t (1  t  10^4) — the number of test cases. Then t test cases follow.Each test case is preceded by an empty line.Each test case consists of several lines. The first line of the test case contains two integers n and k (1  n  4 dot 10^5, 1  k  2 dot 10^5) — the number of vertices in the tree and the number of operations, respectively. Then n - 1 lines follow, each of them contains two integers u and v (1  u, v  n, u  v) which describe a pair of vertices connected by an edge. It is guaranteed that the given graph is a tree and has no loops or multiple edges.It is guaranteed that the sum of n from all test cases does not exceed 4 dot 10^5.",
    "output_details": "For each test case output on a separate line a single integer — the number of vertices that remain in the tree after applying k operations.",
    "sample_input": "6\n\n14 1\n1 2\n2 3\n2 4\n4 5\n4 6\n2 7\n7 8\n8 9\n8 10\n3 11\n3 12\n1 13\n13 14\n\n2 200000\n1 2\n\n3 2\n1 2\n2 3\n\n5 1\n5 1\n3 2\n2 1\n5 4\n\n6 2\n5 1\n2 5\n5 6\n4 2\n3 4\n\n7 1\n4 3\n5 1\n1 3\n6 1\n1 7\n2 1",
    "sample_output": "7\n0\n0\n3\n1\n2",
    "tags": [
      "brute force",
      "data structures",
      "dfs and similar",
      "greedy",
      "implementation",
      "trees",
      "*1600"
    ]
  },
  {
    "name": " Half of Same",
    "question_id": "half-of-same",
    "question": "This problem is a complicated version of D1, but it has significant differences, so read the whole statement.Polycarp has an array of n (n is even) integers a_1, a_2, \\dots, a_n. Polycarp conceived of a positive integer k. After that, Polycarp began performing the following operations on the array: take an index i (1  i  n) and reduce the number a_i by k.After Polycarp performed some (possibly zero) number of such operations, it turned out that at least half of the numbers in the array became the same. Find the maximum k at which such a situation is possible, or print -1 if such a number can be arbitrarily large.",
    "input_details": "The first line contains one integer t (1  t  10) — the number of test cases. Then t test cases follow.Each test case consists of two lines. The first line contains an even integer n (4  n  40) (n is even). The second line contains n integers a_1, a_2, \\dots a_n (-10^6  a_i  10^6).It is guaranteed that the sum of all n specified in the given test cases does not exceed 100.",
    "output_details": "For each test case output on a separate line an integer k (k \\ge 1) — the maximum possible number that Polycarp used in operations on the array, or -1, if such a number can be arbitrarily large.",
    "sample_input": "4\n6\n48 13 22 -15 16 35\n8\n-1 0 1 -1 0 1 -1 0\n4\n100 -1000 -1000 -1000\n4\n1 1 1 1",
    "sample_output": "13\n2\n-1\n-1",
    "tags": ["brute force", "math", "number theory", "*1900"]
  },
  {
    "name": " All are Same",
    "question_id": "all-are-same",
    "question": "This problem is a simplified version of D2, but it has significant differences, so read the whole statement.Polycarp has an array of n (n is even) integers a_1, a_2, \\dots, a_n. Polycarp conceived of a positive integer k. After that, Polycarp began performing the following operations on the array: take an index i (1  i  n) and reduce the number a_i by k.After Polycarp performed some (possibly zero) number of such operations, it turned out that all numbers in the array became the same. Find the maximum k at which such a situation is possible, or print -1 if such a number can be arbitrarily large.",
    "input_details": "The first line contains one integer t (1  t  10) — the number of test cases. Then t test cases follow.Each test case consists of two lines. The first line contains an even integer n (4  n  40) (n is even). The second line contains n integers a_1, a_2, \\dots a_n (-10^6  a_i  10^6).It is guaranteed that the sum of all n specified in the given test cases does not exceed 100.",
    "output_details": "For each test case output on a separate line an integer k (k \\ge 1) — the maximum possible number that Polycarp used in operations on the array, or -1, if such a number can be arbitrarily large.",
    "sample_input": "3\n6\n1 5 3 1 1 5\n8\n-1 0 1 -1 0 1 -1 0\n4\n100 -1000 -1000 -1000",
    "sample_output": "2\n1\n1100",
    "tags": ["math", "number theory", "*1100"]
  },
  {
    "name": "Save More Mice",
    "question_id": "save-more-mice",
    "question": "There are one cat, k mice, and one hole on a coordinate line. The cat is located at the point 0, the hole is located at the point n. All mice are located between the cat and the hole: the i-th mouse is located at the point x_i (0 < x_i < n). At each point, many mice can be located.In one second, the following happens. First, exactly one mouse moves to the right by 1. If the mouse reaches the hole, it hides (i.e. the mouse will not any more move to any point and will not be eaten by the cat). Then (after that the mouse has finished its move) the cat moves to the right by 1. If at the new cat's position, some mice are located, the cat eats them (they will not be able to move after that). The actions are performed until any mouse hasn't been hidden or isn't eaten.In other words, the first move is made by a mouse. If the mouse has reached the hole, it's saved. Then the cat makes a move. The cat eats the mice located at the pointed the cat has reached (if the cat has reached the hole, it eats nobody).Each second, you can select a mouse that will make a move. What is the maximum number of mice that can reach the hole without being eaten?",
    "input_details": "The first line contains one integer t (1  t  10^4) — the number of test cases. Then t test cases follow.Each test case consists of two lines. The first line contains two integers n and k (2  n  10^9, 1  k  4 dot 10^5). The second line contains k integers x_1, x_2, \\dots x_k (1  x_i < n) — the initial coordinates of the mice.It is guaranteed that the sum of all k given in the input doesn't exceed 4 dot 10^5.",
    "output_details": "For each test case output on a separate line an integer m (m \\ge 0) — the maximum number of mice that can reach the hole without being eaten.",
    "sample_input": "3\n10 6\n8 7 5 4 9 4\n2 8\n1 1 1 1 1 1 1 1\n12 11\n1 2 3 4 5 6 7 8 9 10 11",
    "sample_output": "3\n1\n4",
    "tags": ["binary search", "greedy", "greedy", "*1000"]
  },
  {
    "name": "Make it Divisible by 25",
    "question_id": "make-it-divisible-by-25",
    "question": "It is given a positive integer n. In 1 move, one can select any single digit and remove it (i.e. one selects some position in the number and removes the digit located at this position). The operation cannot be performed if only one digit remains. If the resulting number contains leading zeroes, they are automatically removed.E.g. if one removes from the number 32925 the 3-rd digit, the resulting number will be 3225. If one removes from the number 20099050 the first digit, the resulting number will be 99050 (the 2 zeroes going next to the first digit are automatically removed).What is the minimum number of steps to get a number such that it is divisible by 25 and positive? It is guaranteed that, for each n occurring in the input, the answer exists. It is guaranteed that the number n has no leading zeros.",
    "input_details": "The first line contains one integer t (1  t  10^4) — the number of test cases. Then t test cases follow.Each test case consists of one line containing one integer n (25  n  10^{18}). It is guaranteed that, for each n occurring in the input, the answer exists. It is guaranteed that the number n has no leading zeros.",
    "output_details": "For each test case output on a separate line an integer k (k \\ge 0) — the minimum number of steps to get a number such that it is divisible by 25 and positive.",
    "sample_input": "5\n100\n71345\n3259\n50555\n2050047",
    "sample_output": "0\n3\n1\n3\n2",
    "tags": ["dfs and similar", "dp", "greedy", "math", "math", "*900"]
  },
  {
    "name": "Elections",
    "question_id": "elections",
    "question": "The elections in which three candidates participated have recently ended. The first candidate received a votes, the second one received b votes, the third one received c votes. For each candidate, solve the following problem: how many votes should be added to this candidate so that he wins the election (i.e. the number of votes for this candidate was strictly greater than the number of votes for any other candidate)?Please note that for each candidate it is necessary to solve this problem independently, i.e. the added votes for any candidate do not affect the calculations when getting the answer for the other two candidates.",
    "input_details": "The first line contains one integer t (1  t  10^4) — the number of test cases. Then t test cases follow.Each test case consists of one line containing three integers a, b, and c (0  a,b,c  10^9).",
    "output_details": "For each test case, output in a separate line three integers A, B, and C (A, B, C \\ge 0) separated by spaces — the answers to the problem for the first, second, and third candidate, respectively.",
    "sample_input": "5\n0 0 0\n10 75 15\n13 13 17\n1000 0 0\n0 1000000000 0",
    "sample_output": "1 1 1\n66 0 61\n5 5 0\n0 1001 1001\n1000000001 0 1000000001",
    "tags": ["math", "*800"]
  },
  {
    "name": " Alice and Recoloring 2",
    "question_id": "alice-and-recoloring-2",
    "question": "The difference between the versions is in the costs of operations. Solution for one version won't work for another!Alice has a grid of size n \\times m, initially all its cells are colored white. The cell on the intersection of i-th row and j-th column is denoted as (i, j). Alice can do the following operations with this grid:Choose any subrectangle containing cell (1, 1), and flip the colors of all its cells. (Flipping means changing its color from white to black or from black to white). This operation costs 1 coin.Choose any subrectangle containing cell (n, 1), and flip the colors of all its cells. This operation costs 3 coins.Choose any subrectangle containing cell (1, m), and flip the colors of all its cells. This operation costs 4 coins.Choose any subrectangle containing cell (n, m), and flip the colors of all its cells. This operation costs 2 coins. As a reminder, subrectangle is a set of all cells (x, y) with x_1  x  x_2, y_1  y  y_2 for some 1  x_1  x_2  n, 1  y_1  y_2  m.Alice wants to obtain her favorite coloring with these operations. What's the smallest number of coins that she would have to spend? It can be shown that it's always possible to transform the initial grid into any other.",
    "input_details": "The first line of the input contains 2 integers n, m (1  n, m  500) — the dimensions of the grid.The i-th of the next n lines contains a string s_i of length m, consisting of letters W and B. The j-th character of string s_i is W if the cell (i, j) is colored white in the favorite coloring of Alice, and B if it's colored black.",
    "output_details": "Output the smallest number of coins Alice would have to spend to achieve her favorite coloring.",
    "sample_input": "3 3\nWWW\nWBB\nWBB",
    "sample_output": "2",
    "tags": [
      "constructive algorithms",
      "flows",
      "graph matchings",
      "greedy",
      "*2800"
    ]
  },
  {
    "name": " Alice and Recoloring 1",
    "question_id": "alice-and-recoloring-1",
    "question": "The difference between the versions is in the costs of operations. Solution for one version won't work for another!Alice has a grid of size n \\times m, initially all its cells are colored white. The cell on the intersection of i-th row and j-th column is denoted as (i, j). Alice can do the following operations with this grid:Choose any subrectangle containing cell (1, 1), and flip the colors of all its cells. (Flipping means changing its color from white to black or from black to white). This operation costs 1 coin.Choose any subrectangle containing cell (n, 1), and flip the colors of all its cells. This operation costs 2 coins.Choose any subrectangle containing cell (1, m), and flip the colors of all its cells. This operation costs 4 coins.Choose any subrectangle containing cell (n, m), and flip the colors of all its cells. This operation costs 3 coins. As a reminder, subrectangle is a set of all cells (x, y) with x_1  x  x_2, y_1  y  y_2 for some 1  x_1  x_2  n, 1  y_1  y_2  m.Alice wants to obtain her favorite coloring with these operations. What's the smallest number of coins that she would have to spend? It can be shown that it's always possible to transform the initial grid into any other.",
    "input_details": "The first line of the input contains 2 integers n, m (1  n, m  500) — the dimensions of the grid.The i-th of the next n lines contains a string s_i of length m, consisting of letters W and B. The j-th character of string s_i is W if the cell (i, j) is colored white in the favorite coloring of Alice, and B if it's colored black.",
    "output_details": "Output the smallest number of coins Alice would have to spend to achieve her favorite coloring.",
    "sample_input": "3 3\nWWW\nWBB\nWBB",
    "sample_output": "3",
    "tags": ["constructive algorithms", "greedy", "*2600"]
  },
  {
    "name": "Bored Bakry",
    "question_id": "bored-bakry",
    "question": "Bakry got bored of solving problems related to xor, so he asked you to solve this problem for him.You are given an array a of n integers [a_1, a_2, ......., a_n].Let's call a subarray a_{l}, a_{l+1}, a_{l+2}, ......., a_r good if a_l \\, \\& \\, a_{l+1} \\, \\& \\, a_{l+2} \\, ....... \\, \\& \\, a_r > a_l \\oplus a_{l+1} \\oplus a_{l+2} ....... \\oplus a_r, where \\oplus denotes the bitwise XOR operation and \\& denotes the bitwise AND operation.Find the length of the longest good subarray of a, or determine that no such subarray exists.",
    "input_details": "The first line contains a single integer n (1  n  10^6) — the length of the array.The second line contains n integers a_1, a_2, ......., a_n (1  a_i  10^6) — elements of the array.",
    "output_details": "Print a single integer — the length of the longest good subarray. If there are no good subarrays, print 0.",
    "sample_input": "2\n5 6",
    "sample_output": "2",
    "tags": ["bitmasks", "greedy", "math", "two pointers", "*2400"]
  },
  {
    "name": "Hemose in ICPC ?",
    "question_id": "hemose-in-icpc",
    "question": "This is an interactive problem!In the last regional contest Hemose, ZeyadKhattab and YahiaSherif — members of the team Carpe Diem — did not qualify to ICPC because of some unknown reasons. Hemose was very sad and had a bad day after the contest, but ZeyadKhattab is very wise and knows Hemose very well, and does not want to see him sad.Zeyad knows that Hemose loves tree problems, so he gave him a tree problem with a very special device.Hemose has a weighted tree with n nodes and n-1 edges. Unfortunately, Hemose doesn't remember the weights of edges.Let's define Dist(u, v) for u v as the greatest common divisor of the weights of all edges on the path from node u to node v.Hemose has a special device. Hemose can give the device a set of nodes, and the device will return the largest Dist between any two nodes from the set. More formally, if Hemose gives the device a set S of nodes, the device will return the largest value of Dist(u, v) over all pairs (u, v) with u, v \\in S and u  v.Hemose can use this Device at most 12 times, and wants to find any two distinct nodes a, b, such that Dist(a, b) is maximum possible. Can you help him?",
    "input_details": "actionBegin the interaction from reading a single integer n (2  n  10^3) — the number of nodes in the tree.Next, read n-1 lines. The i-th of the next n-1 lines contains two integers u_i and v_i (1  u_i, v_i  n, u_i v_i), which means that there's an edge between nodes u_i and v_i.It's guaranteed that weights of edges were  10^9.It is guaranteed that the given graph is a tree.Now you may begin asking queries. To ask a query about a set of k nodes v_1, v_2, ......., v_k (2  k  n, 1  v_i  n, all v_i are distinct), output: ? k v_1 v_2 ....... v_kYou will then receive an integer x, the largest Dist(v_i, v_j) over 1  i, j  k with i  j.When you have found a and b (1  a, b  n), a b) such that Dist(a, b) is the maximum possible, print the answer in the following format: ! a b Outputting answer doesn't count towards the limit of 12 queries.If there are several pairs (a, b) with the same largest Dist(a, b), you can output any.After printing a query do not forget to output the end of line and flush the output. Otherwise, you will get Idleness limit exceeded. To do this, use: fflush(stdout) or cout.flush() in C++; System.out.flush() in Java; flush(output) in Pascal; stdout.flush() in Python; see the documentation for other languages.HacksTo hack a solution, use the following format.The first line should contain a single integer n (2  n  10^3) — the number of nodes.The i-th of the next n-1 lines should contain three integers u_i, v_i, w_i (1  u_i, v_i  n, u_i\\ne v_i, 1  w  10^9), which means that there's an edge between nodes u_i and v_i with weight w_i.These n-1 edges must form a tree.",
    "output_details": "eInput6\n1 2\n2 3\n2 4\n1 5\n5 6\n\n10\n\n2\n\n10Output? 6 1 2 3 4 5 6\n\n? 3 3 1 5\n\n? 2 1 2\n\n! 1 2",
    "sample_input": "t? 6 1 2 3 4 5 6\n\n? 3 3 1 5\n\n? 2 1 2\n\n! 1 2",
    "sample_output": "e tree in the first sample:",
    "tags": [
      "binary search",
      "dfs and similar",
      "implementation",
      "interactive",
      "math",
      "number theory",
      "trees",
      "*2300"
    ]
  },
  {
    "name": "Bakry and Partitioning",
    "question_id": "bakry-and-partitioning",
    "question": "Bakry faced a problem, but since he's lazy to solve it, he asks for your help.You are given a tree of n nodes, the i-th node has value a_i assigned to it for each i from 1 to n. As a reminder, a tree on n nodes is a connected graph with n-1 edges.You want to delete at least 1, but at most k-1 edges from the tree, so that the following condition would hold:For every connected component calculate the bitwise XOR of the values of the nodes in it. Then, these values have to be the same for all connected components.Is it possible to achieve this condition?",
    "input_details": "Each test contains multiple test cases. The first line contains the number of test cases t (1  t  5 dot 10^4). Description of the test cases follows.The first line of each test case contains two integers n and k (2  k  n  10^5).The second line of each test case contains n integers a_1, a_2, ..., a_n (1  a_i  10^9).The i-th of the next n-1 lines contains two integers u_i and v_i (1  u_i, v_i  n, u_i v_i), which means that there's an edge between nodes u_i and v_i.It is guaranteed that the given graph is a tree.It is guaranteed that the sum of n over all test cases doesn't exceed 2 dot 10^5.",
    "output_details": "For each test case, you should output a single string. If you can delete the edges according to the conditions written above, output \"YES\" (without quotes). Otherwise, output \"NO\" (without quotes).You can print each letter of \"YES\" and \"NO\" in any case (upper or lower).",
    "sample_input": "5\n2 2\n1 3\n1 2\n5 5\n3 3 3 3 3\n1 2\n2 3\n1 4\n4 5\n5 2\n1 7 2 3 5\n1 2\n2 3\n1 4\n4 5\n5 3\n1 6 4 1 2\n1 2\n2 3\n1 4\n4 5\n3 3\n1 7 4\n1 2\n2 3",
    "sample_output": "NO\nYES\nNO\nYES\nNO",
    "tags": [
      "bitmasks",
      "constructive algorithms",
      "dfs and similar",
      "dp",
      "graphs",
      "trees",
      "*1700"
    ]
  },
  {
    "name": "Hemose Shopping",
    "question_id": "hemose-shopping",
    "question": "Hemose was shopping with his friends Samez, AhmedZ, AshrafEzz, TheSawan and O_E in Germany. As you know, Hemose and his friends are problem solvers, so they are very clever. Therefore, they will go to all discount markets in Germany.Hemose has an array of n integers. He wants Samez to sort the array in the non-decreasing order. Since it would be a too easy problem for Samez, Hemose allows Samez to use only the following operation:Choose indices i and j such that 1  i, j  n, and \\lvert i - j \\rvert  x. Then, swap elements a_i and a_j.Can you tell Samez if there's a way to sort the array in the non-decreasing order by using the operation written above some finite number of times (possibly 0)?",
    "input_details": "Each test contains multiple test cases. The first line contains the number of test cases t (1  t  10^5). Description of the test cases follows.The first line of each test case contains two integers n and x (1  x  n  10^5).The second line of each test case contains n integers a_1, a_2, ..., a_n (1  a_i  10^9).It is guaranteed that the sum of n over all test cases doesn't exceed 2 dot 10^5.",
    "output_details": "For each test case, you should output a single string. If Samez can sort the array in non-decreasing order using the operation written above, output \"YES\" (without quotes). Otherwise, output \"NO\" (without quotes).You can print each letter of \"YES\" and \"NO\" in any case (upper or lower).",
    "sample_input": "4\n3 3\n3 2 1\n4 3\n1 2 3 4\n5 2\n5 1 2 3 4\n5 4\n1 2 3 4 4",
    "sample_output": "NO\nYES\nYES\nYES",
    "tags": ["constructive algorithms", "dsu", "math", "sortings", "*1200"]
  },
  {
    "name": "Gamer Hemose",
    "question_id": "gamer-hemose",
    "question": "One day, Ahmed_Hossam went to Hemose and said \"Let's solve a gym contest!\". Hemose didn't want to do that, as he was playing Valorant, so he came up with a problem and told it to Ahmed to distract him. Sadly, Ahmed can't solve it... Could you help him?There is an Agent in Valorant, and he has n weapons. The i-th weapon has a damage value a_i, and the Agent will face an enemy whose health value is H.The Agent will perform one or more moves until the enemy dies.In one move, he will choose a weapon and decrease the enemy's health by its damage value. The enemy will die when his health will become less than or equal to 0. However, not everything is so easy: the Agent can't choose the same weapon for 2 times in a row.What is the minimum number of times that the Agent will need to use the weapons to kill the enemy?",
    "input_details": "Each test contains multiple test cases. The first line contains the number of test cases t (1  t  10^5). Description of the test cases follows.The first line of each test case contains two integers n and H (2  n  10^3, 1  H  10^9) — the number of available weapons and the initial health value of the enemy.The second line of each test case contains n integers a_1, a_2, ......., a_n (1  a_i  10^9) — the damage values of the weapons.It's guaranteed that the sum of n over all test cases doesn't exceed 2 dot 10^5.",
    "output_details": "For each test case, print a single integer — the minimum number of times that the Agent will have to use the weapons to kill the enemy.",
    "sample_input": "3\n2 4\n3 7\n2 6\n4 2\n3 11\n2 1 7",
    "sample_output": "1\n2\n3",
    "tags": ["binary search", "greedy", "math", "sortings", "*800"]
  },
  {
    "name": "Omkar and Mosaic",
    "question_id": "omkar-and-mosaic",
    "question": "Omkar is creating a mosaic using colored square tiles, which he places in an n \\times n grid. When the mosaic is complete, each cell in the grid will have either a glaucous or sinoper tile. However, currently he has only placed tiles in some cells. A completed mosaic will be a mastapeece if and only if each tile is adjacent to exactly 2 tiles of the same color (2 tiles are adjacent if they share a side.) Omkar wants to fill the rest of the tiles so that the mosaic becomes a mastapeece. Now he is wondering, is the way to do this unique, and if it is, what is it?",
    "input_details": "The first line contains a single integer n (1  n  2000).Then follow n lines with n characters in each line. The i-th character in the j-th line corresponds to the cell in row i and column j of the grid, and will be S if Omkar has placed a sinoper tile in this cell, G if Omkar has placed a glaucous tile, . if it's empty. ",
    "output_details": "On the first line, print UNIQUE if there is a unique way to get a mastapeece, NONE if Omkar cannot create any, and MULTIPLE if there is more than one way to do so. All letters must be uppercase.If you print UNIQUE, then print n additional lines with n characters in each line, such that the i-th character in the j^{\\text{th}} line is S if the tile in row i and column j of the mastapeece is sinoper, and G if it is glaucous. ",
    "sample_input": "4\nS...\n..G.\n....\n...S",
    "sample_output": "MULTIPLE",
    "tags": ["combinatorics", "constructive algorithms", "math"]
  },
  {
    "name": "Omkar and Tours",
    "question_id": "omkar-and-tours",
    "question": "Omkar is hosting tours of his country, Omkarland! There are n cities in Omkarland, and, rather curiously, there are exactly n-1 bidirectional roads connecting the cities to each other. It is guaranteed that you can reach any city from any other city through the road network.Every city has an enjoyment value e. Each road has a capacity c, denoting the maximum number of vehicles that can be on it, and an associated toll t. However, the toll system in Omkarland has an interesting quirk: if a vehicle travels on multiple roads on a single journey, they pay only the highest toll of any single road on which they traveled. (In other words, they pay \\max t over all the roads on which they traveled.) If a vehicle traverses no roads, they pay 0 toll.Omkar has decided to host q tour groups. Each tour group consists of v vehicles starting at city x. (Keep in mind that a tour group with v vehicles can travel only on roads with capacity  v.) Being the tour organizer, Omkar wants his groups to have as much fun as they possibly can, but also must reimburse his groups for the tolls that they have to pay. Thus, for each tour group, Omkar wants to know two things: first, what is the enjoyment value of the city y with maximum enjoyment value that the tour group can reach from their starting city, and second, how much per vehicle will Omkar have to pay to reimburse the entire group for their trip from x to y? (This trip from x to y will always be on the shortest path from x to y.)In the case that there are multiple reachable cities with the maximum enjoyment value, Omkar will let his tour group choose which one they want to go to. Therefore, to prepare for all possible scenarios, he wants to know the amount of money per vehicle that he needs to guarantee that he can reimburse the group regardless of which city they choose.",
    "input_details": "The first line contains two integers n and q (2  n  2 dot 10^5, 1  q  2 dot 10^5), representing the number of cities and the number of groups, respectively.The next line contains n integers e_1, e_2, ......., e_n (1  e_i  10^9), where e_i represents the enjoyment value for city i.The next n-1 lines each contain four integers a, b, c, and t (1  a,b  n, 1  c  10^9, 1  t  10^9), representing an road between city a and city b with capacity c and toll t.The next q lines each contain two integers v and x (1  v  10^9, 1  x  n), representing the number of vehicles in the tour group and the starting city, respectively.",
    "output_details": "Output q lines. The i-th line should contain two integers: the highest possible enjoyment value of a city reachable by the i-th tour group, and the amount of money per vehicle Omkar needs to guarantee that he can reimburse the i-th tour group.",
    "sample_input": "5 3\n2 2 3 3 3\n1 2 4 7\n1 3 2 8\n2 4 8 2\n2 5 1 1\n1 3\n9 5\n6 2",
    "sample_output": "3 8\n3 0\n3 2",
    "tags": ["data structures", "divide and conquer", "sortings", "trees"]
  },
  {
    "name": "Omkar and Time Travel",
    "question_id": "omkar-and-time-travel",
    "question": "El Psy Kongroo.Omkar is watching Steins;Gate.In Steins;Gate, Okabe Rintarou needs to complete n tasks (1  n  2 dot 10^5). Unfortunately, he doesn't know when he needs to complete the tasks.Initially, the time is 0. Time travel will now happen according to the following rules:For each k = 1, 2, ......., n, Okabe will realize at time b_k that he was supposed to complete the k-th task at time a_k (a_k < b_k). When he realizes this, if k-th task was already completed at time a_k, Okabe keeps the usual flow of time. Otherwise, he time travels to time a_k.If Okabe time travels to time a_k, all tasks after this time will become incomplete again. That is, for every i, if a_i>a_k, a_i will become incomplete, if it was complete (if it was incomplete, nothing will change).Okabe has bad memory, so he can time travel to time a_k only immediately after getting to time b_k and learning that he was supposed to complete the k-th task at time a_k. That is, even if Okabe already had to perform k-th task before, he wouldn't remember it before stumbling on the info about this task at time b_k again.Please refer to the notes for an example of time travelling.There is a certain set s of tasks such that the first moment that all of the tasks in s are simultaneously completed (regardless of whether any other tasks are currently completed), a funny scene will take place. Omkar loves this scene and wants to know how many times Okabe will time travel before this scene takes place. Find this number modulo 10^9 + 7. It can be proven that eventually all n tasks will be completed and so the answer always exists.",
    "input_details": "The first line contains an integer n (1  n  2 dot 10^5)  — the number of tasks that Okabe needs to complete.n lines follow. The k-th of these lines contain two integers a_k and b_k (1  a_k < b_k  2n)  — the time at which Okabe needs to complete the k-th task and the time that he realizes this respectively. All 2n of these times are distinct (so every time from 1 to 2n inclusive appears exactly once in the input).The next line contains a single integer t (1  t  n)  — the size of the set s of tasks that lead to the funny scene.The last line contains t integers s_1, s_2, ......., s_t  — (1  s_k  n, the numbers s_1, s_2, ......., s_t are distinct)  — the set s of tasks.",
    "output_details": "Output a single integer  — the number of times that Okabe time travels until all tasks in the set s are simultaneously completed, modulo 10^9 + 7.",
    "sample_input": "2\n1 4\n2 3\n2\n1 2",
    "sample_output": "3",
    "tags": ["data structures", "math"]
  },
  {
    "name": "Defender of Childhood Dreams",
    "question_id": "defender-of-childhood-dreams",
    "question": "Even if you just leave them be, they will fall to pieces all by themselves. So, someone has to protect them, right?You find yourself playing with Teucer again in the city of Liyue. As you take the eccentric little kid around, you notice something interesting about the structure of the city.Liyue can be represented as a directed graph containing n nodes. Nodes are labeled from 1 to n. There is a directed edge from node a to node b if and only if a < b.A path between nodes a and b is defined as a sequence of edges such that you can start at a, travel along all of these edges in the corresponding direction, and end at b. The length of a path is defined by the number of edges. A rainbow path of length x is defined as a path in the graph such that there exists at least 2 distinct colors among the set of x edges.Teucer's favorite number is k. You are curious about the following scenario: If you were to label each edge with a color, what is the minimum number of colors needed to ensure that all paths of length k or longer are rainbow paths?Teucer wants to surprise his older brother with a map of Liyue. He also wants to know a valid coloring of edges that uses the minimum number of colors. Please help him with this task!",
    "input_details": "The only line of input contains two integers n and k (2  k < n  1000). ",
    "output_details": "On the first line, output c, the minimum colors you need to satisfy the above requirements.On the second line, print a valid edge coloring as an array of \\frac{n(n-1)}{2} integers ranging from 1 to c. Exactly c distinct colors should exist in the construction. Print the edges in increasing order by the start node first, then by the second node.For example, if n=4, the edge colors will correspond to this order of edges: (1, 2), (1, 3), (1, 4), (2, 3), (2, 4), (3, 4)",
    "sample_input": "5 3",
    "sample_output": "2\n1 2 2 2 2 2 2 1 1 1",
    "tags": ["bitmasks", "constructive algorithms", "divide and conquer"]
  },
  {
    "name": "Moment of Bloom",
    "question_id": "moment-of-bloom",
    "question": "She does her utmost to flawlessly carry out a person's last rites and preserve the world's balance of yin and yang.Hu Tao, being the little prankster she is, has tried to scare you with this graph problem! You are given a connected undirected graph of n nodes with m edges. You also have q queries. Each query consists of two nodes a and b.Initially, all edges in the graph have a weight of 0. For each query, you must choose a simple path starting from a and ending at b. Then you add 1 to every edge along this path. Determine if it's possible, after processing all q queries, for all edges in this graph to have an even weight. If so, output the choice of paths for each query. If it is not possible, determine the smallest number of extra queries you could add to make it possible. It can be shown that this number will not exceed 10^{18} under the given constraints.A simple path is defined as any path that does not visit a node more than once.An edge is said to have an even weight if its value is divisible by 2.",
    "input_details": "The first line contains two integers n and m (2  n  3 dot 10^5, n-1  m  \\min{ft(\\frac{n(n-1)}{2}, 3 dot 10^5\\right)}).Each of the next m lines contains two integers x and y (1  x, y  n, x y) indicating an undirected edge between node x and y. The input will not contain self-loops or duplicate edges, and the provided graph will be connected.The next line contains a single integer q (1  q  3 dot 10^5).Each of the next q lines contains two integers a and b (1  a, b  n, a  b), the description of each query.It is guaranteed that nq  3 dot 10^5.",
    "output_details": "If it is possible to force all edge weights to be even, print \"YES\" on the first line, followed by 2q lines indicating the choice of path for each query in the same order the queries are given. For each query, the first line should contain a single integer x: the number of nodes in the chosen path. The next line should then contain x spaced separated integers p_i indicating the path you take (p_1 = a, p_x = b and all numbers should fall between 1 and n). This path cannot contain duplicate nodes and must be a valid simple path in the graph.If it is impossible to force all edge weights to be even, print \"NO\" on the first line and the minimum number of added queries on the second line.",
    "sample_input": "6 7\n2 1\n2 3\n3 5\n1 4\n6 1\n5 6\n4 5\n3\n1 4\n5 1\n4 5",
    "sample_output": "YES\n2\n1 4\n4\n5 3 2 1\n5\n4 1 2 3 5",
    "tags": [
      "constructive algorithms",
      "dfs and similar",
      "graph matchings",
      "graphs",
      "greedy",
      "trees"
    ]
  },
  {
    "name": "Omkar and the Meaning of Life",
    "question_id": "omkar-and-the-meaning-of-life",
    "question": "It turns out that the meaning of life is a permutation p_1, p_2, ......., p_n of the integers 1, 2, ......., n (2  n  100). Omkar, having created all life, knows this permutation, and will allow you to figure it out using some queries.A query consists of an array a_1, a_2, ......., a_n of integers between 1 and n. a is not required to be a permutation. Omkar will first compute the pairwise sum of a and p, meaning that he will compute an array s where s_j = p_j + a_j for all j = 1, 2, ......., n. Then, he will find the smallest index k such that s_k occurs more than once in s, and answer with k. If there is no such index k, then he will answer with 0.You can perform at most 2n queries. Figure out the meaning of life p.",
    "input_details": "actionStart the interaction by reading single integer n (2  n  100)  — the length of the permutation p.You can then make queries. A query consists of a single line \"? \\enspace a_1 \\enspace a_2 \\enspace ....... \\enspace a_n\" (1  a_j  n).The answer to each query will be a single integer k as described above (0  k  n).After making a query do not forget to output end of line and flush the output. Otherwise, you will get Idleness limit exceeded. To do this, use: fflush(stdout) or cout.flush() in C++; System.out.flush() in Java; flush(output) in Pascal; stdout.flush() in Python; see documentation for other languages.To output your answer, print a single line \"! \\enspace p_1 \\enspace p_2 \\enspace ....... \\enspace p_n\" then terminate.You can make at most 2n queries. Outputting the answer does not count as a query.Hack FormatTo hack, first output a line containing n (2  n  100), then output another line containing the hidden permutation p_1, p_2, ......., p_n of numbers from 1 to n.",
    "output_details": "eInput5\n\n2\n\n0\n\n1\nOutput\n? 4 4 2 3 2\n\n? 3 5 1 5 5\n\n? 5 2 4 3 1\n\n! 3 2 1 5 4\n",
    "sample_input": "t\n? 4 4 2 3 2\n\n? 3 5 1 5 5\n\n? 5 2 4 3 1\n\n! 3 2 1 5 4",
    "sample_output": "the sample, the hidden permutation p is [3, 2, 1, 5, 4]. Three queries were made.The first query is a = [4, 4, 2, 3, 2]. This yields s = [3 + 4, 2 + 4, 1 + 2, 5 + 3, 4 + 2] = [7, 6, 3, 8, 6]. 6 is the only number that appears more than once, and it appears first at index 2, making the answer to the query 2.The second query is a = [3, 5, 1, 5, 5]. This yields s = [3 + 3, 2 + 5, 1 + 1, 5 + 5, 4 + 5] = [6, 7, 2, 10, 9]. There are no numbers that appear more than once here, so the answer to the query is 0.The third query is a = [5, 2, 4, 3, 1]. This yields s = [3 + 5, 2 + 2, 1 + 4, 5 + 3, 4 + 1] = [8, 4, 5, 8, 5]. 5 and 8 both occur more than once here. 5 first appears at index 3, while 8 first appears at index 1, and 1 < 3, making the answer to the query 1.Note that the sample is only meant to provide an example of how the interaction works; it is not guaranteed that the above queries represent a correct strategy with which to determine the answer.",
    "tags": ["constructive algorithms", "greedy", "interactive"]
  },
  {
    "name": "Omkar and Determination",
    "question_id": "omkar-and-determination",
    "question": "The problem statement looms below, filling you with determination.Consider a grid in which some cells are empty and some cells are filled. Call a cell in this grid exitable if, starting at that cell, you can exit the grid by moving up and left through only empty cells. This includes the cell itself, so all filled in cells are not exitable. Note that you can exit the grid from any leftmost empty cell (cell in the first column) by going left, and from any topmost empty cell (cell in the first row) by going up.Let's call a grid determinable if, given only which cells are exitable, we can exactly determine which cells are filled in and which aren't.You are given a grid a of dimensions n \\times m , i. e. a grid with n rows and m columns. You need to answer q queries (1  q  2 dot 10^5). Each query gives two integers x_1, x_2 (1  x_1  x_2  m) and asks whether the subgrid of a consisting of the columns x_1, x_1 + 1, ......., x_2 - 1, x_2 is determinable.",
    "input_details": "The first line contains two integers n, m (1  n, m  10^6, nm  10^6)  — the dimensions of the grid a.n lines follow. The y-th line contains m characters, the x-th of which is 'X' if the cell on the intersection of the the y-th row and x-th column is filled and \".\" if it is empty.The next line contains a single integer q (1  q  2 dot 10^5)  — the number of queries.q lines follow. Each line contains two integers x_1 and x_2 (1  x_1  x_2  m), representing a query asking whether the subgrid of a containing the columns x_1, x_1 + 1, ......., x_2 - 1, x_2 is determinable.",
    "output_details": "For each query, output one line containing \"YES\" if the subgrid specified by the query is determinable and \"NO\" otherwise. The output is case insensitive (so \"yEs\" and \"No\" will also be accepted).",
    "sample_input": "4 5\n..XXX\n...X.\n...X.\n...X.\n5\n1 3\n3 3\n4 5\n5 5\n1 5",
    "sample_output": "YES\nYES\nNO\nYES\nNO",
    "tags": ["data structures", "dp"]
  },
  {
    "name": "Omkar and Heavenly Tree",
    "question_id": "omkar-and-heavenly-tree",
    "question": "Lord Omkar would like to have a tree with n nodes (3  n  10^5) and has asked his disciples to construct the tree. However, Lord Omkar has created m (\\mathbf{1  m < n}) restrictions to ensure that the tree will be as heavenly as possible. A tree with n nodes is an connected undirected graph with n nodes and n-1 edges. Note that for any two nodes, there is exactly one simple path between them, where a simple path is a path between two nodes that does not contain any node more than once.Here is an example of a tree:   A restriction consists of 3 pairwise distinct integers, a, b, and c (1  a,b,c  n). It signifies that node b cannot lie on the simple path between node a and node c. Can you help Lord Omkar and become his most trusted disciple? You will need to find heavenly trees for multiple sets of restrictions. It can be shown that a heavenly tree will always exist for any set of restrictions under the given constraints.",
    "input_details": "Each test contains multiple test cases. The first line contains the number of test cases t (1  t  10^4). Description of the test cases follows.The first line of each test case contains two integers, n and m (3  n  10^5, \\mathbf{1  m < n}), representing the size of the tree and the number of restrictions.The i-th of the next m lines contains three integers a_i, b_i, c_i (1  a_i, b_i, c_i  n, a, b, c are distinct), signifying that node b_i cannot lie on the simple path between nodes a_i and c_i. It is guaranteed that the sum of n across all test cases will not exceed 10^5.",
    "output_details": "For each test case, output n-1 lines representing the n-1 edges in the tree. On each line, output two integers u and v (1  u, v  n, u  v) signifying that there is an edge between nodes u and v. Given edges have to form a tree that satisfies Omkar's restrictions.",
    "sample_input": "2\n7 4\n1 2 3\n3 4 5\n5 6 7\n6 5 4\n5 3\n1 2 3\n2 3 4\n3 4 5",
    "sample_output": "1 2\n1 3\n3 5\n3 4\n2 7\n7 6\n5 1\n1 3\n3 2\n2 4",
    "tags": ["constructive algorithms", "trees"]
  },
  {
    "name": "Windblume Ode",
    "question_id": "windblume-ode",
    "question": "A bow adorned with nameless flowers that bears the earnest hopes of an equally nameless person.You have obtained the elegant bow known as the Windblume Ode. Inscribed in the weapon is an array of n (n \\ge 3) positive distinct integers (i.e. different, no duplicates are allowed).Find the largest subset (i.e. having the maximum number of elements) of this array such that its sum is a composite number. A positive integer x is called composite if there exists a positive integer y such that 1 < y < x and x is divisible by y.If there are multiple subsets with this largest size with the composite sum, you can output any of them. It can be proven that under the constraints of the problem such a non-empty subset always exists.",
    "input_details": "Each test consists of multiple test cases. The first line contains the number of test cases t (1  t  100). Description of the test cases follows.The first line of each test case contains an integer n (3  n  100) — the length of the array.The second line of each test case contains n distinct integers a_{1},a_{2},\\dots,a_{n} (1  a_{i}  200) — the elements of the array.",
    "output_details": "Each test case should have two lines of output.The first line should contain a single integer x: the size of the largest subset with composite sum. The next line should contain x space separated integers representing the indices of the subset of the initial array.",
    "sample_input": "4\n3\n8 1 2\n4\n6 9 4 2\n9\n1 2 3 4 5 6 7 8 9\n3\n200 199 198",
    "sample_output": "2\n2 1\n4\n2 1 4 3\n9\n6 9 1 2 3 4 5 7 8\n3\n1 2 3",
    "tags": ["math", "number theory"]
  },
  {
    "name": "Diameter of Graph",
    "question_id": "diameter-of-graph",
    "question": "CQXYM wants to create a connected undirected graph with n nodes and m edges, and the diameter of the graph must be strictly less than k-1. Also, CQXYM doesn't want a graph that contains self-loops or multiple edges (i.e. each edge connects two different vertices and between each pair of vertices there is at most one edge).The diameter of a graph is the maximum distance between any two nodes.The distance between two nodes is the minimum number of the edges on the path which endpoints are the two nodes.CQXYM wonders whether it is possible to create such a graph.",
    "input_details": "The input consists of multiple test cases. The first line contains an integer t (1  t  10^5) — the number of test cases. The description of the test cases follows.Only one line of each test case contains three integers n(1  n  10^9), m, k (0  m,k  10^9).",
    "output_details": "For each test case, print YES if it is possible to create the graph, or print NO if it is impossible. You can print each letter in any case (upper or lower).",
    "sample_input": "5\n1 0 3\n4 5 3\n4 6 3\n5 4 1\n2 1 1",
    "sample_output": "YES\nNO\nYES\nNO\nNO",
    "tags": ["constructive algorithms", "graphs", "greedy", "math", "*1200"]
  },
  {
    "name": "CQXYM Count Permutations",
    "question_id": "cqxym-count-permutations",
    "question": "CQXYM is counting permutations length of 2n.A permutation is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array).A permutation p(length of 2n) will be counted only if the number of i satisfying p_i<p_{i+1} is no less than n. For example:  Permutation [1, 2, 3, 4] will count, because the number of such i that p_i<p_{i+1} equals 3 (i = 1, i = 2, i = 3). Permutation [3, 2, 1, 4] won't count, because the number of such i that p_i<p_{i+1} equals 1 (i = 3). CQXYM wants you to help him to count the number of such permutations modulo 1000000007 (10^9+7).In addition, modulo operation is to get the remainder. For example:  7 \\mod 3=1, because 7 = 3 dot 2 + 1,  15 \\mod 4=3, because 15 = 4 dot 3 + 3. ",
    "input_details": "The input consists of multiple test cases. The first line contains an integer t (t  1) — the number of test cases. The description of the test cases follows.Only one line of each test case contains an integer n(1  n  10^5).It is guaranteed that the sum of n over all test cases does not exceed 10^5",
    "output_details": "For each test case, print the answer in a single line.",
    "sample_input": "4\n1\n2\n9\n91234",
    "sample_output": "1\n12\n830455698\n890287984",
    "tags": ["combinatorics", "math", "number theory", "*800"]
  },
  {
    "name": "Problems for Codeforces",
    "question_id": "problems-for-codeforces",
    "question": "XYMXYM and CQXYM will prepare n problems for Codeforces. The difficulty of the problem i will be an integer a_i, where a_i  0. The difficulty of the problems must satisfy a_i+a_{i+1}<m (1  i < n), and a_1+a_n<m, where m is a fixed integer. XYMXYM wants to know how many plans of the difficulty of the problems there are modulo 998\\,244\\,353.Two plans of difficulty a and b are different only if there is an integer i (1  i  n) satisfying a_i  b_i.",
    "input_details": "A single line contains two integers n and m (2  n  50\\,000, 1  m  10^9).",
    "output_details": "Print a single integer — the number of different plans.",
    "sample_input": "3 2",
    "sample_output": "4",
    "tags": ["combinatorics", "fft", "math", "*3300"]
  },
  {
    "name": "Railway Construction",
    "question_id": "railway-construction",
    "question": "Because the railway system in Gensokyo is often congested, as an enthusiastic engineer, Kawasiro Nitori plans to construct more railway to ease the congestion.There are n stations numbered from 1 to n and m two-way railways in Gensokyo. Every two-way railway connects two different stations and has a positive integer length d. No two two-way railways connect the same two stations. Besides, it is possible to travel from any station to any other using those railways. Among these n stations, station 1 is the main station. You can get to any station from any other station using only two-way railways.Because of the technological limitation, Nitori can only construct one-way railways, whose length can be arbitrary positive integer. Constructing a one-way railway from station u will costs w_u units of resources, no matter where the railway ends. To ease the congestion, Nitori plans that after construction there are at least two shortest paths from station 1 to any other station, and these two shortest paths do not pass the same station except station 1 and the terminal. Besides, Nitori also does not want to change the distance of the shortest path from station 1 to any other station.Due to various reasons, sometimes the cost of building a new railway will increase uncontrollably. There will be a total of q occurrences of this kind of incident, and the i-th event will add additional amount of x_i to the cost of building a new railway from the station k_i.To save resources, before all incidents and after each incident, Nitori wants you to help her calculate the minimal cost of railway construction.",
    "input_details": "The first line contains three integers n, m, and q (1  n  2 dot 10^5, 1  m  3 dot 10^5, 0  q  2dot10^5).The second line contains n integers w_1,w_2,.......,w_n (1  w_i  10^9).Each of the next m lines contains three integers u, v, d (1  u,v  n, u \\ne v, 1  d  10^9), denoting a two-way railway connecting station u and station v, with length d.The i-th of the next q lines contains two integers k_i,x_i (1  k_i  n, 1  x_i  4 \\times 10^8).",
    "output_details": "Print q+1 lines, and the i-th of these lines contains one integer, denoting the minimal cost of railway construction after the i-1-th incident (especially, the 0-th incident means no incident occurred).",
    "sample_input": "5 5 1\n1 1 1 1 1\n1 2 1\n2 3 1\n2 4 1\n3 5 1\n4 5 1\n1 2",
    "sample_output": "3\n9",
    "tags": [
      "brute force",
      "constructive algorithms",
      "data structures",
      "graphs",
      "shortest paths",
      "*3400"
    ]
  },
  {
    "name": "Subsequence",
    "question_id": "subsequence",
    "question": "Alice has an integer sequence a of length n and all elements are different. She will choose a subsequence of a of length m, and defines the value of a subsequence a_{b_1},a_{b_2},.......,a_{b_m} as \\sum_{i = 1}^m (m dot a_{b_i}) - \\sum_{i = 1}^m \\sum_{j = 1}^m f(\\min(b_i, b_j), \\max(b_i, b_j)), where f(i, j) denotes \\min(a_i, a_{i + 1}, ......., a_j).Alice wants you to help her to maximize the value of the subsequence she choose.A sequence s is a subsequence of a sequence t if s can be obtained from t by deletion of several (possibly, zero or all) elements.",
    "input_details": "The first line contains two integers n and m (1  m  n  4000).The second line contains n distinct integers a_1, a_2, ......., a_n (1  a_i < 2^{31}).",
    "output_details": "Print the maximal value Alice can get.",
    "sample_input": "6 4\n15 2 18 12 13 4",
    "sample_output": "100",
    "tags": [
      "brute force",
      "divide and conquer",
      "dp",
      "greedy",
      "trees",
      "*2900"
    ]
  },
  {
    "name": "Train Maintenance",
    "question_id": "train-maintenance",
    "question": "Kawasiro Nitori is excellent in engineering. Thus she has been appointed to help maintain trains.There are n models of trains, and Nitori's department will only have at most one train of each model at any moment. In the beginning, there are no trains, at each of the following m days, one train will be added, or one train will be removed. When a train of model i is added at day t, it works for x_i days (day t inclusive), then it is in maintenance for y_i days, then in work for x_i days again, and so on until it is removed.In order to make management easier, Nitori wants you to help her calculate how many trains are in maintenance in each day.On a day a train is removed, it is not counted as in maintenance.",
    "input_details": "The first line contains two integers n, m (1  n,m  2 dot 10^5).The i-th of the next n lines contains two integers x_i,y_i (1  x_i,y_i  10^9).Each of the next m lines contains two integers op, k (1  k  n, op = 1 or op = 2). If op=1, it means this day's a train of model k is added, otherwise the train of model k is removed. It is guaranteed that when a train of model x is added, there is no train of the same model in the department, and when a train of model x is removed, there is such a train in the department.",
    "output_details": "Print m lines, The i-th of these lines contains one integers, denoting the number of trains in maintenance in the i-th day.",
    "sample_input": "3 4\n10 15\n12 10\n1 1\n1 3\n1 1\n2 1\n2 3",
    "sample_output": "0\n1\n0\n0",
    "tags": ["brute force", "data structures", "implementation", "*2200"]
  },
  {
    "name": "Mathematics Curriculum",
    "question_id": "mathematics-curriculum",
    "question": "Let c_1, c_2, ......., c_n be a permutation of integers 1, 2, ......., n. Consider all subsegments of this permutation containing an integer x. Given an integer m, we call the integer x good if there are exactly m different values of maximum on these subsegments.Cirno is studying mathematics, and the teacher asks her to count the number of permutations of length n with exactly k good numbers.Unfortunately, Cirno isn't good at mathematics, and she can't answer this question. Therefore, she asks you for help.Since the answer may be very big, you only need to tell her the number of permutations modulo p.A permutation is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array).A sequence a is a subsegment of a sequence b if a can be obtained from b by deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end.",
    "input_details": "The first line contains four integers n, m, k, p (1  n  100, 1  m  n, 1  k  n, 1  p  10^9).",
    "output_details": "Output the number of permutations modulo p.",
    "sample_input": "4 3 2 10007",
    "sample_output": "4",
    "tags": ["brute force", "combinatorics", "dp", "trees", "*2600"]
  },
  {
    "name": "Portal",
    "question_id": "portal",
    "question": "CQXYM found a rectangle A of size n \\times m. There are n rows and m columns of blocks. Each block of the rectangle is an obsidian block or empty. CQXYM can change an obsidian block to an empty block or an empty block to an obsidian block in one operation.A rectangle M size of a \\times b is called a portal if and only if it satisfies the following conditions:  a  5,b  4.  For all 1 < x < a, blocks M_{x,1} and M_{x,b} are obsidian blocks.  For all 1 < x < b, blocks M_{1,x} and M_{a,x} are obsidian blocks.  For all 1<x<a,1<y<b, block M_{x,y} is an empty block.  M_{1, 1}, M_{1, b}, M_{a, 1}, M_{a, b} can be any type.  Note that the there must be a rows and b columns, not b rows and a columns.Note that corners can be any typeCQXYM wants to know the minimum number of operations he needs to make at least one sub-rectangle a portal.",
    "input_details": "The first line contains an integer t (t  1), which is the number of test cases.For each test case, the first line contains two integers n and m (5  n  400, 4  m  400). Then n lines follow, each line contains m characters 0 or 1. If the j-th character of i-th line is 0, block A_{i,j} is an empty block. Otherwise, block A_{i,j} is an obsidian block.It is guaranteed that the sum of n over all test cases does not exceed 400.It is guaranteed that the sum of m over all test cases does not exceed 400.",
    "output_details": "Output t answers, and each answer in a line.",
    "sample_input": "1\n5 4\n1000\n0000\n0110\n0000\n0001",
    "sample_output": "12",
    "tags": [
      "brute force",
      "data structures",
      "dp",
      "greedy",
      "implementation",
      "*1700"
    ]
  },
  {
    "name": "Minimal Coverage",
    "question_id": "minimal-coverage",
    "question": "You are given n lengths of segments that need to be placed on an infinite axis with coordinates.The first segment is placed on the axis so that one of its endpoints lies at the point with coordinate 0. Let's call this endpoint the \"start\" of the first segment and let's call its \"end\" as that endpoint that is not the start. The \"start\" of each following segment must coincide with the \"end\" of the previous one. Thus, if the length of the next segment is d and the \"end\" of the previous one has the coordinate x, the segment can be placed either on the coordinates [x-d, x], and then the coordinate of its \"end\" is x - d, or on the coordinates [x, x+d], in which case its \"end\" coordinate is x + d.The total coverage of the axis by these segments is defined as their overall union which is basically the set of points covered by at least one of the segments. It's easy to show that the coverage will also be a segment on the axis. Determine the minimal possible length of the coverage that can be obtained by placing all the segments on the axis without changing their order.",
    "input_details": "The first line contains an integer t (1  t  1000) — the number of test cases.The next 2t lines contain descriptions of the test cases. The first line of each test case description contains an integer n (1  n  10^4) — the number of segments. The second line of the description contains n space-separated integers a_i (1  a_i  1000) — lengths of the segments in the same order they should be placed on the axis.It is guaranteed that the sum of n over all test cases does not exceed 10^4.",
    "output_details": "Print t lines, each line containing the answer to the corresponding test case. The answer to a test case should be a single integer — the minimal possible length of the axis coverage.",
    "sample_input": "6\n2\n1 3\n3\n1 2 3\n4\n6 2 3 9\n4\n6 8 4 5\n7\n1 2 4 6 7 7 3\n8\n8 6 5 1 2 2 3 6",
    "sample_output": "3\n3\n9\n9\n7\n8",
    "tags": ["dp", "*2200"]
  },
  {
    "name": "Array Stabilization (AND version)",
    "question_id": "array-stabilization-and-version",
    "question": "You are given an array a[0 ....... n - 1] = [a_0, a_1, ......., a_{n - 1}] of zeroes and ones only. Note that in this problem, unlike the others, the array indexes are numbered from zero, not from one.In one step, the array a is replaced by another array of length n according to the following rules:   First, a new array a^{\\rightarrow d} is defined as a cyclic shift of the array a to the right by d cells. The elements of this array can be defined as a^{\\rightarrow d}_i = a_{(i + n - d) \\bmod n}, where (i + n - d) \\bmod n is the remainder of integer division of i + n - d by n.  It means that the whole array a^{\\rightarrow d} can be represented as a sequence a^{\\rightarrow d} = [a_{n - d}, a_{n - d + 1}, ......., a_{n - 1}, a_0, a_1, ......., a_{n - d - 1}]  Then each element of the array a_i is replaced by a_i \\,\\&\\, a^{\\rightarrow d}_i, where \\& is a logical \"AND\" operator. For example, if a = [0, 0, 1, 1] and d = 1, then a^{\\rightarrow d} = [1, 0, 0, 1] and the value of a after the first step will be [0 \\,\\&\\, 1, 0 \\,\\&\\, 0, 1 \\,\\&\\, 0, 1 \\,\\&\\, 1], that is [0, 0, 0, 1].The process ends when the array stops changing. For a given array a, determine whether it will consist of only zeros at the end of the process. If yes, also find the number of steps the process will take before it finishes.",
    "input_details": "The first line contains an integer t (1  t  1000) — the number of test cases.The next 2t lines contain descriptions of the test cases. The first line of each test case description contains two integers: n (1  n  10^6) — array size and d (1  d  n) — cyclic shift offset. The second line of the description contains n space-separated integers a_i (0  a_i  1) — elements of the array.It is guaranteed that the sum of n over all test cases does not exceed 10^6.",
    "output_details": "Print t lines, each line containing the answer to the corresponding test case. The answer to a test case should be a single integer — the number of steps after which the array will contain only zeros for the first time. If there are still elements equal to 1 in the array after the end of the process, print -1.",
    "sample_input": "5\n2 1\n0 1\n3 2\n0 1 0\n5 2\n1 1 0 1 0\n4 2\n0 1 0 1\n1 1\n0",
    "sample_output": "1\n1\n3\n-1\n0",
    "tags": [
      "brute force",
      "graphs",
      "math",
      "number theory",
      "shortest paths",
      "*1700"
    ]
  },
  {
    "name": " Array Optimization by Deque",
    "question_id": "array-optimization-by-deque",
    "question": "In fact, the problems E1 and E2 do not have much in common. You should probably think of them as two separate problems.You are given an integer array a[1 ....... n] = [a_1, a_2, ......., a_n].Let us consider an empty deque (double-ended queue). A deque is a data structure that supports adding elements to both the beginning and the end. So, if there are elements [3, 4, 4] currently in the deque, adding an element 1 to the beginning will produce the sequence [olor{red}{1}, 3, 4, 4], and adding the same element to the end will produce [3, 4, 4, olor{red}{1}].The elements of the array are sequentially added to the initially empty deque, starting with a_1 and finishing with a_n. Before adding each element to the deque, you may choose whether to add it to the beginning or to the end.For example, if we consider an array a = [3, 7, 5, 5], one of the possible sequences of actions looks like this: \\quad 1.add 3 to the beginning of the deque:deque has a sequence [olor{red}{3}] in it;\\quad 2.add 7 to the end of the deque:deque has a sequence [3, olor{red}{7}] in it;\\quad 3.add 5 to the end of the deque:deque has a sequence [3, 7, olor{red}{5}] in it;\\quad 4.add 5 to the beginning of the deque:deque has a sequence [olor{red}{5}, 3, 7, 5] in it;Find the minimal possible number of inversions in the deque after the whole array is processed. An inversion in sequence d is a pair of indices (i, j) such that i < j and d_i > d_j. For example, the array d = [5, 3, 7, 5] has exactly two inversions — (1, 2) and (3, 4), since d_1 = 5 > 3 = d_2 and d_3 = 7 > 5 = d_4.",
    "input_details": "The first line contains an integer t (1  t  1000) — the number of test cases.The next 2t lines contain descriptions of the test cases. The first line of each test case description contains an integer n (1  n  2 dot 10^5) — array size. The second line of the description contains n space-separated integers a_i (-10^9  a_i  10^9) — elements of the array.It is guaranteed that the sum of n over all test cases does not exceed 2 dot 10^5.",
    "output_details": "Print t lines, each line containing the answer to the corresponding test case. The answer to a test case should be a single integer — the minimal possible number of inversions in the deque after executing the described algorithm.",
    "sample_input": "6\n4\n3 7 5 5\n3\n3 2 1\n3\n3 1 2\n4\n-1 2 2 -1\n4\n4 5 1 3\n5\n1 3 1 3 2",
    "sample_output": "2\n0\n1\n0\n1\n2",
    "tags": ["data structures", "greedy", "*1700"]
  },
  {
    "name": " Permutation Minimization by Deque",
    "question_id": "permutation-minimization-by-deque",
    "question": "In fact, the problems E1 and E2 do not have much in common. You should probably think of them as two separate problems.A permutation p of size n is given. A permutation of size n is an array of size n in which each integer from 1 to n occurs exactly once. For example, [1, 4, 3, 2] and [4, 2, 1, 3] are correct permutations while [1, 2, 4] and [1, 2, 2] are not.Let us consider an empty deque (double-ended queue). A deque is a data structure that supports adding elements to both the beginning and the end. So, if there are elements [1, 5, 2] currently in the deque, adding an element 4 to the beginning will produce the sequence [olor{red}{4}, 1, 5, 2], and adding same element to the end will produce [1, 5, 2, olor{red}{4}].The elements of the permutation are sequentially added to the initially empty deque, starting with p_1 and finishing with p_n. Before adding each element to the deque, you may choose whether to add it to the beginning or the end.For example, if we consider a permutation p = [3, 1, 2, 4], one of the possible sequences of actions looks like this: \\quad 1.add 3 to the end of the deque:deque has a sequence [olor{red}{3}] in it;\\quad 2.add 1 to the beginning of the deque:deque has a sequence [olor{red}{1}, 3] in it;\\quad 3.add 2 to the end of the deque:deque has a sequence [1, 3, olor{red}{2}] in it;\\quad 4.add 4 to the end of the deque:deque has a sequence [1, 3, 2, olor{red}{4}] in it;Find the lexicographically smallest possible sequence of elements in the deque after the entire permutation has been processed. A sequence [x_1, x_2, ......., x_n] is lexicographically smaller than the sequence [y_1, y_2, ......., y_n] if there exists such i  n that x_1 = y_1, x_2 = y_2, ......., x_{i - 1} = y_{i - 1} and x_i < y_i. In other words, if the sequences x and y have some (possibly empty) matching prefix, and the next element of the sequence x is strictly smaller than the corresponding element of the sequence y. For example, the sequence [1, 3, 2, 4] is smaller than the sequence [1, 3, 4, 2] because after the two matching elements [1, 3] in the start the first sequence has an element 2 which is smaller than the corresponding element 4 in the second sequence.",
    "input_details": "The first line contains an integer t (1  t  1000) — the number of test cases.The next 2t lines contain descriptions of the test cases. The first line of each test case description contains an integer n (1  n  2 dot 10^5) — permutation size. The second line of the description contains n space-separated integers p_i (1  p_i  n; all p_i are all unique) — elements of the permutation.It is guaranteed that the sum of n over all test cases does not exceed 2 dot 10^5.",
    "output_details": "Print t lines, each line containing the answer to the corresponding test case. The answer to a test case should contain n space-separated integer numbers — the elements of the lexicographically smallest permutation that is possible to find in the deque after executing the described algorithm.",
    "sample_input": "5\n4\n3 1 2 4\n3\n3 2 1\n3\n3 1 2\n2\n1 2\n2\n2 1",
    "sample_output": "1 3 2 4 \n1 2 3 \n1 3 2 \n1 2 \n1 2",
    "tags": ["constructive algorithms", "greedy", "math", "*1000"]
  },
  {
    "name": "Productive Meeting",
    "question_id": "productive-meeting",
    "question": "An important meeting is to be held and there are exactly n people invited. At any moment, any two people can step back and talk in private. The same two people can talk several (as many as they want) times per meeting.Each person has limited sociability. The sociability of the i-th person is a non-negative integer a_i. This means that after exactly a_i talks this person leaves the meeting (and does not talk to anyone else anymore). If a_i = 0, the i-th person leaves the meeting immediately after it starts.A meeting is considered most productive if the maximum possible number of talks took place during it.You are given an array of sociability a, determine which people should talk to each other so that the total number of talks is as large as possible.",
    "input_details": "The first line contains an integer t (1  t  1000) — the number of test cases.The next 2t lines contain descriptions of the test cases.The first line of each test case description contains an integer n (2  n  2 dot 10^5) —the number of people in the meeting. The second line consists of n space-separated integers a_1, a_2, \\dots, a_n (0  a_i  2 dot 10^5) — the sociability parameters of all people. It is guaranteed that the sum of n over all test cases does not exceed 2 dot 10^5. It is also guaranteed that the sum of all a_i (over all test cases and all i) does not exceed 2 dot 10^5.",
    "output_details": "Print t answers to all test cases.On the first line of each answer print the number k — the maximum number of talks possible in a meeting.On each of the next k lines print two integers i and j (1  i, j  n and i  j) — the numbers of people who will have another talk.If there are several possible answers, you may print any of them.",
    "sample_input": "8\n2\n2 3\n3\n1 2 3\n4\n1 2 3 4\n3\n0 0 2\n2\n6 2\n3\n0 0 2\n5\n8 2 0 1 1\n5\n0 1 0 0 6",
    "sample_output": "2\n1 2\n1 2\n3\n1 3\n2 3\n2 3\n5\n1 3\n2 4\n2 4\n3 4\n3 4\n0\n2\n1 2\n1 2\n0\n4\n1 2\n1 5\n1 4\n1 2\n1\n5 2",
    "tags": ["constructive algorithms", "graphs", "greedy", "*1400"]
  },
  {
    "name": "Ticks",
    "question_id": "ticks",
    "question": "Casimir has a rectangular piece of paper with a checkered field of size n \\times m. Initially, all cells of the field are white.Let us denote the cell with coordinates i vertically and j horizontally by (i, j). The upper left cell will be referred to as (1, 1) and the lower right cell as (n, m).Casimir draws ticks of different sizes on the field. A tick of size d (d > 0) with its center in cell (i, j) is drawn as follows:   First, the center cell (i, j) is painted black.  Then exactly d cells on the top-left diagonally to the center and exactly d cells on the top-right diagonally to the center are also painted black.  That is all the cells with coordinates (i - h, j \\pm h) for all h between 0 and d are painted. In particular, a tick consists of 2d + 1 black cells. An already painted cell will remain black if painted again. Below you can find an example of the 4 \\times 9 box, with two ticks of sizes 2 and 3.  You are given a description of a checkered field of size n \\times m. Casimir claims that this field came about after he drew some (possibly 0) ticks on it. The ticks could be of different sizes, but the size of each tick is at least k (that is, d \\ge k for all the ticks).Determine whether this field can indeed be obtained by drawing some (possibly none) ticks of sizes d \\ge k or not.",
    "input_details": "The first line contains an integer t (1  t  100) — the number test cases.The following lines contain the descriptions of the test cases. The first line of the test case description contains the integers n, m, and k (1  k  n  10; 1  m  19) — the field size and the minimum size of the ticks that Casimir drew. The following n lines describe the field: each line consists of m characters either being '.' if the corresponding cell is not yet painted or '*' otherwise.",
    "output_details": "Print t lines, each line containing the answer to the corresponding test case. The answer to a test case should be YES if the given field can be obtained by drawing ticks of at least the given size and NO otherwise.You may print every letter in any case you want (so, for example, the strings yEs, yes, Yes, and YES will all be recognized as positive answers).",
    "sample_input": "8\n2 3 1\n*.*\n...\n4 9 2\n*.*.*...*\n.*.*...*.\n..*.*.*..\n.....*...\n4 4 1\n*.*.\n****\n.**.\n....\n5 5 1\n.....\n*...*\n.*.*.\n..*.*\n...*.\n5 5 2\n.....\n*...*\n.*.*.\n..*.*\n...*.\n4 7 1\n*.....*\n.....*.\n..*.*..\n...*...\n3 3 1\n***\n***\n***\n3 5 1\n*...*\n.***.\n.**..",
    "sample_output": "NO\nYES\nYES\nYES\nNO\nNO\nNO\nNO",
    "tags": ["greedy", "implementation", "*1500"]
  },
  {
    "name": "Shifting Sort",
    "question_id": "shifting-sort",
    "question": "The new generation external memory contains an array of integers a[1 ....... n] = [a_1, a_2, ......., a_n].This type of memory does not support changing the value of an arbitrary element. Instead, it allows you to cut out any segment of the given array, cyclically shift (rotate) it by any offset and insert it back into the same place.Technically, each cyclic shift consists of two consecutive actions:   You may select arbitrary indices l and r (1  l < r  n) as the boundaries of the segment.  Then you replace the segment a[l ....... r] with it's cyclic shift to the left by an arbitrary offset d. The concept of a cyclic shift can be also explained by following relations: the sequence [1, 4, 1, 3] is a cyclic shift of the sequence [3, 1, 4, 1] to the left by the offset 1 and the sequence [4, 1, 3, 1] is a cyclic shift of the sequence [3, 1, 4, 1] to the left by the offset 2. For example, if a = [1, olor{blue}{3, 2, 8}, 5], then choosing l = 2, r = 4 and d = 2 yields a segment a[2 ....... 4] = [3, 2, 8]. This segment is then shifted by the offset d = 2 to the left, and you get a segment [8, 3, 2] which then takes the place of of the original elements of the segment. In the end you get a = [1, olor{blue}{8, 3, 2}, 5].Sort the given array a using no more than n cyclic shifts of any of its segments. Note that you don't need to minimize the number of cyclic shifts. Any method that requires n or less cyclic shifts will be accepted.",
    "input_details": "The first line contains an integer t (1  t  1000) — the number of test cases.The next 2t lines contain the descriptions of the test cases. The first line of each test case description contains an integer n (2  n  50) — the length of the array. The second line consists of space-separated elements of the array a_i (-10^9  a_i  10^9). Elements of array a may repeat and don't have to be unique.",
    "output_details": "Print t answers to all input test cases. The first line of the answer of each test case should contain an integer k (0  k  n) — the number of actions to sort the array. The next k lines should contain descriptions of the actions formatted as \"l r d\" (without quotes) where l and r (1  l < r  n) are the boundaries of the segment being shifted, while d (1  d  r - l) is the offset value. Please remember that only the cyclic shifts to the left are considered so the chosen segment will be shifted by the offset d to the to the left.Note that you are not required to find the minimum number of cyclic shifts needed for sorting. Any sorting method where the number of shifts does not exceed n will be accepted.If the given array a is already sorted, one of the possible answers is k = 0 and an empty sequence of cyclic shifts.If there are several possible answers, you may print any of them.",
    "sample_input": "4\n2\n2 1\n3\n1 2 1\n4\n2 4 1 3\n5\n2 5 1 4 3",
    "sample_output": "1\n1 2 1\n1\n1 3 2\n3\n2 4 1\n2 3 1\n1 3 2\n4\n2 4 2\n1 5 3\n1 2 1\n1 3 1",
    "tags": ["implementation", "sortings", "*1100"]
  },
  {
    "name": "Casimir's String Solitaire",
    "question_id": "casimirs-string-solitaire",
    "question": "Casimir has a string s which consists of capital Latin letters 'A', 'B', and 'C' only. Each turn he can choose to do one of the two following actions:  he can either erase exactly one letter 'A' and exactly one letter 'B' from arbitrary places of the string (these letters don't have to be adjacent);  or he can erase exactly one letter 'B' and exactly one letter 'C' from arbitrary places in the string (these letters don't have to be adjacent). Therefore, each turn the length of the string is decreased exactly by 2. All turns are independent so for each turn, Casimir can choose any of two possible actions.For example, with s = \"ABCABC\" he can obtain a string s = \"ACBC\" in one turn (by erasing the first occurrence of 'B' and the second occurrence of 'A'). There are also many other options for a turn aside from this particular example.For a given string s determine whether there is a sequence of actions leading to an empty string. In other words, Casimir's goal is to erase all letters from the string. Is there a way to do this?",
    "input_details": "The first line contains an integer t (1  t  1000) — the number of test cases.Each test case is described by one string s, for which you need to determine if it can be fully erased by some sequence of turns. The string s consists of capital letters 'A', 'B', 'C' and has a length from 1 to 50 letters, inclusive.",
    "output_details": "Print t lines, each line containing the answer to the corresponding test case. The answer to a test case should be YES if there is a way to fully erase the corresponding string and NO otherwise.You may print every letter in any case you want (so, for example, the strings yEs, yes, Yes, and YES will all be recognized as positive answers).",
    "sample_input": "6\nABACAB\nABBA\nAC\nABC\nCABCBB\nBCBCBCBCBCBCBCBC",
    "sample_output": "NO\nYES\nNO\nNO\nYES\nYES",
    "tags": ["math", "strings", "*800"]
  },
  {
    "name": "The Mind",
    "question_id": "the-mind",
    "question": "This is an interactive problem.In this problem, you need to come up with a strategy for a cooperative game. This game is played by two players. Each player receives 5 cards. Each card has a random integer between 1 and 100 on it. It is guaranteed that all numbers on cards are distinct.The goal of the game is to play a card with a minimal number on it out of all 10 cards dealt to the players before any other card. The problem is that each player can only see their own cards and cannot communicate with another player in any way.The game consists of 5 turns. During each turn, players simultaneously make a move. Each player can either play their smallest card or do nothing. If on some turn the smallest card is played, and no other card is played on or before that turn, players win. If two cards are played at the same turn or if after all 5 turns, no card is still played, players lose.Players cannot communicate, so a strategy for the game should only be based on 5 cards that the player has. You can describe a strategy as five numbers 0.0  p_i  1.0, \\sum_{i=1}^{5}p_i  1, where p_i — the probability of playing the player's smallest card in their hand on i-th turn. If you know the cards dealt to the players, and the strategies that players choose, you can compute the probability of winning by a simple formula. You will be given n=1000 randomly generated hands of 5 cards. You need to generate a strategy for each of the hands to maximize the probability of winning. After the judge program receives all n strategies, it generates all possible valid pairs of those hands (pairs which have the same numbers are discarded), and computes a probability of winning based on two strategies provided by your program. To ensure that answers for different hands are independent, you must output a strategy for a hand and flush the standard output before reading information about the next hand.If the average probability of winning a game is more than 85% over all valid pairs of hands, the test is considered passed. This problem contains the sample test and 20 randomly generated tests with n = 1000.",
    "input_details": "The first line contains one integer n — the number of hands. It is guaranteed that n = 1000 for all cases except the first sample case. Each of the next n lines contains 5 numbers a_i (1  a_i  100, a_i < a_{i+1}) — the cards in the hand. It is guaranteed that each possible set of 5 cards has an equal probability of being chosen. ",
    "output_details": "For each of the n hands you need to output 5 numbers 0.0  p_i  1.0, \\sum_{i=1}^{5}p_i  1, where p_i — probability of playing the smallest card on i-th turn.",
    "sample_input": "2\n2 12 27 71 100\n\n22 29 39 68 90",
    "sample_output": "0.8 0.2 0.0 0.0 0.0 \n\n0.0 0.2 0.2 0.2 0.3",
    "tags": ["constructive algorithms", "interactive", "probabilities", "*2700"]
  },
  {
    "name": "Labyrinth",
    "question_id": "labyrinth",
    "question": "In a dream, Lucy found herself in a labyrinth. This labyrinth consists of n rooms, connected by m passages (i-th passage is w_i cm wide). Each passage can be traversed in both directions. It is guaranteed that it is possible to get from any room to any other room. But this is not an ordinary labyrinth — each room in this labyrinth contains a magic candy. When Lucy eats this magic candy, she is getting wider. Specifically, if she eats candy from room i she becomes wider by c_i cm. Note that she is not obliged to eat candy the first time she visits a particular room, but she can eat each candy only once. Unfortunately, passages in this labyrinth are pretty narrow, so after eating some candy, Lucy can get too wide and will not be able to traverse them — her width should not be greater than the width of the corresponding passage.Lucy starts her journey in a room number 1. She wants to eat all the candies. After that, she will just wake up, so she does not have to be able to return to the room 1. She realizes that with her current width, she may not be able to do so, so she plans a workout before embarking on her journey. Lucy wants to know if it is possible to start with some positive width and still eat all the candies. If yes, then what is the maximal starting width with which it is possible.",
    "input_details": "The first line contains two integers, n and m (2  n  10^5; n - 1  m  10^5) — the number of rooms and the number of passages.The second line contains n integers — c_i (1  c_i  10^9).Next m lines contain three integers each — a_i, b_i and w_i (1  a_i, b_i  n; a_i \\ne b_i; 1  w_i  10^9) describing passage that connects rooms a_i and b_i and is w_i cm wide. It is guaranteed that the resulting labyrinth is connected and there is at most one passage between any pair of rooms.",
    "output_details": "If it is possible to eat all the candies, output the maximal possible starting width, otherwise output -1.",
    "sample_input": "3 3\n1 2 3\n1 2 4\n1 3 4\n2 3 6",
    "sample_output": "3",
    "tags": ["binary search", "dsu", "greedy", "*2400"]
  },
  {
    "name": "Kingdom of Islands",
    "question_id": "kingdom-of-islands",
    "question": "The Kingdom of Islands consists of p islands. As the king, you rule over the whole kingdom, while each island is ruled over by one or several jarls under your rule. In total, there are n jarls under your jurisdiction.Each island of the kingdom has its own strong traditions, so jarls that rule over the same island support each other and never have conflicts. The downsides of such strength are cultural conflicts between people inhabiting different islands. Thus, two jarls that rule over different islands are in conflict.However, recent years brought a few changes to traditional relations between the jarls. To your knowledge, there are exactly k pairs of jarls such that relationships between two jarls in the pair are different from the traditional. That is, if two jarls of the pair you know rule over the same island, these jarls are in conflict. If they rule over different islands, then they overcome cultural disagreement and there is no conflict between them anymore.As a true responsible king, you are worried about whether the kingdom is close to a major conflict. In order to estimate the current situation, you would like to find the largest possible group of jarls such that every two jarls in the group are in conflict.",
    "input_details": "The first line of the input consists of two integers p and n (1  p  n  10^5; 1  p  10^4).The second line consists of n integers s_1, s_2, ......., s_n (1  s_i  p). The integer s_i denotes that the i-th jarl rules over the island number s_i. It is guaranteed that each island is ruled by at least one jarl.The third line consists of a single integer k (0  k  20).Then k lines follow. The j-th of these lines consists of two distinct integers a_j and b_j (1  a_j < b_j  n), denoting that the relation between the a_j-th jarl and the b_j-th jarl differs from traditional. It is guaranteed that no pair of jarls appears twice in this list.",
    "output_details": "In the first line print a single integer q between 1 and n — the largest possible number of jarls in a pairwise conflicting group. In the second line print q distinct integers between 1 and n — the numbers of jarls in the group. The numbers of jarls can be printed in any order.",
    "sample_input": "4 4\n1 2 3 4\n1\n2 3",
    "sample_output": "3\n1 4 2",
    "tags": ["brute force", "graphs", "implementation", "*2800"]
  },
  {
    "name": "Just Kingdom",
    "question_id": "just-kingdom",
    "question": "The Just Kingdom is ruled by a king and his n lords, numbered 1 to n. Each of the lords is a vassal of some overlord, who might be the king himself, or a different lord closer to the king. The king, and all his lords, are just and kind.Each lord has certain needs, which can be expressed as a certain amount of money they need. However, if a lord, or the king, receives any money, they will first split it equally between all their vassals who still have unmet needs. Only if all the needs of all their vassals are met, they will take the money to fulfill their own needs. If there is any money left over, they will return the excess to their overlord (who follows the standard procedure for distributing money).At the beginning of the year, the king receives a certain sum of tax money and proceeds to split it according to the rules above. If the amount of tax money is greater than the total needs of all the lords, the procedure guarantees everybody's needs will be fulfilled, and the excess money will be left with the king. However, if there is not enough money, some lords will not have their needs met.For each lord, determine the minimum amount of tax money the king has to receive so that this lord's needs are met.",
    "input_details": "The first line of the input contains the number of lords n (0  n  3 dot 10^5). Each of the next n lines describes one of the lords. The i-th line contains two integers: o_i (0  o_i < i) — the index of the overlord of the i-th lord (with zero meaning the king is the overlord), and m_i (1  m_i  10^6) — the amount of money the i-th lord needs.",
    "output_details": "Print n integer numbers t_i. The i-th number should be the minimum integer amount of tax money the king has to receive for which the needs of the i-th lord will be met.",
    "sample_input": "5\n0 2\n1 2\n0 1\n1 1\n0 5",
    "sample_output": "11\n7\n3\n5\n11",
    "tags": ["brute force", "data structures", "dfs and similar", "*3100"]
  },
  {
    "name": "Interactive Rays",
    "question_id": "interactive-rays",
    "question": "This is an interactive problem.Your goal is to find a circle on a plane by shooting rays and getting the distance to the circle as a result. Interactor has three hidden integer parameters that are determined in advance for each test, but which you don't know — x_c, y_c, and r_c. (x_c, y_c) are coordinates of the circle's center and r_c is its radius. The absolute values of x_c, y_c, and r_c do not exceed 10^5, and 1  r_c  \\sqrt{x_c^2 + y_c^2} - 1.You can shoot rays that extend from the origin (0,0) and go via a point (x_q,y_q) with the integer coordinates you specify. For each ray, you get a distance from the ray to the circle or 0 if the ray intersects the circle. ",
    "input_details": "actionThe interaction starts with your program printing a query to the standard output and finishes when your program finds and prints the answer to the problem.Each query has a form of \"? x_q y_q\", where x_q and y_q are integers (|x_q|, |y_q|  10^6; x_q \\ne 0 or y_q \\ne 0). The interactor outputs a line with a single floating-point number — the distance between a query ray and a circle that is precise to 10^{-10} by an absolute value.Your program can make the next query, read the output, and so on. You are allowed to do at most 60 queries. At the end of the interaction, print the answer line \"! x_c y_c r_c\", flush the output and exit.Note, that the output of the interactor is actually rounded to the 10-th digit after a decimal point, so if you are stress-testing your solution locally, make sure that you also perform the corresponding rounding.",
    "output_details": "eInput? 0 -10\n\n? 10 -10\n\n? 10 0\n\n? 10 10\n\n? 10 20\n\n? 10 30\n\n! 20 10 10Output12.360679775\n\n11.2132034356\n\n0.0\n\n0.0\n\n3.416407865\n\n5.8113883008",
    "sample_input": "t12.360679775\n\n11.2132034356\n\n0.0\n\n0.0\n\n3.416407865\n\n5.8113883008",
    "sample_output": "Illustration of the queries from the example interaction.",
    "tags": ["geometry", "interactive", "*3300"]
  },
  {
    "name": "Higher Order Functions",
    "question_id": "higher-order-functions",
    "question": "Helen studies functional programming and she is fascinated with a concept of higher order functions — functions that are taking other functions as parameters. She decides to generalize the concept of the function order and to test it on some examples. For her study, she defines a simple grammar of types. In her grammar, a type non-terminal T is defined as one of the following grammar productions, together with \\textrm{order}(T), defining an order of the corresponding type: \"()\" is a unit type, \\textrm{order}(\\textrm{\"}\\texttt{()}\\textrm{\"}) = 0. \"(\" T \")\" is a parenthesized type, \\textrm{order}(\\textrm{\"}\\texttt{(}\\textrm{\"}\\,T\\,\\textrm{\"}\\texttt{)}\\textrm{\"}) = \\textrm{order}(T). T_1 \"->\" T_2 is a functional type, \\textrm{order}(T_1\\,\\textrm{\"}\\texttt{->}\\textrm{\"}\\,T_2) = max(\\textrm{order}(T_1) + 1, \\textrm{order}(T_2)). The function constructor T_1 \"->\" T_2 is right-to-left associative, so the type \"()->()->()\" is the same as the type \"()->(()->())\" of a function returning a function, and it has an order of 1. While \"(()->())->()\" is a function that has an order-1 type \"(()->())\" as a parameter, and it has an order of 2.  Helen asks for your help in writing a program that computes an order of the given type.",
    "input_details": "The single line of the input contains a string consisting of characters '(', ')', '-', and '>' that describes a type that is valid according to the grammar from the problem statement. The length of the line is at most 10^4 characters.",
    "output_details": "Print a single integer — the order of the given type.",
    "sample_input": "()",
    "sample_output": "0",
    "tags": ["implementation", "strings", "*1700"]
  },
  {
    "name": "Game of Chance",
    "question_id": "game-of-chance",
    "question": "The King wants to marry off his daughter, and he wants her husband to have the greatest innate luckiness possible. To find such a person he decided to hold a heads-or-tails tournament. If person A with luckiness x and person B with luckiness y play heads-or-tails against each other, person A wins with probability x/(x+y). The tournament has several rounds. Each round some participants are split into pairs. Each pair plays against each other, and the loser leaves the tournament. The participants are numbered from 1 to n. During the first round, a number k (1  k  n) is selected such that n-k/2 is a power of 2 (such k always exists and is unique). Only participants numbered from 1 to k take part in the first round. It ensures that in all other rounds the number of participants is the power of 2. During other rounds, all the participants who still have not left the tournament take part. If during some round, participants numbered p_1 < ....... < p_{2m} take part, then they are split into pairs in the following manner: participant p_{2i-1} plays against participant p_{2i} for each i from 1 to m. The rounds are held until only one participant is left. He is declared the winner of the tournament and he will marry the King's daughter. The princess can't wait to find out who is her future husband. She asked every participant to tell her his luckiness. Assuming they did not lie, she wants to know the probability of each participant winning the tournament. As you are the best friend of the princess, she asks you to help her.",
    "input_details": "The first line of the input contains the number of participants, n (2  n  3 dot 10^5). The second line of the input contains n integer numbers, a_1, ......., a_{n} (1  a_i  10^9). The luckiness of the i-th participant equals to a_i.",
    "output_details": "Print n numbers p_i. The i-th number should be the probability of the i-th participant winning the tournament. The absolute error of your answer must not exceed 10^{-9}.",
    "sample_input": "5\n1 4 1 1 4",
    "sample_output": "0.026 0.3584 0.0676 0.0616 0.4864",
    "tags": ["math", "probabilities", "*3500"]
  },
  {
    "name": "Framing Pictures",
    "question_id": "framing-pictures",
    "question": "Life has been discovered on Venus! What is more, the life forms appear to be convex polygons. An international consortium is designing a probe to send to Venus to take pictures, but they need to estimate the bandwidth needed to send back pictures.When the probe takes a picture of a life form and wishes to send it back to Earth, the bandwidth required is proportional to the area of the bounding box (in other words, the smallest axis-aligned rectangle that contains the life-form). The shape and size of the life forms are known, but the orientation relative to the camera is random. You must thus determine the expected (average) area of the bounding box across all orientations.",
    "input_details": "The input describes the shape of a life form as a convex polygon in two dimensions.The first line of input contains an integer n (3  n  200\\,000) — the number of vertices. The remaining n lines each contain two integers x and y (-10^9  x, y  10^9) — the coordinates of a vertex. The vertices are given in counterclockwise order, and no three vertices lie on a straight line.",
    "output_details": "Output a single line containing the expected area of the bounding box of the polygon. Your answer should have an absolute or relative error of at most 10^{-6}.",
    "sample_input": "4\n0 0\n10 0\n10 10\n0 10",
    "sample_output": "163.661977237",
    "tags": ["geometry", "*2900"]
  },
  {
    "name": "Easy Scheduling",
    "question_id": "easy-scheduling",
    "question": "Eonathan Eostar decided to learn the magic of multiprocessor systems. He has a full binary tree of tasks with height h. In the beginning, there is only one ready task in the tree — the task in the root. At each moment of time, p processes choose at most p ready tasks and perform them. After that, tasks whose parents were performed become ready for the next moment of time. Once the task becomes ready, it stays ready until it is performed. You shall calculate the smallest number of time moments the system needs to perform all the tasks.",
    "input_details": "The first line of the input contains the number of tests t (1  t  5dot 10^5). Each of the next t lines contains the description of a test. A test is described by two integers h (1  h  50) and p (1  p  10^4) — the height of the full binary tree and the number of processes. It is guaranteed that all the tests are different.",
    "output_details": "For each test output one integer on a separate line — the smallest number of time moments the system needs to perform all the tasks.",
    "sample_input": "3\n3 1\n3 2\n10 6",
    "sample_output": "7\n4\n173",
    "tags": ["implementation", "math", "*1200"]
  },
  {
    "name": "Dragon Curve",
    "question_id": "dragon-curve",
    "question": "A dragon curve is a self-similar fractal curve. In this problem, it is a curve that consists of straight-line segments of the same length connected at right angles. A simple way to construct a dragon curve is as follows: take a strip of paper, fold it in half n times in the same direction, then partially unfold it such that the segments are joined at right angles. This is illustrated here:  In this example, a dragon curve of order 3 is constructed. In general, a dragon curve of a higher order will have a dragon curve of a lower order as its prefix. This allows us to define a dragon curve of infinite order, which is the limit of dragon curves of a finite order as the order approaches infinity.Consider four dragon curves of infinite order. Each starts at the origin (the point (0,0)), and the length of each segment is \\sqrt2. The first segments of the curves end at the points (1,1), (-1,1), (-1,-1) and (1,-1), respectively. The first turn of each curve is left (that is, the second segment of the first curve ends at the point (0,2)). In this case, every segment is a diagonal of an axis-aligned unit square with integer coordinates, and it can be proven that there is exactly one segment passing through every such square.Given a point (x,y), your task is to find on which of the four curves lies the segment passing through the square with the opposite corners at (x,y) and (x+1,y+1), as well as the position of that segment on that curve. The curves are numbered 1 through 4. Curve 1 goes through (1,1), 2 through (-1,1), 3 through (-1,-1), and 4 through (1,-1). The segments are numbered starting with 1.",
    "input_details": "The first line contains an integer n (1 n2dot10^5) — the number of test cases.Each of the following n lines contains two integers x and y (-10^9 x,y10^9) — the coordinates.",
    "output_details": "For each test case, print a line containing two integers — the first is the index of the curve (an integer between 1 and 4, inclusive), and the second is the position on the curve (the first segment has the position 1).",
    "sample_input": "5\n0 0\n-2 0\n-7 -7\n5 -9\n9 9",
    "sample_output": "1 1\n2 2\n3 189\n4 186\n2 68",
    "tags": ["*3200"]
  },
  {
    "name": "Cactus Lady and her Cing",
    "question_id": "cactus-lady-and-her-cing",
    "question": "Cactus lady loves her cactuses very much. Especially she likes a small cactus named Cing. Cing can be seen as a connected undirected graph in which every vertex lies on at most one simple cycle. Intuitively, a cactus is a generalization of a tree where some cycles are allowed. Multiedges (multiple edges between a pair of vertices) and loops (edges that connect a vertex to itself) are not allowed.She bought a special grid for her special little cactus Cing. This grid can be represented as a graph consisting of two paths of length 400\\,000, u_{(0, -200\\,000)} - u_{(0, -199\\,999)} - ....... - u_{(0, 200\\,000)} and u_{(1, -200\\,000)} - u_{(1, -199\\,999)} - ....... - u_{(1, 200\\,000)}, connected together by 400\\,001 edges (u_{(0, i)}, u_{(1, i)}) for each i. In other words, a grid can be seen as a ladder.  Cactus lady wants to know whether she can embed Cing into this grid, i.e., map each vertex of the cactus onto a separate vertex of the grid while each edge of the cactus will be mapped onto some edge of the grid.",
    "input_details": "The first line contains an integer t — the number of test cases.Each test case begins with a line containing two integers n and m — the number of vertices and the number of edges in a given cactus, respectively (1  n  200\\,000; 0  m  250\\,000).Each of the following m lines contains two integers v and u, describing the edges of the cactus (1  v, u  n, u \\ne v).The total sum of all n in the input doesn't exceed 200\\,000.",
    "output_details": "Print an answer for each test case in the same order the cases appear in the input.For each test case print \"No\" in the first line, if no layout exists.Otherwise print \"Yes\" in the first line, and the following n lines describing the layout. The i-th of these n lines should contain two integers x_i and y_i, the location of the i-th vertex (0  x_i  1; -200\\,000  y_i  200\\,000).",
    "sample_input": "5\n4 3\n1 2\n2 3\n3 4\n\n8 7\n1 2\n3 2\n2 4\n4 5\n4 6\n6 7\n6 8\n\n5 4\n1 2\n1 3\n1 4\n1 5\n\n8 9\n1 2\n2 3\n3 4\n1 4\n4 5\n5 6\n6 7\n7 8\n5 8\n\n10 10\n1 2\n2 3\n3 4\n4 5\n5 6\n6 1\n3 7\n4 8\n1 9\n6 10",
    "sample_output": "Yes\n0 0\n0 1\n1 1\n1 2\nYes\n0 3\n1 3\n1 4\n1 2\n0 2\n1 1\n0 1\n1 0\nNo\nYes\n0 0\n1 0\n1 1\n0 1\n0 2\n0 3\n1 3\n1 2\nYes\n1 1\n1 2\n1 3\n0 3\n0 2\n0 1\n1 4\n0 4\n1 0\n0 0",
    "tags": ["*3500"]
  },
  {
    "name": "Building Forest Trails",
    "question_id": "building-forest-trails",
    "question": "There are n villages lying equidistant on a circle in the middle of a thick, impassable forest. From ancient times, it was impossible to move from one village to another, but technical progress has changed a lot. Now, there is a technology to build passable trails in the forest. The building process consists of m events. Each event is either building a trail or querying if two villages are connected. Trails are built as straight lines connecting two villages. After a trail is built, anybody can walk along the trail from one village to another. Moreover, if two trails cross, anybody can turn at the intersection, and if other trails leave a village you have just reached, they can also be used to walk along. So, for example, if villages are numbered 1 to 6 in the order around the circle, and there are trails 1 to 3, 2 to 4, and 4 to 6, then all villages, except the 5-th, are reachable from the 1-st village.Given a list of m events, for each query, find if two given villages are reachable from each other at that moment.",
    "input_details": "The first line contains two integers n (2  n  2dot 10^5) and m (1  m  3dot 10^5) — the number of villages and the number of events respectively. Next m lines contain events. Each event description consists of three integers e (e is 1 or 2), v (1  v  n), and u (1  u  n, u \\ne v). If e = 1, then the event is building a trail between villages v and u. If e = 2, then the event is a query if the villages v and u are connected. It is guaranteed that each trail is built at most once. Villages are numbered 1 to n in clockwise order around the circle. ",
    "output_details": "For each query print one character '0' if villages are not reachable, and '1' if villages are reachable from each other. Print answers for all queries as a single string in one line.",
    "sample_input": "6 9\n1 1 3\n1 4 6\n2 3 4\n1 2 4\n2 1 2\n2 1 3\n2 1 4\n2 6 1\n2 5 3",
    "sample_output": "011110",
    "tags": ["data structures", "dsu", "*2800"]
  },
  {
    "name": "Anti-Tetris",
    "question_id": "anti-tetris",
    "question": "Let us consider the game \"Sticky Tetris\". In this game, there is a field of n \\times m squares. Tiles appear on the field and the player can move the tiles. Each tile is a 4-connected set of at most 7 squares.Each new tile appears in any position that fits inside the field, does not intersect any other tile, and the top cell of the tile is at the top row of the field. The player can move the tile left, right, and down, and at any moment the tile must still entirely fit inside the field and must not intersect other tiles. The player can stop the tile at any position at any time. After that, it cannot be moved. Since this is \"Sticky Tetris,\" the tile will not fall once stopped.You are given a final configuration of a \"Sticky Tetris\" game. You need to restore a sequence of steps that leads to that configuration if it exists.",
    "input_details": "The first line contains two integers n and m (1  n, m  50) — the size of the playing field.The next n lines contain a string of m characters each. Each character could be either a '.', or lowercase English letter. Connected components of the same letter correspond to a single tile. Each tile consists of at most 7 squares.",
    "output_details": "If there is no solution, print -1.Otherwise, print k — the number of different tiles that are placed on the field.On the next k lines print the sequence of steps for each of the tiles in the order they are placed. Each line consists of a number x followed by a string with steps. x (1  x  m) is the starting column of the leftmost square in the top row of the tile. The string consists of characters 'L' (for left), 'R' (for right), and 'D' (for down), describing the path of that tile, ending with a single character 'S' (for stop). The final position of the tile determines which tile is being placed. The string with steps can have at most n dot m + 1 characters.",
    "sample_input": "3 2\naa\nab\naa",
    "sample_output": "2\n2 DS\n1 S",
    "tags": ["constructive algorithms", "graphs", "shortest paths", "*2800"]
  },
  {
    "name": "Communication Routing Challenge",
    "question_id": "communication-routing-challenge",
    "question": "In optical communication networks, appropriate path planning can improve the utilization of communication resources and bring a smooth communication experience to users. The following figure shows an inter-satellite optical communication network. User messages are sent from one terrestrial base station (nodes 4 to 7) and transmitted through satellites (nodes 0 to 3) in space to another terrestrial base station (nodes 4 to 7).    In the preceding figures, there are communication connections (edges for short) between base stations and satellites and between satellites. The base stations and satellites are referred to as nodes. User messages are transmitted on these edges and referred to as flows. Some users may make video calls with friends, and some users may send short messages to their family members. Therefore, the message traffic (called flow rate) of each user differs. There are many parallel edges (for example, edges 0, 1, and 2) between two nodes, and the capacity of each edge also differs. Larger capacity indicates that more user messages can be transmitted, as well as shorter transmission distance indicates lower latency and better communication quality. Nodes also have their internal structure. As shown below, some edges inside a node cannot communicate with each other because these edges (constrained edge pair) are not fully connected. For example, edge 5 and edge 7 inside node 2 cannot communicate with each other, and therefore flows cannot pass through node 2 by traversing the two unconnected edges.    Now, in the input network, the source node, target node, and required flow rate for each user flow are specified. Because network resources are limited, paths may not be successfully calculated for all user flows. We hope that you can provide a solution with the highest score.Note, that   all edges are undirected, so flows may come in both directions,  edges has both capacity and length (named distance),  several flows may use the same edge,  flows may come through the same edge in opposite directions simultaneously,  for the purpose of this problem, there is no difference between satellites and base stations, so flows may come through several base stations before reaching the destination station.  Constraints   The capacity of each edge is limited. The total rate of all flows carried by an edge cannot exceed the capacity of the edge. The capacity limits the total flows in both directions.   The calculated flow path does not allow loops or cycles.   Due to the hardware limitation inside satellites, the number of flows passing through a node (including source and target node) cannot exceed the site flow limit (\\mathit{SFL}) of the node. The value of \\mathit{SFL} is 200.   There are multiple parallel edges between two nodes, which may belong to different groups. Links in each group are managed by the same chip on a node, and there is a group flow limit (\\mathit{GFL}). The total number of different flows on all the edges in a group cannot exceed the \\mathit{GFL} of the group. The value of \\mathit{GFL} is 100.   By default, all edges are connected to each other in each node. But there are some constrained edge pairs — the pairs of edges inside specified nodes that cannot communicate with each other.   You can make no more than 2 submissions on each 5 minutes interval. ",
    "input_details": "The first line contains four integers separated by space: \\mathit{NodeCount}, \\mathit{EdgeCount}, \\mathit{ConstrainedCount}, and \\mathit{FlowCount}.  8  \\mathit{NodeCount}  1400,  15  \\mathit{EdgeCount}  15000,  3  \\mathit{ConstrainedCount}  3600,  1  \\mathit{FlowCount}  14000. The next \\mathit{EdgeCount} lines contain information about the network. Each line contains six integers: \\mathit{EdgeID}, \\mathit{GroupID}, \\mathit{StartNodeID}, \\mathit{EndNodeID}, \\mathit{Distance}, and \\mathit{Capacity}.  0  \\mathit{EdgeID} < \\mathit{EdgeCount},  0  \\mathit{GroupID}  4500,  0  \\mathit{StartNodeID}, \\mathit{EndNodeID} < \\mathit{NodeCount},  \\mathit{StartNodeID} \\ne \\mathit{EndNodeID},  100  \\mathit{Distance}  10000,  1 < \\mathit{Capacity}  10^5. It's guaranteed that only multiple edges may share the same \\mathit{GroupID}.The next \\mathit{ConstrainedCount} lines contain information about the edge pairs that are not connected in the specified nodes of the network. All other edges are connected to each other by default. Each line contains three integers: \\mathit{NodeID}, \\mathit{EdgeID}_1, and \\mathit{EdgeID}_2.  0  \\mathit{NodeID} < \\mathit{NodeCount},  0  \\mathit{EdgeID}_1, \\mathit{EdgeID}_2 < \\mathit{EdgeCount},  \\mathit{EdgeID}_1 \\ne \\mathit{EdgeID}_2. The next \\mathit{FlowCount} lines contain information about the flows to be calculated. Each line contains four integers: \\mathit{FlowID}, \\mathit{SourceNode}, \\mathit{TargetNode}, and \\mathit{FlowRate}.  0  \\mathit{FlowID} < \\mathit{FlowCount},  0  \\mathit{SourceNode}, \\mathit{TargetNode} < \\mathit{NodeCount},  \\mathit{SourceNode} \\ne \\mathit{TargetNode},  2  \\mathit{FlowRate}  12000 Don't forget that the \\mathit{SFL} and \\mathit{GFL} mentioned above are also important parameters.For the simplicity, both \\mathit{EdgeID} and \\mathit{FlowID} of the i-th (0-indexed) edge (flow) is always equal to i.",
    "output_details": "In the first line, output the number of your success flows.Next, each line output edge information about the path that a flow passes through. The format is as follows: \\mathit{FlowID}\\ \\mathit{EdgeID}_1\\ \\mathit{EdgeID}_2\\ \\mathit{EdgeID}_3\\ \\dots\\ \\mathit{EdgeID}_n.There is no requirement on the output sequence between flow paths, but edges in one flow must be outputted in order, from source node to target node. Please output all successfully calculated flow paths. For other flows that are not output, the checker determines that you have not found appropriate paths for the flows by default.",
    "sample_input": "le",
    "sample_output": "15 3 1\n0 0 0 1 100 1050\n1 1 0 1 200 2200\n2 1 0 1 200 99400\n3 2 0 3 100 450\n4 3 0 3 500 1120\n5 4 1 2 1000 40000\n6 5 2 3 600 10000\n7 5 2 3 600 10000\n8 6 1 4 120 2500\n9 6 1 4 120 450\n10 7 1 5 170 1250\n11 8 2 5 200 2500\n12 9 3 5 100 1250\n13 10 3 6 300 1150\n14 11 3 7 300 1100\n2 5 7\n2 6 7\n2 6 11\n0 4 6 100",
    "tags": ["*special problem"]
  },
  {
    "name": "Managing Telephone Poles",
    "question_id": "managing-telephone-poles",
    "question": "Mr. Chanek's city can be represented as a plane. He wants to build a housing complex in the city.There are some telephone poles on the plane, which is represented by a grid a of size (n + 1) \\times (m + 1). There is a telephone pole at (x, y) if a_{x, y} = 1.For each point (x, y), define S(x, y) as the square of the Euclidean distance between the nearest pole and (x, y). Formally, the square of the Euclidean distance between two points (x_1, y_1) and (x_2, y_2) is (x_2 - x_1)^2 + (y_2 - y_1)^2.To optimize the building plan, the project supervisor asks you the sum of all S(x, y) for each 0  x  n and 0  y  m. Help him by finding the value of \\sum_{x=0}^{n} {\\sum_{y=0}^{m} {S(x, y)}}.",
    "input_details": "The first line contains two integers n and m (0  n, m < 2000) — the size of the grid.Then (n + 1) lines follow, each containing (m + 1) integers a_{i, j} (0  a_{i, j}  1) — the grid denoting the positions of telephone poles in the plane. There is at least one telephone pole in the given grid.",
    "output_details": "Output an integer denoting the value of \\sum_{x=0}^{n} {\\sum_{y=0}^{m} {S(x, y)}}.",
    "sample_input": "2 2\n101\n000\n000",
    "sample_output": "18",
    "tags": ["data structures", "geometry", "*2400"]
  },
  {
    "name": "Longest Array Deconstruction",
    "question_id": "longest-array-deconstruction",
    "question": "Mr. Chanek gives you a sequence a indexed from 1 to n. Define f(a) as the number of indices where a_i = i. You can pick an element from the current sequence and remove it, then concatenate the remaining elements together. For example, if you remove the 3-rd element from the sequence [4, 2, 3, 1], the resulting sequence will be [4, 2, 1]. You want to remove some elements from a in order to maximize f(a), using zero or more operations. Find the largest possible f(a).",
    "input_details": "The first line contains one integer n (1  n  2 dot 10^5) — the initial length of the sequence.The second line contains n integers a_1, a_2, ......., a_n (1  a_i  2 dot 10^5) — the initial sequence a.",
    "output_details": "Output an integer denoting the largest f(a) that can be obtained by doing zero or more operations.",
    "sample_input": "7\n2 1 4 2 5 3 7",
    "sample_output": "3",
    "tags": ["data structures", "divide and conquer", "dp", "sortings", "*2100"]
  },
  {
    "name": "Knitting Batik",
    "question_id": "knitting-batik",
    "question": "Mr. Chanek wants to knit a batik, a traditional cloth from Indonesia. The cloth forms a grid a with size n \\times m. There are k colors, and each cell in the grid can be one of the k colors.Define a sub-rectangle as an ordered pair of two cells ((x_1, y_1), (x_2, y_2)), denoting the top-left cell and bottom-right cell (inclusively) of a sub-rectangle in a. Two sub-rectangles ((x_1, y_1), (x_2, y_2)) and ((x_3, y_3), (x_4, y_4)) have the same pattern if and only if the following holds:   they have the same width (x_2 - x_1 = x_4 - x_3);  they have the same height (y_2 - y_1 = y_4 - y_3);  for every pair (i, j) where 0  i  x_2 - x_1 and 0  j  y_2 - y_1, the color of cells (x_1 + i, y_1 + j) and (x_3 + i, y_3 + j) are equal. Count the number of possible batik color combinations, such that the subrectangles ((a_x, a_y),(a_x + r - 1, a_y + c - 1)) and ((b_x, b_y),(b_x + r - 1, b_y + c - 1)) have the same pattern.Output the answer modulo 10^9 + 7.",
    "input_details": "The first line contains five integers n, m, k, r, and c (1  n, m  10^9, 1  k  10^9, 1  r  \\min(10^6, n), 1  c  \\min(10^6, m)) — the size of the batik, the number of colors, and size of the sub-rectangle.The second line contains four integers a_x, a_y, b_x, and b_y (1  a_x, b_x  n, 1  a_y, b_y  m) — the top-left corners of the first and second sub-rectangle. Both of the sub-rectangles given are inside the grid (1  a_x + r - 1, b_x + r - 1  n, 1  a_y + c - 1, b_y + c - 1  m).",
    "output_details": "Output an integer denoting the number of possible batik color combinations modulo 10^9 + 7.",
    "sample_input": "3 3 2 2 2\n1 1 2 2",
    "sample_output": "32",
    "tags": ["implementation", "math", "*2200"]
  },
  {
    "name": "Jeopardy of Dropped Balls",
    "question_id": "jeopardy-of-dropped-balls",
    "question": "Mr. Chanek has a new game called Dropping Balls. Initially, Mr. Chanek has a grid a of size n \\times mEach cell (x,y) contains an integer a_{x,y} denoting the direction of how the ball will move.  a_{x,y}=1 — the ball will move to the right (the next cell is (x, y + 1));  a_{x,y}=2 — the ball will move to the bottom (the next cell is (x + 1, y));  a_{x,y}=3 — the ball will move to the left (the next cell is (x, y - 1)). Every time a ball leaves a cell (x,y), the integer a_{x,y} will change to 2. Mr. Chanek will drop k balls sequentially, each starting from the first row, and on the c_1, c_2, \\dots, c_k-th (1  c_i  m) columns.Determine in which column each ball will end up in (position of the ball after leaving the grid).",
    "input_details": "The first line contains three integers n, m, and k (1  n, m  1000, 1  k  10^5) — the size of the grid and the number of balls dropped by Mr. Chanek.The i-th of the next n lines contains m integers a_{i,1},a_{i,2},.......,a_{i,m} (1  a_{i,j}  3). It will satisfy a_{i, 1} \\ne 3 and a_{i, m} \\ne 1.The next line contains k integers c_1, c_2, ......., c_k (1  c_i  m) — the balls' column positions dropped by Mr. Chanek sequentially.",
    "output_details": "Output k integers — the i-th integer denoting the column where the i-th ball will end.",
    "sample_input": "5 5 3\n1 2 3 3 3\n2 2 2 2 2\n2 2 2 2 2\n2 2 2 2 2\n2 2 2 2 2\n1 2 1",
    "sample_output": "2 2 1",
    "tags": ["binary search", "brute force", "dsu", "implementation", "*1500"]
  },
  {
    "name": "Illusions of the Desert",
    "question_id": "illusions-of-the-desert",
    "question": "Chanek Jones is back, helping his long-lost relative Indiana Jones, to find a secret treasure in a maze buried below a desert full of illusions.The map of the labyrinth forms a tree with n rooms numbered from 1 to n and n - 1 tunnels connecting them such that it is possible to travel between each pair of rooms through several tunnels.The i-th room (1  i  n) has a_i illusion rate. To go from the x-th room to the y-th room, there must exist a tunnel between x and y, and it takes \\max(|a_x + a_y|, |a_x - a_y|) energy. |z| denotes the absolute value of z.To prevent grave robbers, the maze can change the illusion rate of any room in it. Chanek and Indiana would ask q queries.There are two types of queries to be done:  1\\ u\\ c — The illusion rate of the x-th room is changed to c (1  u  n, 0  |c|  10^9).  2\\ u\\ v — Chanek and Indiana ask you the minimum sum of energy needed to take the secret treasure at room v if they are initially at room u (1  u, v  n). Help them, so you can get a portion of the treasure!",
    "input_details": "The first line contains two integers n and q (2  n  10^5, 1  q  10^5) — the number of rooms in the maze and the number of queries.The second line contains n integers a_1, a_2, ......., a_n (0  |a_i|  10^9) — inital illusion rate of each room.The i-th of the next n-1 lines contains two integers s_i and t_i (1  s_i, t_i  n), meaning there is a tunnel connecting s_i-th room and t_i-th room. The given edges form a tree.The next q lines contain the query as described. The given queries are valid.",
    "output_details": "For each type 2 query, output a line containing an integer — the minimum sum of energy needed for Chanek and Indiana to take the secret treasure.",
    "sample_input": "6 4\n10 -9 2 -1 4 -6\n1 5\n5 4\n5 6\n6 2\n6 3\n2 1 2\n1 1 -3\n2 1 2\n2 3 3",
    "sample_output": "39\n32\n0",
    "tags": ["data structures", "trees", "*2300"]
  },
  {
    "name": "Holiday Wall Ornaments",
    "question_id": "holiday-wall-ornaments",
    "question": "The Winter holiday will be here soon. Mr. Chanek wants to decorate his house's wall with ornaments. The wall can be represented as a binary string a of length n. His favorite nephew has another binary string b of length m (m  n).Mr. Chanek's nephew loves the non-negative integer k. His nephew wants exactly k occurrences of b as substrings in a. However, Mr. Chanek does not know the value of k. So, for each k (0  k  n - m + 1), find the minimum number of elements in a that have to be changed such that there are exactly k occurrences of b in a.A string s occurs exactly k times in t if there are exactly k different pairs (p,q) such that we can obtain s by deleting p characters from the beginning and q characters from the end of t.",
    "input_details": "The first line contains two integers n and m (1  m  n  500) — size of the binary string a and b respectively.The second line contains a binary string a of length n.The third line contains a binary string b of length m.",
    "output_details": "Output n - m + 2 integers — the (k+1)-th integer denotes the minimal number of elements in a that have to be changed so there are exactly k occurrences of b as a substring in a.",
    "sample_input": "9 3\n100101011\n101",
    "sample_output": "1 1 0 1 6 -1 -1 -1",
    "tags": ["dp", "strings", "*2200"]
  },
  {
    "name": "GCD Festival",
    "question_id": "gcd-festival",
    "question": "Mr. Chanek has an array a of n integers. The prettiness value of a is denoted as:\\sum_{i=1}^{n} {\\sum_{j=1}^{n} {\\gcd(a_i, a_j) dot \\gcd(i, j)}}where \\gcd(x, y) denotes the greatest common divisor (GCD) of integers x and y.In other words, the prettiness value of an array a is the total sum of \\gcd(a_i, a_j) dot \\gcd(i, j) for all pairs (i, j).Help Mr. Chanek find the prettiness value of a, and output the result modulo 10^9 + 7!",
    "input_details": "The first line contains an integer n (2  n  10^5).The second line contains n integers a_1, a_2, ......., a_n (1  a_i  10^5).",
    "output_details": "Output an integer denoting the prettiness value of a modulo 10^9 + 7.",
    "sample_input": "5\n3 6 2 1 4",
    "sample_output": "77",
    "tags": ["math", "number theory", "*2200"]
  },
  {
    "name": "Finding Expected Value",
    "question_id": "finding-expected-value",
    "question": "Mr. Chanek opened a letter from his fellow, who is currently studying at Singanesia. Here is what it says.Define an array b (0  b_i < k) with n integers. While there exists a pair (i, j) such that b_i \\ne b_j, do the following operation:  Randomly pick a number i satisfying 0  i < n. Note that each number i has a probability of \\frac{1}{n} to be picked.  Randomly Pick a number j satisfying 0  j < k.  Change the value of b_i to j. It is possible for b_i to be changed to the same value. Denote f(b) as the expected number of operations done to b until all elements of b are equal. You are given two integers n and k, and an array a (-1  a_i < k) of n integers. For every index i with a_i = -1, replace a_i with a random number j satisfying 0  j < k. Let c be the number of occurrences of -1 in a. There are k^c possibilites of a after the replacement, each with equal probability of being the final array.Find the expected value of f(a) modulo 10^9 + 7. Formally, let M = 10^9 + 7. It can be shown that the answer can be expressed as an irreducible fraction \\frac{p}{q}, where p and q are integers and q \\not \\equiv 0 \\pmod{M}. Output the integer equal to p dot q^{-1} \\bmod M. In other words, output such an integer x that 0  x < M and x dot q \\equiv p \\pmod{M}.After reading the letter, Mr. Chanek gave the task to you. Solve it for the sake of their friendship!",
    "input_details": "The first line contains two integers n and k (2  n  10^5, 2  k  10^9). The second line contains n integers a_1, a_2, ......., a_n (-1  a_i < k).",
    "output_details": "Output an integer denoting the expected value of f(a) modulo 10^9 + 7.",
    "sample_input": "2 2\n0 1",
    "sample_output": "2",
    "tags": ["math", "*2900"]
  },
  {
    "name": "Eye-Pleasing City Park Tour",
    "question_id": "eye-pleasing-city-park-tour",
    "question": "There is a city park represented as a tree with n attractions as its vertices and n - 1 rails as its edges. The i-th attraction has happiness value a_i.Each rail has a color. It is either black if t_i = 0, or white if t_i = 1. Black trains only operate on a black rail track, and white trains only operate on a white rail track. If you are previously on a black train and want to ride a white train, or you are previously on a white train and want to ride a black train, you need to use 1 ticket.The path of a tour must be a simple path — it must not visit an attraction more than once. You do not need a ticket the first time you board a train. You only have k tickets, meaning you can only switch train types at most k times. In particular, you do not need a ticket to go through a path consisting of one rail color.Define f(u, v) as the sum of happiness values of the attractions in the tour (u, v), which is a simple path that starts at the u-th attraction and ends at the v-th attraction. Find the sum of f(u,v) for all valid tours (u, v) (1  u  v  n) that does not need more than k tickets, modulo 10^9 + 7.",
    "input_details": "The first line contains two integers n and k (2  n  2 dot 10^5, 0  k  n-1) — the number of attractions in the city park and the number of tickets you have.The second line contains n integers a_1, a_2,......., a_n (0  a_i  10^9) — the happiness value of each attraction.The i-th of the next n - 1 lines contains three integers u_i, v_i, and t_i (1  u_i, v_i  n, 0  t_i  1) — an edge between vertices u_i and v_i with color t_i. The given edges form a tree.",
    "output_details": "Output an integer denoting the total happiness value for all valid tours (u, v) (1  u  v  n), modulo 10^9 + 7.",
    "sample_input": "5 0\n1 3 2 6 4\n1 2 1\n1 4 0\n3 2 1\n2 5 0",
    "sample_output": "45",
    "tags": ["data structures", "trees", "*2600"]
  },
  {
    "name": "Divisible by Twenty-Five",
    "question_id": "divisible-by-twenty-five",
    "question": "Mr. Chanek has an integer represented by a string s. Zero or more digits have been erased and are denoted by the character _. There are also zero or more digits marked by the character X, meaning they're the same digit.Mr. Chanek wants to count the number of possible integer s, where s is divisible by 25. Of course, s must not contain any leading zero. He can replace the character _ with any digit. He can also replace the character X with any digit, but it must be the same for every character X.As a note, a leading zero is any 0 digit that comes before the first nonzero digit in a number string in positional notation. For example, 0025 has two leading zeroes. An exception is the integer zero, (0 has no leading zero, but 0000 has three leading zeroes).",
    "input_details": "One line containing the string s (1  |s|  8). The string s consists of the characters 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, _, and X.",
    "output_details": "Output an integer denoting the number of possible integer s.",
    "sample_input": "25",
    "sample_output": "1",
    "tags": ["brute force", "dfs and similar", "dp", "*1800"]
  },
  {
    "name": "Cyclic Sum",
    "question_id": "cyclic-sum",
    "question": "Denote a cyclic sequence of size n as an array s such that s_n is adjacent to s_1. The segment s[r, l] where l < r is the concatenation of s[r, n] and s[1, l].You are given an array a consisting of n integers. Define b as the cyclic sequence obtained from concatenating m copies of a. Note that b has size n dot m.You are given an integer k where k = 1 or k is a prime number. Find the number of different segments in b where the sum of elements in the segment is divisible by k.Two segments are considered different if the set of indices of the segments are different. For example, when n = 3 and m = 2, the set of indices for segment s[2, 5] is \\{2, 3, 4, 5\\}, and for segment s[5, 2] is \\{5, 6, 1, 2\\}. In particular, the segments s[1, 6], s[2,1], ......., s[6, 5] are considered as the same segment.Output the answer modulo 10^9 + 7.",
    "input_details": "The first line contains three integers n, m, and k (1  n, m, k  2 dot 10^5, k = 1 or k is a prime number).The second line contains n integers a_1, a_2, ......., a_n (0  a_i  2 dot 10^5).",
    "output_details": "Output an integer denoting the number of different segments in b where the sum of elements in the segment is divisible by k, modulo 10^9 + 7.",
    "sample_input": "5 1 5\n1 2 3 4 3",
    "sample_output": "4",
    "tags": ["data structures", "fft", "number theory", "*3000"]
  },
  {
    "name": "Building an Amusement Park",
    "question_id": "building-an-amusement-park",
    "question": "Mr. Chanek lives in a city represented as a plane. He wants to build an amusement park in the shape of a circle of radius r. The circle must touch the origin (point (0, 0)).There are n bird habitats that can be a photo spot for the tourists in the park. The i-th bird habitat is at point p_i = (x_i, y_i). Find the minimum radius r of a park with at least k bird habitats inside. A point is considered to be inside the park if and only if the distance between p_i and the center of the park is less than or equal to the radius of the park. Note that the center and the radius of the park do not need to be integers.In this problem, it is guaranteed that the given input always has a solution with r  2 dot 10^5.",
    "input_details": "The first line contains two integers n and k (1  n  10^5, 1  k  n) — the number of bird habitats in the city and the number of bird habitats required to be inside the park.The i-th of the next n lines contains two integers x_i and y_i (0  |x_i|, |y_i|  10^5) — the position of the i-th bird habitat.",
    "output_details": "Output a single real number r denoting the minimum radius of a park with at least k bird habitats inside. It is guaranteed that the given input always has a solution with r  2 dot 10^5.Your answer is considered correct if its absolute or relative error does not exceed 10^{-4}.Formally, let your answer be a, and the jury's answer be b. Your answer is accepted if and only if \\frac{|a - b|}{\\max{(1, |b|)}}  10^{-4}.",
    "sample_input": "8 4\n-3 1\n-4 4\n1 5\n2 2\n2 -2\n-2 -4\n-1 -1\n-6 0",
    "sample_output": "3.1622776589",
    "tags": ["binary search", "geometry", "*2300"]
  },
  {
    "name": "Another Sorting Problem",
    "question_id": "another-sorting-problem",
    "question": "Andi and Budi were given an assignment to tidy up their bookshelf of n books. Each book is represented by the book title — a string s_i numbered from 1 to n, each with length m. Andi really wants to sort the book lexicographically ascending, while Budi wants to sort it lexicographically descending.Settling their fight, they decided to combine their idea and sort it asc-desc-endingly, where the odd-indexed characters will be compared ascendingly, and the even-indexed characters will be compared descendingly.A string a occurs before a string b in asc-desc-ending order if and only if in the first position where a and b differ, the following holds:  if it is an odd position, the string a has a letter that appears earlier in the alphabet than the corresponding letter in b;  if it is an even position, the string a has a letter that appears later in the alphabet than the corresponding letter in b. ",
    "input_details": "The first line contains two integers n and m (1  n dot m  10^6).The i-th of the next n lines contains a string s_i consisting of m uppercase Latin letters — the book title. The strings are pairwise distinct.",
    "output_details": "Output n integers — the indices of the strings after they are sorted asc-desc-endingly.",
    "sample_input": "5 2\nAA\nAB\nBB\nBA\nAZ",
    "sample_output": "5 2 1 3 4",
    "tags": ["data structures", "sortings", "strings", "*1100"]
  },
  {
    "name": "Occurrences",
    "question_id": "occurrences",
    "question": "A subarray of array a from index l to the index r is the array [a_l, a_{l+1}, \\dots, a_{r}]. The number of occurrences of the array b in the array a is the number of subarrays of a such that they are equal to b.You are given n arrays A_1, A_2, \\dots, A_n; the elements of these arrays are integers from 1 to k. You have to build an array a consisting of m integers from 1 to k in such a way that, for every given subarray A_i, the number of occurrences of A_i in the array a is not less than the number of occurrences of each non-empty subarray of A_i in a. Note that if A_i doesn't occur in a, and no subarray of A_i occurs in a, this condition is still met for A_i.Your task is to calculate the number of different arrays a you can build, and print it modulo 998244353.",
    "input_details": "The first line contains three integers n, m and k (1  n, m, k  3 dot 10^5) — the number of the given arrays, the desired length of the array a, and the upper bound on the values in the arrays.Then n lines follow. The i-th line represents the array A_i. The first integer in the i-th line is c_i (1  c_i  m) — the number of elements in A_i; then, c_i integers from 1 to k follow — the elements of the array A_i.Additional constraint on the input: \\sum\\limits_{i=1}^n c_i  3 dot 10^5; i. e., the number of elements in the given arrays in total does not exceed 3 dot 10^5.",
    "output_details": "Print one integer — the number of different arrays a you can build, taken modulo 998244353.",
    "sample_input": "2 4 3\n2 1 2\n1 3",
    "sample_output": "5",
    "tags": [
      "combinatorics",
      "dfs and similar",
      "dp",
      "dsu",
      "fft",
      "graphs",
      "*2700"
    ]
  },
  {
    "name": "Coloring",
    "question_id": "coloring",
    "question": "A matrix of size n \\times m, such that each cell of it contains either 0 or 1, is considered beautiful if the sum in every contiguous submatrix of size 2 \\times 2 is exactly 2, i. e. every \"square\" of size 2 \\times 2 contains exactly two 1's and exactly two 0's.You are given a matrix of size n \\times m. Initially each cell of this matrix is empty. Let's denote the cell on the intersection of the x-th row and the y-th column as (x, y). You have to process the queries of three types:  x y -1 — clear the cell (x, y), if there was a number in it;  x y 0 — write the number 0 in the cell (x, y), overwriting the number that was there previously (if any);  x y 1 — write the number 1 in the cell (x, y), overwriting the number that was there previously (if any). After each query, print the number of ways to fill the empty cells of the matrix so that the resulting matrix is beautiful. Since the answers can be large, print them modulo 998244353.",
    "input_details": "The first line contains three integers n, m and k (2  n, m  10^6; 1  k  3 dot 10^5) — the number of rows in the matrix, the number of columns, and the number of queries, respectively.Then k lines follow, the i-th of them contains three integers x_i, y_i, t_i (1  x_i  n; 1  y_i  m; -1  t_i  1) — the parameters for the i-th query.",
    "output_details": "For each query, print one integer — the number of ways to fill the empty cells of the matrix after the respective query, taken modulo 998244353.",
    "sample_input": "2 2 7\n1 1 1\n1 2 1\n2 1 1\n1 1 0\n1 2 -1\n2 1 -1\n1 1 -1",
    "sample_output": "3\n1\n0\n1\n2\n3\n6",
    "tags": [
      "combinatorics",
      "constructive algorithms",
      "implementation",
      "math",
      "*2500"
    ]
  },
  {
    "name": "The Strongest Build",
    "question_id": "the-strongest-build",
    "question": "Ivan is playing yet another roguelike computer game. He controls a single hero in the game. The hero has n equipment slots. There is a list of c_i items for the i-th slot, the j-th of them increases the hero strength by a_{i,j}. The items for each slot are pairwise distinct and are listed in the increasing order of their strength increase. So, a_{i,1} < a_{i,2} < \\dots < a_{i,c_i}.For each slot Ivan chooses exactly one item. Let the chosen item for the i-th slot be the b_i-th item in the corresponding list. The sequence of choices [b_1, b_2, \\dots, b_n] is called a build.The strength of a build is the sum of the strength increases of the items in it. Some builds are banned from the game. There is a list of m pairwise distinct banned builds. It's guaranteed that there's at least one build that's not banned.What is the build with the maximum strength that is not banned from the game? If there are multiple builds with maximum strength, print any of them.",
    "input_details": "The first line contains a single integer n (1  n  10) — the number of equipment slots.The i-th of the next n lines contains the description of the items for the i-th slot. First, one integer c_i (1  c_i  2 dot 10^5) — the number of items for the i-th slot. Then c_i integers a_{i,1}, a_{i,2}, \\dots, a_{i,c_i} (1  a_{i,1} < a_{i,2} < \\dots < a_{i,c_i}  10^8).The sum of c_i doesn't exceed 2 dot 10^5.The next line contains a single integer m (0  m  10^5) — the number of banned builds.Each of the next m lines contains a description of a banned build — a sequence of n integers b_1, b_2, \\dots, b_n (1  b_i  c_i).The builds are pairwise distinct, and there's at least one build that's not banned.",
    "output_details": "Print the build with the maximum strength that is not banned from the game. If there are multiple builds with maximum strength, print any of them.",
    "sample_input": "3\n3 1 2 3\n2 1 5\n3 2 4 6\n2\n3 2 3\n3 2 2",
    "sample_output": "2 2 3",
    "tags": [
      "binary search",
      "brute force",
      "data structures",
      "dfs and similar",
      "graphs",
      "greedy",
      "hashing",
      "implementation",
      "*2000"
    ]
  },
  {
    "name": "Slay the Dragon",
    "question_id": "slay-the-dragon",
    "question": "Recently, Petya learned about a new game \"Slay the Dragon\". As the name suggests, the player will have to fight with dragons. To defeat a dragon, you have to kill it and defend your castle. To do this, the player has a squad of n heroes, the strength of the i-th hero is equal to a_i.According to the rules of the game, exactly one hero should go kill the dragon, all the others will defend the castle. If the dragon's defense is equal to x, then you have to send a hero with a strength of at least x to kill it. If the dragon's attack power is y, then the total strength of the heroes defending the castle should be at least y.The player can increase the strength of any hero by 1 for one gold coin. This operation can be done any number of times.There are m dragons in the game, the i-th of them has defense equal to x_i and attack power equal to y_i. Petya was wondering what is the minimum number of coins he needs to spend to defeat the i-th dragon.Note that the task is solved independently for each dragon (improvements are not saved).",
    "input_details": "The first line contains a single integer n (2  n  2 dot 10^5) — number of heroes.The second line contains n integers a_1, a_2, \\dots, a_n (1  a_i  10^{12}), where a_i is the strength of the i-th hero.The third line contains a single integer m (1  m  2 dot 10^5) — the number of dragons.The next m lines contain two integers each, x_i and y_i (1  x_i  10^{12}; 1  y_i  10^{18}) — defense and attack power of the i-th dragon.",
    "output_details": "Print m lines, i-th of which contains a single integer — the minimum number of coins that should be spent to defeat the i-th dragon.",
    "sample_input": "4\n3 6 2 3\n5\n3 12\n7 9\n4 14\n1 10\n8 7",
    "sample_output": "1\n2\n4\n0\n2",
    "tags": ["binary search", "greedy", "sortings", "ternary search", "*1300"]
  },
  {
    "name": "Combinatorics Homework",
    "question_id": "combinatorics-homework",
    "question": "You are given four integer values a, b, c and m.Check if there exists a string that contains:   a letters 'A';  b letters 'B';  c letters 'C';  no other letters;  exactly m pairs of adjacent equal letters (exactly m such positions i that the i-th letter is equal to the (i+1)-th one). ",
    "input_details": "The first line contains a single integer t (1  t  10^4) — the number of testcases.Each of the next t lines contains the description of the testcase — four integers a, b, c and m (1  a, b, c  10^8; 0  m  10^8).",
    "output_details": "For each testcase print \"YES\" if there exists a string that satisfies all the requirements. Print \"NO\" if there are no such strings.You may print every letter in any case you want (so, for example, the strings yEs, yes, Yes and YES will all be recognized as positive answer).",
    "sample_input": "3\n2 2 1 0\n1 1 1 1\n1 2 3 2",
    "sample_output": "YES\nNO\nYES",
    "tags": ["combinatorics", "greedy", "math", "*1100"]
  },
  {
    "name": "Regular Bracket Sequences",
    "question_id": "regular-bracket-sequences",
    "question": "A bracket sequence is a string containing only characters \"(\" and \")\". A regular bracket sequence is a bracket sequence that can be transformed into a correct arithmetic expression by inserting characters \"1\" and \"+\" between the original characters of the sequence. For example, bracket sequences \"()()\" and \"(())\" are regular (the resulting expressions are: \"(1)+(1)\" and \"((1+1)+1)\"), and \")(\", \"(\" and \")\" are not.You are given an integer n. Your goal is to construct and print exactly n different regular bracket sequences of length 2n.",
    "input_details": "The first line contains one integer t (1  t  50) — the number of test cases.Each test case consists of one line containing one integer n (1  n  50).",
    "output_details": "For each test case, print n lines, each containing a regular bracket sequence of length exactly 2n. All bracket sequences you output for a testcase should be different (though they may repeat in different test cases). If there are multiple answers, print any of them. It can be shown that it's always possible.",
    "sample_input": "3\n3\n1\n3",
    "sample_output": "()()()\n((()))\n(()())\n()\n((()))\n(())()\n()(())",
    "tags": ["constructive algorithms", "*800"]
  },
  {
    "name": "Jeopardy of Dropped Balls",
    "question_id": "jeopardy-of-dropped-balls",
    "question": "Mr. Chanek has a new game called Dropping Balls. Initially, Mr. Chanek has a grid a of size n * mEach cell (x,y) contains an integer a_{x,y} denoting the direction of how the ball will move.  a_{x,y}=1 — the ball will move to the right (the next cell is (x, y + 1));  a_{x,y}=2 — the ball will move to the bottom (the next cell is (x + 1, y));  a_{x,y}=3 — the ball will move to the left (the next cell is (x, y - 1)). Every time a ball leaves a cell (x,y), the integer a_{x,y} will change to 2. Mr. Chanek will drop k balls sequentially, each starting from the first row, and on the c_1, c_2, ..., c_k-th (1 <= c_i <= m) columns.Determine in which column each ball will end up in (position of the ball after leaving the grid).",
    "input_details": "The first line contains three integers n, m, and k (1 <= n, m <= 1000, 1 <= k <= 10^5) — the size of the grid and the number of balls dropped by Mr. Chanek.The i-th of the next n lines contains m integers a_{i,1},a_{i,2},....,a_{i,m} (1 <= a_{i,j} <= 3). It will satisfy a_{i, 1} \n 3 and a_{i, m} \n 1.The next line contains k integers c_1, c_2, ...., c_k (1 <= c_i <= m) — the balls' column positions dropped by Mr. Chanek sequentially.",
    "output_details": "Output k integers — the i-th integer denoting the column where the i-th ball will end.",
    "sample_input": "5 5 3\n1 2 3 3 3\n2 2 2 2 2\n2 2 2 2 2\n2 2 2 2 2\n2 2 2 2 2\n1 2 1",
    "sample_output": "2 2 1",
    "tags": ["binary search", "brute force", "dsu", "implementation", "*1500"]
  },
  {
    "name": "Illusions of the Desert",
    "question_id": "illusions-of-the-desert",
    "question": "Chanek Jones is back, helping his long-lost relative Indiana Jones, to find a secret treasure in a maze buried below a desert full of illusions.The map of the labyrinth forms a tree with n rooms numbered from 1 to n and n - 1 tunnels connecting them such that it is possible to travel between each pair of rooms through several tunnels.The i-th room (1 <= i <= n) has a_i illusion rate. To go from the x-th room to the y-th room, there must exist a tunnel between x and y, and it takes \\max(|a_x + a_y|, |a_x - a_y|) energy. |z| denotes the absolute value of z.To prevent grave robbers, the maze can change the illusion rate of any room in it. Chanek and Indiana would ask q queries.There are two types of queries to be done:  1\\ u\\ c — The illusion rate of the x-th room is changed to c (1 <= u <= n, 0 <= |c| <= 10^9).  2\\ u\\ v — Chanek and Indiana ask you the minimum sum of energy needed to take the secret treasure at room v if they are initially at room u (1 <= u, v <= n). Help them, so you can get a portion of the treasure!",
    "input_details": "The first line contains two integers n and q (2 <= n <= 10^5, 1 <= q <= 10^5) — the number of rooms in the maze and the number of queries.The second line contains n integers a_1, a_2, ...., a_n (0 <= |a_i| <= 10^9) — inital illusion rate of each room.The i-th of the next n-1 lines contains two integers s_i and t_i (1 <= s_i, t_i <= n), meaning there is a tunnel connecting s_i-th room and t_i-th room. The given edges form a tree.The next q lines contain the query as described. The given queries are valid.",
    "output_details": "For each type 2 query, output a line containing an integer — the minimum sum of energy needed for Chanek and Indiana to take the secret treasure.",
    "sample_input": "6 4\n10 -9 2 -1 4 -6\n1 5\n5 4\n5 6\n6 2\n6 3\n2 1 2\n1 1 -3\n2 1 2\n2 3 3",
    "sample_output": "39\n32\n0",
    "tags": ["data structures", "trees", "*2300"]
  },
  {
    "name": "Holiday Wall Ornaments",
    "question_id": "holiday-wall-ornaments",
    "question": "The Winter holiday will be here soon. Mr. Chanek wants to decorate his house's wall with ornaments. The wall can be represented as a binary string a of length n. His favorite nephew has another binary string b of length m (m <= n).Mr. Chanek's nephew loves the non-negative integer k. His nephew wants exactly k occurrences of b as substrings in a. However, Mr. Chanek does not know the value of k. So, for each k (0 <= k <= n - m + 1), find the minimum number of elements in a that have to be changed such that there are exactly k occurrences of b in a.A string s occurs exactly k times in t if there are exactly k different pairs (p,q) such that we can obtain s by deleting p characters from the beginning and q characters from the end of t.",
    "input_details": "The first line contains two integers n and m (1 <= m <= n <= 500) — size of the binary string a and b respectively.The second line contains a binary string a of length n.The third line contains a binary string b of length m.",
    "output_details": "Output n - m + 2 integers — the (k+1)-th integer denotes the minimal number of elements in a that have to be changed so there are exactly k occurrences of b as a substring in a.",
    "sample_input": "9 3\n100101011\n101",
    "sample_output": "1 1 0 1 6 -1 -1 -1",
    "tags": ["dp", "strings", "*2200"]
  },
  {
    "name": "GCD Festival",
    "question_id": "gcd-festival",
    "question": "Mr. Chanek has an array a of n integers. The prettiness value of a is denoted as:\\sum_{i=1}^{n} {\\sum_{j=1}^{n} {gcd(a_i, a_j) . gcd(i, j)}}where gcd(x, y) denotes the greatest common divisor (GCD) of integers x and y.In other words, the prettiness value of an array a is the total sum of gcd(a_i, a_j) . gcd(i, j) for all pairs (i, j).Help Mr. Chanek find the prettiness value of a, and output the result modulo 10^9 + 7!",
    "input_details": "The first line contains an integer n (2 <= n <= 10^5).The second line contains n integers a_1, a_2, ...., a_n (1 <= a_i <= 10^5).",
    "output_details": "Output an integer denoting the prettiness value of a modulo 10^9 + 7.",
    "sample_input": "5\n3 6 2 1 4",
    "sample_output": "77",
    "tags": ["math", "number theory", "*2200"]
  },
  {
    "name": "Finding Expected Value",
    "question_id": "finding-expected-value",
    "question": "Mr. Chanek opened a letter from his fellow, who is currently studying at Singanesia. Here is what it says.Define an array b (0 <= b_i < k) with n integers. While there exists a pair (i, j) such that b_i \n b_j, do the following operation:  Randomly pick a number i satisfying 0 <= i < n. Note that each number i has a probability of \\frac{1}{n} to be picked.  Randomly Pick a number j satisfying 0 <= j < k.  Change the value of b_i to j. It is possible for b_i to be changed to the same value. Denote f(b) as the expected number of operations done to b until all elements of b are equal. You are given two integers n and k, and an array a (-1 <= a_i < k) of n integers. For every index i with a_i = -1, replace a_i with a random number j satisfying 0 <= j < k. Let c be the number of occurrences of -1 in a. There are k^c possibilites of a after the replacement, each with equal probability of being the final array.Find the expected value of f(a) modulo 10^9 + 7. Formally, let M = 10^9 + 7. It can be shown that the answer can be expressed as an irreducible fraction \\frac{p}{q}, where p and q are integers and q ! = 0 mod{M}. Output the integer equal to p . q^{-1} mod M. In other words, output such an integer x that 0 <= x < M and x . q = p mod{M}.After reading the letter, Mr. Chanek gave the task to you. Solve it for the sake of their friendship!",
    "input_details": "The first line contains two integers n and k (2 <= n <= 10^5, 2 <= k <= 10^9). The second line contains n integers a_1, a_2, ...., a_n (-1 <= a_i < k).",
    "output_details": "Output an integer denoting the expected value of f(a) modulo 10^9 + 7.",
    "sample_input": "2 2\n0 1",
    "sample_output": "2",
    "tags": ["math", "*2900"]
  },
  {
    "name": "Eye-Pleasing City Park Tour",
    "question_id": "eye-pleasing-city-park-tour",
    "question": "There is a city park represented as a tree with n attractions as its vertices and n - 1 rails as its edges. The i-th attraction has happiness value a_i.Each rail has a color. It is either black if t_i = 0, or white if t_i = 1. Black trains only operate on a black rail track, and white trains only operate on a white rail track. If you are previously on a black train and want to ride a white train, or you are previously on a white train and want to ride a black train, you need to use 1 ticket.The path of a tour must be a simple path — it must not visit an attraction more than once. You do not need a ticket the first time you board a train. You only have k tickets, meaning you can only switch train types at most k times. In particular, you do not need a ticket to go through a path consisting of one rail color.Define f(u, v) as the sum of happiness values of the attractions in the tour (u, v), which is a simple path that starts at the u-th attraction and ends at the v-th attraction. Find the sum of f(u,v) for all valid tours (u, v) (1 <= u <= v <= n) that does not need more than k tickets, modulo 10^9 + 7.",
    "input_details": "The first line contains two integers n and k (2 <= n <= 2 . 10^5, 0 <= k <= n-1) — the number of attractions in the city park and the number of tickets you have.The second line contains n integers a_1, a_2,...., a_n (0 <= a_i <= 10^9) — the happiness value of each attraction.The i-th of the next n - 1 lines contains three integers u_i, v_i, and t_i (1 <= u_i, v_i <= n, 0 <= t_i <= 1) — an edge between vertices u_i and v_i with color t_i. The given edges form a tree.",
    "output_details": "Output an integer denoting the total happiness value for all valid tours (u, v) (1 <= u <= v <= n), modulo 10^9 + 7.",
    "sample_input": "5 0\n1 3 2 6 4\n1 2 1\n1 4 0\n3 2 1\n2 5 0",
    "sample_output": "45",
    "tags": ["data structures", "trees", "*2600"]
  },
  {
    "name": "Divisible by Twenty-Five",
    "question_id": "divisible-by-twenty-five",
    "question": "Mr. Chanek has an integer represented by a string s. Zero or more digits have been erased and are denoted by the character _. There are also zero or more digits marked by the character X, meaning they're the same digit.Mr. Chanek wants to count the number of possible integer s, where s is divisible by 25. Of course, s must not contain any leading zero. He can replace the character _ with any digit. He can also replace the character X with any digit, but it must be the same for every character X.As a note, a leading zero is any 0 digit that comes before the first nonzero digit in a number string in positional notation. For example, 0025 has two leading zeroes. An exception is the integer zero, (0 has no leading zero, but 0000 has three leading zeroes).",
    "input_details": "One line containing the string s (1 <= |s| <= 8). The string s consists of the characters 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, _, and X.",
    "output_details": "Output an integer denoting the number of possible integer s.",
    "sample_input": "25",
    "sample_output": "1",
    "tags": ["brute force", "dfs and similar", "dp", "*1800"]
  },
  {
    "name": "Cyclic Sum",
    "question_id": "cyclic-sum",
    "question": "Denote a cyclic sequence of size n as an array s such that s_n is adjacent to s_1. The segment s[r, l] where l < r is the concatenation of s[r, n] and s[1, l].You are given an array a consisting of n integers. Define b as the cyclic sequence obtained from concatenating m copies of a. Note that b has size n . m.You are given an integer k where k = 1 or k is a prime number. Find the number of different segments in b where the sum of elements in the segment is divisible by k.Two segments are considered different if the set of indices of the segments are different. For example, when n = 3 and m = 2, the set of indices for segment s[2, 5] is \\{2, 3, 4, 5\\}, and for segment s[5, 2] is \\{5, 6, 1, 2\\}. In particular, the segments s[1, 6], s[2,1], ...., s[6, 5] are considered as the same segment.Output the answer modulo 10^9 + 7.",
    "input_details": "The first line contains three integers n, m, and k (1 <= n, m, k <= 2 . 10^5, k = 1 or k is a prime number).The second line contains n integers a_1, a_2, ...., a_n (0 <= a_i <= 2 . 10^5).",
    "output_details": "Output an integer denoting the number of different segments in b where the sum of elements in the segment is divisible by k, modulo 10^9 + 7.",
    "sample_input": "5 1 5\n1 2 3 4 3",
    "sample_output": "4",
    "tags": ["data structures", "fft", "number theory", "*3000"]
  },
  {
    "name": "Building an Amusement Park",
    "question_id": "building-an-amusement-park",
    "question": "Mr. Chanek lives in a city represented as a plane. He wants to build an amusement park in the shape of a circle of radius r. The circle must touch the origin (point (0, 0)).There are n bird habitats that can be a photo spot for the tourists in the park. The i-th bird habitat is at point p_i = (x_i, y_i). Find the minimum radius r of a park with at least k bird habitats inside. A point is considered to be inside the park if and only if the distance between p_i and the center of the park is less than or equal to the radius of the park. Note that the center and the radius of the park do not need to be integers.In this problem, it is guaranteed that the given input always has a solution with r <= 2 . 10^5.",
    "input_details": "The first line contains two integers n and k (1 <= n <= 10^5, 1 <= k <= n) — the number of bird habitats in the city and the number of bird habitats required to be inside the park.The i-th of the next n lines contains two integers x_i and y_i (0 <= |x_i|, |y_i| <= 10^5) — the position of the i-th bird habitat.",
    "output_details": "Output a single real number r denoting the minimum radius of a park with at least k bird habitats inside. It is guaranteed that the given input always has a solution with r <= 2 . 10^5.Your answer is considered correct if its absolute or relative error does not exceed 10^{-4}.Formally, let your answer be a, and the jury's answer be b. Your answer is accepted if and only if \\frac{|a - b|}{\\max{(1, |b|)}} <= 10^{-4}.",
    "sample_input": "8 4\n-3 1\n-4 4\n1 5\n2 2\n2 -2\n-2 -4\n-1 -1\n-6 0",
    "sample_output": "3.1622776589",
    "tags": ["binary search", "geometry", "*2300"]
  },
  {
    "name": "Another Sorting Problem",
    "question_id": "another-sorting-problem",
    "question": "Andi and Budi were given an assignment to tidy up their bookshelf of n books. Each book is represented by the book title — a string s_i numbered from 1 to n, each with length m. Andi really wants to sort the book lexicographically ascending, while Budi wants to sort it lexicographically descending.Settling their fight, they decided to combine their idea and sort it asc-desc-endingly, where the odd-indexed characters will be compared ascendingly, and the even-indexed characters will be compared descendingly.A string a occurs before a string b in asc-desc-ending order if and only if in the first position where a and b differ, the following holds:  if it is an odd position, the string a has a letter that appears earlier in the alphabet than the corresponding letter in b;  if it is an even position, the string a has a letter that appears later in the alphabet than the corresponding letter in b. ",
    "input_details": "The first line contains two integers n and m (1 <= n . m <= 10^6).The i-th of the next n lines contains a string s_i consisting of m uppercase Latin letters — the book title. The strings are pairwise distinct.",
    "output_details": "Output n integers — the indices of the strings after they are sorted asc-desc-endingly.",
    "sample_input": "5 2\nAA\nAB\nBB\nBA\nAZ",
    "sample_output": "5 2 1 3 4",
    "tags": ["data structures", "sortings", "strings", "*1100"]
  },
  {
    "name": "Occurrences",
    "question_id": "occurrences",
    "question": "A subarray of array a from index l to the index r is the array [a_l, a_{l+1}, ..., a_{r}]. The number of occurrences of the array b in the array a is the number of subarrays of a such that they are equal to b.You are given n arrays A_1, A_2, ..., A_n; the elements of these arrays are integers from 1 to k. You have to build an array a consisting of m integers from 1 to k in such a way that, for every given subarray A_i, the number of occurrences of A_i in the array a is not less than the number of occurrences of each non-empty subarray of A_i in a. Note that if A_i doesn't occur in a, and no subarray of A_i occurs in a, this condition is still met for A_i.Your task is to calculate the number of different arrays a you can build, and print it modulo 998244353.",
    "input_details": "The first line contains three integers n, m and k (1 <= n, m, k <= 3 . 10^5) — the number of the given arrays, the desired length of the array a, and the upper bound on the values in the arrays.Then n lines follow. The i-th line represents the array A_i. The first integer in the i-th line is c_i (1 <= c_i <= m) — the number of elements in A_i; then, c_i integers from 1 to k follow — the elements of the array A_i.Additional constraint on the input: \\sum\\limits_{i=1}^n c_i <= 3 . 10^5; i. e., the number of elements in the given arrays in total does not exceed 3 . 10^5.",
    "output_details": "Print one integer — the number of different arrays a you can build, taken modulo 998244353.",
    "sample_input": "2 4 3\n2 1 2\n1 3",
    "sample_output": "5",
    "tags": [
      "combinatorics",
      "dfs and similar",
      "dp",
      "dsu",
      "fft",
      "graphs",
      "*2700"
    ]
  },
  {
    "name": "Coloring",
    "question_id": "coloring",
    "question": "A matrix of size n * m, such that each cell of it contains either 0 or 1, is considered beautiful if the sum in every contiguous submatrix of size 2 * 2 is exactly 2, i. e. every \"square\" of size 2 * 2 contains exactly two 1's and exactly two 0's.You are given a matrix of size n * m. Initially each cell of this matrix is empty. Let's denote the cell on the intersection of the x-th row and the y-th column as (x, y). You have to process the queries of three types:  x y -1 — clear the cell (x, y), if there was a number in it;  x y 0 — write the number 0 in the cell (x, y), overwriting the number that was there previously (if any);  x y 1 — write the number 1 in the cell (x, y), overwriting the number that was there previously (if any). After each query, print the number of ways to fill the empty cells of the matrix so that the resulting matrix is beautiful. Since the answers can be large, print them modulo 998244353.",
    "input_details": "The first line contains three integers n, m and k (2 <= n, m <= 10^6; 1 <= k <= 3 . 10^5) — the number of rows in the matrix, the number of columns, and the number of queries, respectively.Then k lines follow, the i-th of them contains three integers x_i, y_i, t_i (1 <= x_i <= n; 1 <= y_i <= m; -1 <= t_i <= 1) — the parameters for the i-th query.",
    "output_details": "For each query, print one integer — the number of ways to fill the empty cells of the matrix after the respective query, taken modulo 998244353.",
    "sample_input": "2 2 7\n1 1 1\n1 2 1\n2 1 1\n1 1 0\n1 2 -1\n2 1 -1\n1 1 -1",
    "sample_output": "3\n1\n0\n1\n2\n3\n6",
    "tags": [
      "combinatorics",
      "constructive algorithms",
      "implementation",
      "math",
      "*2500"
    ]
  },
  {
    "name": "The Strongest Build",
    "question_id": "the-strongest-build",
    "question": "Ivan is playing yet another roguelike computer game. He controls a single hero in the game. The hero has n equipment slots. There is a list of c_i items for the i-th slot, the j-th of them increases the hero strength by a_{i,j}. The items for each slot are pairwise distinct and are listed in the increasing order of their strength increase. So, a_{i,1} < a_{i,2} < ... < a_{i,c_i}.For each slot Ivan chooses exactly one item. Let the chosen item for the i-th slot be the b_i-th item in the corresponding list. The sequence of choices [b_1, b_2, ..., b_n] is called a build.The strength of a build is the sum of the strength increases of the items in it. Some builds are banned from the game. There is a list of m pairwise distinct banned builds. It's guaranteed that there's at least one build that's not banned.What is the build with the maximum strength that is not banned from the game? If there are multiple builds with maximum strength, print any of them.",
    "input_details": "The first line contains a single integer n (1 <= n <= 10) — the number of equipment slots.The i-th of the next n lines contains the description of the items for the i-th slot. First, one integer c_i (1 <= c_i <= 2 . 10^5) — the number of items for the i-th slot. Then c_i integers a_{i,1}, a_{i,2}, ..., a_{i,c_i} (1 <= a_{i,1} < a_{i,2} < ... < a_{i,c_i} <= 10^8).The sum of c_i doesn't exceed 2 . 10^5.The next line contains a single integer m (0 <= m <= 10^5) — the number of banned builds.Each of the next m lines contains a description of a banned build — a sequence of n integers b_1, b_2, ..., b_n (1 <= b_i <= c_i).The builds are pairwise distinct, and there's at least one build that's not banned.",
    "output_details": "Print the build with the maximum strength that is not banned from the game. If there are multiple builds with maximum strength, print any of them.",
    "sample_input": "3\n3 1 2 3\n2 1 5\n3 2 4 6\n2\n3 2 3\n3 2 2",
    "sample_output": "2 2 3",
    "tags": [
      "binary search",
      "brute force",
      "data structures",
      "dfs and similar",
      "graphs",
      "greedy",
      "hashing",
      "implementation",
      "*2000"
    ]
  },
  {
    "name": "Slay the Dragon",
    "question_id": "slay-the-dragon",
    "question": "Recently, Petya learned about a new game \"Slay the Dragon\". As the name suggests, the player will have to fight with dragons. To defeat a dragon, you have to kill it and defend your castle. To do this, the player has a squad of n heroes, the strength of the i-th hero is equal to a_i.According to the rules of the game, exactly one hero should go kill the dragon, all the others will defend the castle. If the dragon's defense is equal to x, then you have to send a hero with a strength of at least x to kill it. If the dragon's attack power is y, then the total strength of the heroes defending the castle should be at least y.The player can increase the strength of any hero by 1 for one gold coin. This operation can be done any number of times.There are m dragons in the game, the i-th of them has defense equal to x_i and attack power equal to y_i. Petya was wondering what is the minimum number of coins he needs to spend to defeat the i-th dragon.Note that the task is solved independently for each dragon (improvements are not saved).",
    "input_details": "The first line contains a single integer n (2 <= n <= 2 . 10^5) — number of heroes.The second line contains n integers a_1, a_2, ..., a_n (1 <= a_i <= 10^{12}), where a_i is the strength of the i-th hero.The third line contains a single integer m (1 <= m <= 2 . 10^5) — the number of dragons.The next m lines contain two integers each, x_i and y_i (1 <= x_i <= 10^{12}; 1 <= y_i <= 10^{18}) — defense and attack power of the i-th dragon.",
    "output_details": "Print m lines, i-th of which contains a single integer — the minimum number of coins that should be spent to defeat the i-th dragon.",
    "sample_input": "4\n3 6 2 3\n5\n3 12\n7 9\n4 14\n1 10\n8 7",
    "sample_output": "1\n2\n4\n0\n2",
    "tags": ["binary search", "greedy", "sortings", "ternary search", "*1300"]
  },
  {
    "name": "Combinatorics Homework",
    "question_id": "combinatorics-homework",
    "question": "You are given four integer values a, b, c and m.Check if there exists a string that contains:   a letters 'A';  b letters 'B';  c letters 'C';  no other letters;  exactly m pairs of adjacent equal letters (exactly m such positions i that the i-th letter is equal to the (i+1)-th one). ",
    "input_details": "The first line contains a single integer t (1 <= t <= 10^4) — the number of testcases.Each of the next t lines contains the description of the testcase — four integers a, b, c and m (1 <= a, b, c <= 10^8; 0 <= m <= 10^8).",
    "output_details": "For each testcase print \"YES\" if there exists a string that satisfies all the requirements. Print \"NO\" if there are no such strings.You may print every letter in any case you want (so, for example, the strings yEs, yes, Yes and YES will all be recognized as positive answer).",
    "sample_input": "3\n2 2 1 0\n1 1 1 1\n1 2 3 2",
    "sample_output": "YES\nNO\nYES",
    "tags": ["combinatorics", "greedy", "math", "*1100"]
  },
  {
    "name": "Regular Bracket Sequences",
    "question_id": "regular-bracket-sequences",
    "question": "A bracket sequence is a string containing only characters \"(\" and \")\". A regular bracket sequence is a bracket sequence that can be transformed into a correct arithmetic expression by inserting characters \"1\" and \"+\" between the original characters of the sequence. For example, bracket sequences \"()()\" and \"(())\" are regular (the resulting expressions are: \"(1)+(1)\" and \"((1+1)+1)\"), and \")(\", \"(\" and \")\" are not.You are given an integer n. Your goal is to construct and print exactly n different regular bracket sequences of length 2n.",
    "input_details": "The first line contains one integer t (1 <= t <= 50) — the number of test cases.Each test case consists of one line containing one integer n (1 <= n <= 50).",
    "output_details": "For each test case, print n lines, each containing a regular bracket sequence of length exactly 2n. All bracket sequences you output for a testcase should be different (though they may repeat in different test cases). If there are multiple answers, print any of them. It can be shown that it's always possible.",
    "sample_input": "3\n3\n1\n3",
    "sample_output": "()()()\n((()))\n(()())\n()\n((()))\n(())()\n()(())",
    "tags": ["constructive algorithms", "*800"]
  },
  {
    "name": "Swaps",
    "question_id": "swaps",
    "question": "You are given two arrays a and b of length n. Array a contains each odd integer from 1 to 2n in an arbitrary order, and array b contains each even integer from 1 to 2n in an arbitrary order.You can perform the following operation on those arrays:   choose one of the two arrays  pick an index i from 1 to n-1  swap the i-th and the (i+1)-th elements of the chosen array  Compute the minimum number of operations needed to make array a lexicographically smaller than array b.For two different arrays x and y of the same length n, we say that x is lexicographically smaller than y if in the first position where x and y differ, the array x has a smaller element than the corresponding element in y.",
    "input_details": "Each test contains multiple test cases. The first line contains the number of test cases t (1 <= t <= 10^4).The first line of each test case contains a single integer n (1 <= n <= 10^5) — the length of the arrays.The second line of each test case contains n integers a_1, a_2, ...., a_n (1 <= a_i <= 2n, all a_i are odd and pairwise distinct) — array a.The third line of each test case contains n integers b_1, b_2, ...., b_n (1 <= b_i <= 2n, all b_i are even and pairwise distinct) — array b.It is guaranteed that the sum of n over all test cases does not exceed 10^5.",
    "output_details": "For each test case, print one integer: the minimum number of operations needed to make array a lexicographically smaller than array b.We can show that an answer always exists.",
    "sample_input": "3\n2\n3 1\n4 2\n3\n5 3 1\n2 4 6\n5\n7 5 9 1 3\n2 4 6 10 8",
    "sample_output": "0\n2\n3",
    "tags": ["greedy", "math", "sortings", "*1400"]
  },
  {
    "name": "Countdown",
    "question_id": "countdown",
    "question": "You are given a digital clock with n digits. Each digit shows an integer from 0 to 9, so the whole clock shows an integer from 0 to 10^n-1. The clock will show leading zeroes if the number is smaller than 10^{n-1}.You want the clock to show 0 with as few operations as possible. In an operation, you can do one of the following:   decrease the number on the clock by 1, or  swap two digits (you can choose which digits to swap, and they don't have to be adjacent). Your task is to determine the minimum number of operations needed to make the clock show 0.",
    "input_details": "Each test contains multiple test cases. The first line contains the number of test cases t (1 <= t <= 10^3).The first line of each test case contains a single integer n (1 <= n <= 100) — number of digits on the clock.The second line of each test case contains a string of n digits s_1, s_2, ...., s_n (0 <= s_1, s_2, ...., s_n <= 9) — the number on the clock.Note: If the number is smaller than 10^{n-1} the clock will show leading zeroes.",
    "output_details": "For each test case, print one integer: the minimum number of operations needed to make the clock show 0.",
    "sample_input": "7\n3\n007\n4\n1000\n5\n00000\n3\n103\n4\n2020\n9\n123456789\n30\n001678294039710047203946100020",
    "sample_output": "7\n2\n0\n5\n6\n53\n115",
    "tags": ["greedy", "*800"]
  },
  {
    "name": "Stations",
    "question_id": "stations",
    "question": "There are n cities in a row numbered from 1 to n.The cities will be building broadcasting stations. The station in the i-th city has height h_i and range w_i. It can broadcast information to city j if the following constraints are met:   i <= j <= w_i, and  for each k such that i < k <= j, the following condition holds: h_k < h_i.  In other words, the station in city i can broadcast information to city j if j \\ge i, j is in the range of i-th station, and i is strictly highest on the range from i to j (including city j).At the beginning, for every city i, h_i = 0 and w_i = i.Then q events will take place. During i-th event one of the following will happen:   City c_i will rebuild its station so that its height will be strictly highest among all stations and w_{c_i} will be set to g_i.  Let b_j be the number of stations that can broadcast information to city j. Print the sum of b_j over all j satisfying l_i <= j <= r_i. Your task is to react to all events and print answers to all queries.",
    "input_details": "The first line contains two integers n and q (1 <= n, q <= 2.10^5) — number of cities and number of events.Then q lines follow. The i-th line begins with an integer p_i (p_i = 1 or p_i = 2).If p_i = 1 a station will be rebuilt. Then two integers c_i and g_i (1 <= c_i <= g_i <= n) follow — the city in which the station is rebuilt and its new broadcasting range.If p_i = 2 you are given a query. Then two integers l_i and r_i (1 <= l_i <= r_i <= n) follow — the range of cities in the query.",
    "output_details": "For each query, print in a single line the sum of b_j over the given interval.",
    "sample_input": "1 3\n2 1 1\n1 1 1\n2 1 1",
    "sample_output": "1\n1",
    "tags": ["data structures", "*3400"]
  },
  {
    "name": "Polygon",
    "question_id": "polygon",
    "question": "You are given a strictly convex polygon with n vertices.You will make k cuts that meet the following conditions:   each cut is a segment that connects two different nonadjacent vertices;  two cuts can intersect only at vertices of the polygon. Your task is to maximize the area of the smallest region that will be formed by the polygon and those k cuts.",
    "input_details": "The first line contains two integers n, k (3 <= n <= 200, 0 <= k <= n-3).The following n lines describe vertices of the polygon in anticlockwise direction. The i-th line contains two integers x_i, y_i (|x_i|, |y_i| <= 10^8) — the coordinates of the i-th vertex.It is guaranteed that the polygon is convex and that no two adjacent sides are parallel.",
    "output_details": "Print one integer: the maximum possible area of the smallest region after making k cuts multiplied by 2.",
    "sample_input": "8 4\n-2 -4\n2 -2\n4 2\n1 5\n0 5\n-4 4\n-5 0\n-5 -1",
    "sample_output": "11",
    "tags": ["binary search", "dp", "geometry", "*3000"]
  },
  {
    "name": "Bridge Club",
    "question_id": "bridge-club",
    "question": "There are currently n hot topics numbered from 0 to n-1 at your local bridge club and 2^n players numbered from 0 to 2^n-1. Each player holds a different set of views on those n topics, more specifically, the i-th player holds a positive view on the j-th topic if i\\ \\&\\ 2^j > 0, and a negative view otherwise. Here \\& denotes the bitwise AND operation.You are going to organize a bridge tournament capable of accommodating at most k pairs of players (bridge is played in teams of two people). You can select teams arbitrarily while each player is in at most one team, but there is one catch: two players cannot be in the same pair if they disagree on 2 or more of those n topics, as they would argue too much during the play.You know that the i-th player will pay you a_i dollars if they play in this tournament. Compute the maximum amount of money that you can earn if you pair the players in your club optimally.",
    "input_details": "The first line contains two integers n, k (1 <= n <= 20, 1 <= k <= 200) — the number of hot topics and the number of pairs of players that your tournament can accommodate.The second line contains 2^n integers a_0, a_1, ..., a_{2^n-1} (0 <= a_i <= 10^6) — the amounts of money that the players will pay to play in the tournament.",
    "output_details": "Print one integer: the maximum amount of money that you can earn if you pair the players in your club optimally under the above conditions.",
    "sample_input": "3 1\n8 3 5 7 1 10 3 2",
    "sample_output": "13",
    "tags": ["flows", "graph matchings", "graphs", "greedy", "*2800"]
  },
  {
    "name": "Paint",
    "question_id": "paint",
    "question": "You are given a 1 by n pixel image. The i-th pixel of the image has color a_i. For each color, the number of pixels of that color is at most 20.You can perform the following operation, which works like the bucket tool in paint programs, on this image:   pick a color — an integer from 1 to n;  choose a pixel in the image;  for all pixels connected to the selected pixel, change their colors to the selected color (two pixels of the same color are considered connected if all the pixels between them have the same color as those two pixels). Compute the minimum number of operations needed to make all the pixels in the image have the same color.",
    "input_details": "Each test contains multiple test cases. The first line contains the number of test cases t (1 <= t <= 10^3).The first line of each test case contains a single integer n (1 <= n <= 3.10^3) — the number of pixels in the image.The second line of each test case contains n integers a_1, a_2, ...., a_n (1 <= a_i <= n) — the colors of the pixels in the image.Note: for each color, the number of pixels of that color is at most 20.It is guaranteed that the sum of n over all test cases does not exceed 3.10^3.",
    "output_details": "For each test case, print one integer: the minimum number of operations needed to make all the pixels in the image have the same color.",
    "sample_input": "3\n5\n1 2 3 2 1\n4\n1 1 2 2\n5\n1 2 1 4 2",
    "sample_output": "2\n1\n3",
    "tags": ["dp", "greedy", "*2700"]
  },
  {
    "name": "Xor of 3",
    "question_id": "xor-of-3",
    "question": "You are given a sequence a of length n consisting of 0s and 1s.You can perform the following operation on this sequence:   Pick an index i from 1 to n-2 (inclusive).  Change all of a_{i}, a_{i+1}, a_{i+2} to a_{i} \\oplus a_{i+1} \\oplus a_{i+2} simultaneously, where \\oplus denotes the bitwise XOR operation  Find a sequence of at most n operations that changes all elements of a to 0s or report that it's impossible.We can prove that if there exists a sequence of operations of any length that changes all elements of a to 0s, then there is also such a sequence of length not greater than n.",
    "input_details": "Each test contains multiple test cases. The first line contains the number of test cases t (1 <= t <= 10^4).The first line of each test case contains a single integer n (3 <= n <= 2.10^5) — the length of a.The second line of each test case contains n integers a_1, a_2, ...., a_n (a_i = 0 or a_i = 1) — elements of a.It is guaranteed that the sum of n over all test cases does not exceed 2.10^5.",
    "output_details": "For each test case, do the following:   if there is no way of making all the elements of a equal to 0 after performing the above operation some number of times, print \"NO\".  otherwise, in the first line print \"YES\", in the second line print k (0 <= k <= n) — the number of operations that you want to perform on a, and in the third line print a sequence b_1, b_2, ..., b_k (1 <= b_i <= n - 2) — the indices on which the operation should be applied. If there are multiple solutions, you may print any.",
    "sample_input": "3\n3\n0 0 0\n5\n1 1 1 1 0\n4\n1 0 0 1",
    "sample_output": "YES\n0\nYES\n2\n3 1\nNO",
    "tags": [
      "brute force",
      "constructive algorithms",
      "greedy",
      "two pointers",
      "*2500"
    ]
  },
  {
    "name": "Book",
    "question_id": "book",
    "question": "You are given a book with n chapters.Each chapter has a specified list of other chapters that need to be understood in order to understand this chapter. To understand a chapter, you must read it after you understand every chapter on its required list.Currently you don't understand any of the chapters. You are going to read the book from the beginning till the end repeatedly until you understand the whole book. Note that if you read a chapter at a moment when you don't understand some of the required chapters, you don't understand this chapter.Determine how many times you will read the book to understand every chapter, or determine that you will never understand every chapter no matter how many times you read the book.",
    "input_details": "Each test contains multiple test cases. The first line contains the number of test cases t (1 <= t <= 2.10^4).The first line of each test case contains a single integer n (1 <= n <= 2.10^5) — number of chapters.Then n lines follow. The i-th line begins with an integer k_i (0 <= k_i <= n-1) — number of chapters required to understand the i-th chapter. Then k_i integers a_{i,1}, a_{i,2}, ..., a_{i, k_i} (1 <= a_{i, j} <= n, a_{i, j} \n i, a_{i, j} \n a_{i, l} for j \n l) follow — the chapters required to understand the i-th chapter.It is guaranteed that the sum of n and sum of k_i over all testcases do not exceed 2.10^5.",
    "output_details": "For each test case, if the entire book can be understood, print how many times you will read it, otherwise print -1.",
    "sample_input": "5\n4\n1 2\n0\n2 1 4\n1 2\n5\n1 5\n1 1\n1 2\n1 3\n1 4\n5\n0\n0\n2 1 2\n1 2\n2 2 1\n4\n2 2 3\n0\n0\n2 3 2\n5\n1 2\n1 3\n1 4\n1 5\n0",
    "sample_output": "2\n-1\n1\n2\n5",
    "tags": [
      "binary search",
      "brute force",
      "data structures",
      "dp",
      "graphs",
      "implementation",
      "sortings",
      "*1800"
    ]
  },
  {
    "name": "Two Railroads",
    "question_id": "two-railroads",
    "question": "There are n cities in Berland, and they are connected by two railroads — the Main railroad and the Auxiliary railroad. Each city has two railway stations, one connected to the Main railroad (called the Main station), and the other connected to the Auxiliary railroad.The railroads are identical in their structure. The Main railroad consists of n-1 railroad segments; the i-th railroad segment connects the Main station of the city i with the Main station of the city i+1. Similarly, the Auxiliary railroad consists of n-1 railroad segments; the i-th railroad segment connects the Auxiliary station of the city i with the Auxiliary station of the city i+1.These railroads are used to transfer different goods and resources from one city to another. In particular, the Ministry of Energetics is interested in using these railroads to transfer coal.The Ministry has estimated the following capabilities of the railroads:  for every i \\in [1, n-1], at most a_i tons of coal per day can be transferred from the Main station i to the Main station i+1 (only in this direction);  for every i \\in [1, n-1], at most b_i tons of coal per day can be transferred from the Auxiliary station i to the Auxiliary station i+1 (only in this direction);  for every i \\in [1, n], at most c_i tons of coal per day can be transferred from the Main station i to the Auxiliary station i, or in the opposite direction. To analyze the capacity of the whole railroad network, the Ministry requires a software that would process and answer queries of the following format:  calculate the maximum number of tons of coal that can be transferred per day from the Main station l_i to the Main station r_i. Your task is to implement this software.",
    "input_details": "The first line contains one integer n (2 <= n <= 3 . 10^5) — the number of cities.The second line contains n-1 integers a_1, a_2, ..., a_{n-1} (1 <= a_i <= 10^9).The third line contains n-1 integers b_1, b_2, ..., b_{n-1} (1 <= b_i <= 10^9).The fourth line contains n integers c_1, c_2, ..., c_{n} (1 <= c_i <= 10^9).The fifth line contains one integer q (1 <= q <= 3 . 10^5) — the number of queries.Then q lines follow, the i-th line contains two integers l_i and r_i (1 <= l_i < r_i <= n) — the parameters of the i-th query.",
    "output_details": "Print q integers, where the i-th integer should be the answer to the i-th query, i. e. the maximum number of tons of coal that can be transferred per day from the Main station l_i to the Main station r_i.",
    "sample_input": "5\n3 4 7 4\n8 5 3 5\n10 5 3 4 10\n4\n1 4\n1 2\n3 4\n2 4",
    "sample_output": "9 8 10 9",
    "tags": ["*special problem"]
  },
  {
    "name": "Physical Examination",
    "question_id": "physical-examination",
    "question": "Polycarp plans to undergo a full physical examination at his local clinic. There are n doctors, numbered from 1 to n. The i-th doctor takes patients from minute L_i to minute R_i, so Polycarp can visit him at any minute in this range. It takes each doctor exactly one minute to examine Polycarp's health.Polycarp wants to arrive at the clinic at some minute x and visit all n doctors in some order without waiting or visiting any doctor several times.More formally, he chooses an integer x and a permutation p_1, p_2, ..., p_n (a sequence of n integers from 1 to n such that each integer appears exactly once), then proceeds to visit:   doctor p_1 at minute x;  doctor p_2 at minute x+1;  ...  doctor p_n at minute x+n-1. The p_i-th doctor should be able to take patients at minute x+i-1, so the following should hold: L[p_i] <= x + i - 1 <= R[p_i].Determine if it's possible for Polycarp to choose such a minute x and a permutation p that he'll be able to visit all n doctors in without waiting or visiting any doctor several times. If there are multiple answers, print any of them.",
    "input_details": "The first line contains a single integer t (1 <= t <= 100) — the number of testcases.Then the descriptions of t testcases follow.The first line of the testcase contains a single integer n (1 <= n <= 10^5) — the number of doctors.The second line of the testcase contains n integers L_1, L_2, ... L_n (1 <= L_i <= 10^9).The third line of the testcase contains n integers R_1, R_2, ... R_n (L_i <= R_i <= 10^9).The sum of n over all testcases doesn't exceed 10^5.",
    "output_details": "For each testcase print an answer.If there exists such a minute x and a permutation p that Polycarp is able to visit all n doctors without waiting or visiting any doctor several times, then print x in the first line and a permutation p in the second line. If there are multiple answers, print any of them.Otherwise, print -1 in the only line.",
    "sample_input": "5\n3\n2 3 1\n3 3 2\n8\n6 6 5 4 9 4 3 6\n7 6 10 6 9 6 6 8\n2\n4 2\n4 2\n3\n2 2 2\n3 3 3\n1\n5\n10",
    "sample_output": "1\n3 1 2 \n3\n7 4 6 2 1 8 5 3 \n-1\n-1\n7\n1",
    "tags": ["*special problem", "binary search", "data structures"]
  },
  {
    "name": "Laser Beams",
    "question_id": "laser-beams",
    "question": "Ira is developing a computer game. This game features randomized generation and difficulty of levels. To achieve randomized difficulty, some enemies in each level are randomly replaced with stronger ones.To describe how do the levels in the game look, let's introduce a coordinate system in such a way that Ox axis goes from left to right, and Oy axis goes from bottom to top. A level is a rectangle with opposite corners in points (0, 0) and (a, b). Each enemy's position is a point in this rectangle.As for now, Ira has implemented one type of enemy in the game, in two different versions — basic and upgraded. Both versions of enemies Ira has implemented fire laser rays in several directions:  basic enemies fire four laser rays in four directions: to the right (in the same direction as the vector (1, 0)), to the left (in the same direction as the vector (-1, 0)), up (in the same direction as the vector (0, 1)), and down (in the same direction as the vector (0, -1));  upgraded enemies fire eight laser rays in eight directions: four directions listed for basic enemies, and four directions corresponding to vectors (1, 1), (1, -1), (-1, 1), (-1, -1). Laser rays pass through enemies and are blocked only by the borders of the level (sides of the rectangle that denotes the level). Enemies are unaffected by lasers.The level Ira is working on has n enemies. The i-th enemy is in the point (x_i, y_i), and it has a probability of p_i to be upgraded (it's either upgraded with probability p_i, or basic with probability 1-p_i). All these events are independent.Ira wants to estimate the expected difficulty. She considers that a good way to evaluate the difficulty of the level is to count the number of parts in which the level is divided by the laser rays. So, she wants to calculate the expected number of these parts.Help her to do the evaluation of the level!",
    "input_details": "The first line contains three integers n, a and b (1 <= n <= 100; 2 <= a, b <= 100) — the number of enemies in the level and the dimensions of the level.Then n lines follow, the i-th of them contains three integers x_i, y_i and p'_i (1 <= x_i <= a - 1; 1 <= y_i <= b - 1; 1 <= p'_i <= 999999), meaning that the i-th enemy is located at (x_i, y_i) and has a probability of \\frac{p'_i}{10^6} to be upgraded.No two enemies are located in the same point.",
    "output_details": "Print one integer — the expected number of parts in which the lasers divide the level, taken modulo 998244353 (i. e. let the expected number of parts be \\frac{x}{y} as an irreducible fraction; you have to print x . y^{-1} mod 998244353, where y^{-1} is a number such that y . y^{-1} mod 998244353 = 1).",
    "sample_input": "1 2 2\n1 1 500000",
    "sample_output": "6",
    "tags": ["*special problem", "geometry", "probabilities"]
  },
  {
    "name": "A Battle Against a Dragon",
    "question_id": "a-battle-against-a-dragon",
    "question": "A squad of n warriors is defending a castle from a dragon attack. There are m barricades between the castle and the dragon.The warriors are numbered from 1 to n. The i-th warrior knows k_i attacks: the j-th of them deals a_{i,j} damage to the dragon and can only be applied if there are exactly b_{i,j} barricades between the castle and the dragon.The warriors make turns one after another, starting from warrior 1. After warrior n makes his turn, the total damage to the dragon is calculated. The i-th warrior performs exactly one of three possible moves in his turn:  destroys one barricade (if there are any left);  deploys one of his k_i attacks;  skips a turn. The total damage is the sum of damages dealt by the warriors who chose to deploy their attacks in their turn. What is the maximum total damage the warriors can deal to the dragon?",
    "input_details": "The first line contains two integers n and m (1 <= n, m <= 3 . 10^5) — the number of warriors and the initial number of barricades.Then the descriptions of attacks for each warrior follow. The i-th description consists of three lines.The first line contains a single integer k_i (1 <= k_i <= m + 1) — the number of attacks the i-th warrior knows.The second line contains k_i integers a_{i,1}, a_{i,2}, ..., a_{i,k_i} (1 <= a_{i,j} <= 10^9) — the damage of each attack.The third line contains k_i integers b_{i,1}, b_{i,2}, ..., b_{i,k_i} (0 <= b_{i,j} <= m) — the required number of barricades for each attack. b_{i,j} for the i-th warrior are pairwise distinct. The attacks are listed in the increasing order of the barricades requirement, so b_{i,1} < b_{i,2} < ... < b_{i,k_i}.The sum of k_i over all warriors doesn't exceed 3 . 10^5.",
    "output_details": "Print a single integer — the maximum total damage the warriors can deal to the dragon.",
    "sample_input": "2 4\n1\n2\n4\n2\n10 5\n3 4",
    "sample_output": "10",
    "tags": ["*special problem", "data structures", "dp"]
  },
  {
    "name": "Kotlinforces",
    "question_id": "kotlinforces",
    "question": "Kotlinforces is a web platfrom that hosts programming competitions.The staff of Kotlinforces is asked to schedule n programming competitions on the next m days. Each competition is held in multiple stages; the regulations of the i-th competition state that this competition should consist of exactly k_i stages, and each stage, starting from the second one, should be scheduled exactly t_i days after the previous stage. In other words, if the first stage of the i-th competition is scheduled on day x, the second stage should be scheduled on day x+t_i, the third stage — on day x+2t_i, ..., the k_i-th stage (which is the last one) — on day x+(k_i-1)t_i.All n competitions should be scheduled in such a way that they start and finish during the next m days, and on any of these m days, at most one stage of one competition is held (two stages of different competitions should not be scheduled on the same day).Is it possible to schedule all n competitions to meet these constraints?",
    "input_details": "The first line contains two integers n and m (1 <= n, m <= 5000) — the number of competitions and the number of days, respectively.Then n lines follow, each describing a competition which should be scheduled. The i-th line contains two integers k_i and t_i (2 <= k_i <= 5000; 1 <= t_i <= 2) — the parameters of the i-th competition.",
    "output_details": "If it is impossible to schedule all n competitions on the next m days so that there is at most one stage during each day, print -1.Otherwise, print n integers. The i-th integer should represent the day when the first stage of the i-th competition is scheduled; days are numbered from 1 to m. If there are multiple answers, print any of them.",
    "sample_input": "3 7\n3 2\n2 2\n2 2",
    "sample_output": "2 5 1",
    "tags": ["*special problem", "constructive algorithms", "dp"]
  },
  {
    "name": "Fix the String",
    "question_id": "fix-the-string",
    "question": "A regular bracket sequence is a bracket sequence that can be transformed into a correct arithmetic expression by inserting characters \"1\" and \"+\" between the original characters of the sequence. For example:  bracket sequences \"()()\" and \"(())\" are regular (the resulting expressions are: \"(1)+(1)\" and \"((1+1)+1)\");  bracket sequences \")(\", \"(\" and \")\" are not. You are given two strings s and a, the string s has length n, the string a has length n - 3. The string s is a bracket sequence (i. e. each element of this string is either an opening bracket character or a closing bracket character). The string a is a binary string (i. e. each element of this string is either 1 or 0).The string a imposes some constraints on the string s: for every i such that a_i is 1, the string s_i s_{i+1} s_{i+2} s_{i+3} should be a regular bracket sequence. Characters of a equal to 0 don't impose any constraints.Initially, the string s may or may not meet these constraints. You can perform the following operation any number of times: replace some character of s with its inverse (i. e. you can replace an opening bracket with a closing bracket, or vice versa).Determine if it is possible to change some characters in s so that it meets all of the constraints, and if it is possible, calculate the minimum number of characters to be changed.",
    "input_details": "The first line contains one integer t (1 <= t <= 10^4) — the number of test cases.Each test case consists of three lines. The first line contains one integer n (4 <= n <= 2 . 10^5). The second line contains the string s, consisting of exactly n characters; each character of s is either '(' or ')'. The third line contains the string a, consisting of exactly n - 3 characters; each character of a is either '1' or '0'.Additional constraint on the input: the sum of n over all test cases does not exceed 2 . 10^5.",
    "output_details": "For each test case, print one integer: the minimum number of characters that need to be changed in s, or -1 if it is impossible.",
    "sample_input": "6\n4\n))((\n1\n4\n))((\n0\n4\n()()\n0\n6\n))(()(\n101\n6\n))(()(\n001\n5\n(((((\n11",
    "sample_output": "2\n0\n0\n4\n1\n-1",
    "tags": ["*special problem", "bitmasks", "dp", "greedy"]
  },
  {
    "name": "Sweepstake",
    "question_id": "sweepstake",
    "question": "Kotlin Heroes competition is nearing completion. This time n programmers took part in the competition. Now organizers are thinking how to entertain spectators as well. One of the possibilities is holding sweepstakes. So for now they decided to conduct a survey among spectators.In total, organizers asked m viewers two questions:   Who will take the first place?  Who will take the last place? After receiving answers, organizers ranked all spectators based on the number of programmers they guessed right. Suppose, there are c_2 viewers who guessed right both first and last place, c_1 viewers who guessed either first or last place right and c_0 viewers who didn't guess at all. All c_2 viewers will get rank 1, all viewers with one right answer will get rank c_2 + 1 and all remaining viewers — rank c_2 + c_1 + 1.You were one of the interviewed spectators. Also, as one of the organizers, you have access to survey results, but not to competition results. Calculate, what is the worst rank you can possibly get according to organizers' ranking system?",
    "input_details": "The first line contains two integers n and m (2 <= n <= 1000; 1 <= m <= 2 . 10^5) — the number of programmers participating in the competition and the number of surveyed spectators.Next m lines contain answers of spectators. The i-th line contains two integers f_i and l_i (1 <= f_i, l_i <= n; f_i \n l_i) — the indices of programmers who will take the first and last places in opinion of the i-th viewer.For simplicity, you are the first among spectators, so your answers are f_1 and l_1.",
    "output_details": "Print the single integer — the worst rank among spectators you can possibly get according to organizers' ranking system (bigger rank — worse, of course).",
    "sample_input": "2 3\n1 2\n2 1\n2 1",
    "sample_output": "3",
    "tags": [
      "*special problem",
      "brute force",
      "constructive algorithms",
      "implementation",
      "math"
    ]
  },
  {
    "name": "Rhyme",
    "question_id": "rhyme",
    "question": "Let's say that two strings s and t rhyme if both strings have length at least k, and their last k characters are equal. For example, if k = 3, the strings abcd and cebcd rhyme, the strings ab and ab don't rhyme, the strings aaaa and aaaaa rhyme, the strings abcd and abce don't rhyme.You have n pairs of strings (s_i, t_i), and for each pair of strings you know, should they rhyme or should not.Find all possible non-negative integer values for k such that pairs that have to rhyme, rhyme and pairs that must not rhyme, don't rhyme.",
    "input_details": "Each test contains multiple test cases. The first line contains the number of test cases t (1 <= t <= 1000). Description of the test cases follows.The first line of each test case contains a single integer n (1 <= n <= 10^5) — the number of string pairs.Next n lines contains descriptions of pairs — one per line. The i-th line contains space-separated strings s_i and t_i and marker r_i. Strings are non-empty, consist of lowercase Latin letters and each have length at most 2 . 10^5. The marker r_i equals to 1 if strings have to rhyme, or 0 if they must not rhyme.It's guaranteed that for each test case there is at least one pair with r_i equal to 1 and that the total length of all strings over all test cases doesn't exceed 4 . 10^5.",
    "output_details": "For each test case, firstly print integer m — the number of possible non-negative integer values of k such that pairs that have to rhyme, rhyme and pairs that must not rhyme, don't rhyme. Next, print all these values of k (without repetitions). You can print them in any order.",
    "sample_input": "3\n1\nkotlin heroes 1\n2\njoin kotlin 1\nepisode eight 0\n4\nabc abcdef 0\nxyz zzz 1\naaa bba 0\nc d 0",
    "sample_output": "1\n0\n2\n1 2\n0",
    "tags": ["*special problem", "implementation"]
  },
  {
    "name": "Epic Novel",
    "question_id": "epic-novel",
    "question": "Alex has bought a new novel that was published in n volumes. He has read these volumes one by one, and each volume has taken him several (maybe one) full days to read. So, on the first day, he was reading the first volume, and on each of the following days, he was reading either the same volume he had been reading on the previous day, or the next volume.Let v_i be the number of the volume Alex was reading on the i-th day. Here are some examples:  one of the possible situations is v_1 = 1, v_2 = 1, v_3 = 2, v_4 = 3, v_5 = 3 — this situation means that Alex has spent two days (1-st and 2-nd) on the first volume, one day (3-rd) on the second volume, and two days (4-th and 5-th) on the third volume;  a situation v_1 = 2, v_2 = 2, v_3 = 3 is impossible, since Alex started with the first volume (so v_1 cannot be anything but 1);  a situation v_1 = 1, v_2 = 2, v_3 = 3, v_4 = 1 is impossible, since Alex won't return to the first volume after reading the third one;  a situation v_1 = 1, v_2 = 3 is impossible, since Alex doesn't skip volumes. You know that Alex was reading the volume v_a on the day a, and the volume v_c on the day c. Now you want to guess which volume was he reading on the day b, which is between the days a and c (so a < b < c). There may be some ambiguity, so you want to make any valid guess (i. e. choose some volume number v_b so it's possible that Alex was reading volume v_a on day a, volume v_b on day b, and volume v_c on day c).",
    "input_details": "Each test contains multiple test cases. The first line contains the number of test cases t (1 <= t <= 100). Description of the test cases follows.The first line of each test case contains a single integer n (1 <= n <= 100) — the number of volumes the novel consists of.The second line of each test case contains two integers a and v_a (1 <= a <= 98; 1 <= v_a <= a) denoting that Alex was reading volume v_a at day a.The third line of each test case contains two integers c and v_c (a + 2 <= c <= 100; v_a <= v_c <= c) denoting that Alex was reading volume v_c at day c.The fourth line of each test case contains one integer b (a < b < c) — the day you are interested in.It's guaranteed that the input is not controversial, in other words, Alex could read volume v_a at day a and volume v_c at day c.",
    "output_details": "For each test case, print the possible index of volume Alex could read at day b. If there are multiple answers, print any.",
    "sample_input": "4\n1\n1 1\n100 1\n99\n4\n10 1\n20 4\n16\n100\n1 1\n100 100\n42\n100\n1 1\n100 2\n99",
    "sample_output": "1\n2\n42\n1",
    "tags": ["*special problem", "math"]
  },
  {
    "name": "Sequence of Comparisons",
    "question_id": "sequence-of-comparisons",
    "question": "Once upon a time, Petya had an array of integers a of length n. But over time, the array itself was lost, and only n-1 results of comparisons of neighboring array elements remained. In other words, for every i from 1 to n-1, Petya knows exactly one of these three facts:  a_i < a_{i+1};  a_i = a_{i+1};  a_i > a_{i+1}. Petya wonders if it is possible to uniquely determine the result of comparing a_1 and a_n.You have to help Petya determine the result of comparing a_1 and a_n or report that the result cannot be determined unambiguously.",
    "input_details": "The first line contains a single integer t (1 <= t <= 500) — the number of test cases.The only line of the test case contains the string s (1 <= |s| <= 100), where s_i is:  <, if a_i < a_{i + 1};  >, if a_i > a_{i + 1};  =, if a_i = a_{i + 1}. ",
    "output_details": "For each test case, print a single string equal to:  <, if a_1 < a_n;  >, if a_1 > a_n;  =, if a_1 = a_n;  ?, if it is impossible to uniquely determine the result of the comparison. ",
    "sample_input": "4\n>>>\n<><=<\n=\n<<==",
    "sample_output": ">\n?\n=\n<",
    "tags": ["*special problem"]
  },
  {
    "name": "Minimum Difference",
    "question_id": "minimum-difference",
    "question": "You are given an integer array a of size n.You have to perform m queries. Each query has one of two types:   \"1 l r k\" — calculate the minimum value dif such that there are exist k distinct integers x_1, x_2, ..., x_k such that cnt_i > 0 (for every i \\in [1, k]) and |cnt_i - cnt_j| <= dif (for every i \\in [1, k], j \\in [1, k]), where cnt_i is the number of occurrences of x_i in the subarray a[l..r]. If it is impossible to choose k integers, report it;  \"2 p x\" — assign a_{p} := x. ",
    "input_details": "The first line contains two integers n and m (1 <= n, m <= 10^5) — the size of the array a and the number of queries.The second line contains n integers a_1, a_2, ..., a_n (1 <= a_i <= 10^5).Next m lines contain queries (one per line). Each query has one of two types:   \"1 l r k\" (1 <= l <= r <= n; 1 <= k <= 10^5)  \"2 p x\" (1 <= p <= n; 1 <= x <= 10^5). It's guaranteed that there is at least one query of the first type.",
    "output_details": "For each query of the first type, print the minimum value of dif that satisfies all required conditions, or -1 if it is impossible to choose k distinct integers.",
    "sample_input": "12 11\n2 1 1 2 1 1 3 2 1 1 3 3\n1 2 10 3\n1 2 11 3\n2 7 2\n1 3 9 2\n1 1 12 1\n1 1 12 4\n2 12 4\n1 1 12 4\n2 1 5\n1 3 12 2\n1 1 4 3",
    "sample_output": "5\n4\n1\n0\n-1\n5\n0\n1",
    "tags": ["*special problem"]
  },
  {
    "name": "Chainword",
    "question_id": "chainword",
    "question": "A chainword is a special type of crossword. As most of the crosswords do, it has cells that you put the letters in and some sort of hints to what these letters should be.The letter cells in a chainword are put in a single row. We will consider chainwords of length m in this task.A hint to a chainword is a sequence of segments such that the segments don't intersect with each other and cover all m letter cells. Each segment contains a description of the word in the corresponding cells.The twist is that there are actually two hints: one sequence is the row above the letter cells and the other sequence is the row below the letter cells. When the sequences are different, they provide a way to resolve the ambiguity in the answers.You are provided with a dictionary of n words, each word consists of lowercase Latin letters. All words are pairwise distinct.An instance of a chainword is the following triple:   a string of m lowercase Latin letters;  the first hint: a sequence of segments such that the letters that correspond to each segment spell a word from the dictionary;  the second hint: another sequence of segments such that the letters that correspond to each segment spell a word from the dictionary. Note that the sequences of segments don't necessarily have to be distinct.Two instances of chainwords are considered different if they have different strings, different first hints or different second hints.Count the number of different instances of chainwords. Since the number might be pretty large, output it modulo 998\\,244\\,353.",
    "input_details": "The first line contains two integers n and m (1 <= n <= 8, 1 <= m <= 10^9) — the number of words in the dictionary and the number of letter cells.Each of the next n lines contains a word — a non-empty string of no more than 5 lowercase Latin letters. All words are pairwise distinct. ",
    "output_details": "Print a single integer — the number of different instances of chainwords of length m for the given dictionary modulo 998\\,244\\,353.",
    "sample_input": "3 5\nababa\nab\na",
    "sample_output": "11",
    "tags": ["*special problem", "data structures", "strings"]
  },
  {
    "name": "XOR Guessing",
    "question_id": "xor-guessing",
    "question": "This is an interactive problem. Remember to flush your output while communicating with the testing program. You may use fflush(stdout) in C++, system.out.flush() in Java, stdout.flush() in Python or flush(output) in Pascal to flush the output. If you use some other programming language, consult its documentation. You may also refer to the guide on interactive problems: https://codeforces.com/blog/entry/45307.The jury picked an integer x not less than 0 and not greater than 2^{14} - 1. You have to guess this integer.To do so, you may ask no more than 2 queries. Each query should consist of 100 integer numbers a_1, a_2, ..., a_{100} (each integer should be not less than 0 and not greater than 2^{14} - 1). In response to your query, the jury will pick one integer i (1 <= i <= 100) and tell you the value of a_i \\oplus x (the bitwise XOR of a_i and x). There is an additional constraint on the queries: all 200 integers you use in the queries should be distinct.It is guaranteed that the value of x is fixed beforehand in each test, but the choice of i in every query may depend on the integers you send.",
    "input_details": "tTo give the answer, your program should print one line ! x with a line break in the end. After that, it should flush the output and terminate gracefully.",
    "output_details": "ctionBefore giving the answer, you may submit no more than 2 queries. To ask a query, print one line in the following format: ? a_1 a_2 ... a_{100}, where every a_j should be an integer from the range [0, 2^{14} - 1]. The line should be ended with a line break character. After submitting a query, flush the output and read the answer to your query — the value of a_i \\oplus x for some i \\in [1, 100]. No integer can be used in queries more than once.If you submit an incorrect query (or ask more than 2 queries), the answer to it will be one integer -1. After receiving such an answer, your program should terminate immediately — otherwise you may receive verdict \"Runtime error\", \"Time limit exceeded\" or some other verdict instead of \"Wrong answer\".",
    "sample_input": "0\n32",
    "sample_output": "? 3 5 6\n? 32 24 37\n! 5",
    "tags": ["*special problem", "interactive"]
  },
  {
    "name": "Square Filling",
    "question_id": "square-filling",
    "question": "You are given two matrices A and B. Each matrix contains exactly n rows and m columns. Each element of A is either 0 or 1; each element of B is initially 0.You may perform some operations with matrix B. During each operation, you choose any submatrix of B having size 2 * 2, and replace every element in the chosen submatrix with 1. In other words, you choose two integers x and y such that 1 <= x < n and 1 <= y < m, and then set B_{x, y}, B_{x, y + 1}, B_{x + 1, y} and B_{x + 1, y + 1} to 1.Your goal is to make matrix B equal to matrix A. Two matrices A and B are equal if and only if every element of matrix A is equal to the corresponding element of matrix B.Is it possible to make these matrices equal? If it is, you have to come up with a sequence of operations that makes B equal to A. Note that you don't have to minimize the number of operations.",
    "input_details": "The first line contains two integers n and m (2 <= n, m <= 50).Then n lines follow, each containing m integers. The j-th integer in the i-th line is A_{i, j}. Each integer is either 0 or 1.",
    "output_details": "If it is impossible to make B equal to A, print one integer -1.Otherwise, print any sequence of operations that transforms B into A in the following format: the first line should contain one integer k — the number of operations, and then k lines should follow, each line containing two integers x and y for the corresponding operation (set B_{x, y}, B_{x, y + 1}, B_{x + 1, y} and B_{x + 1, y + 1} to 1). The condition 0 <= k <= 2500 should hold.",
    "sample_input": "3 3\n1 1 1\n1 1 1\n0 1 1",
    "sample_output": "3\n1 1\n1 2\n2 2",
    "tags": ["*special problem"]
  },
  {
    "name": "Erasing Zeroes",
    "question_id": "erasing-zeroes",
    "question": "You are given a string s. Each character is either 0 or 1.You want all 1's in the string to form a contiguous subsegment. For example, if the string is 0, 1, 00111 or 01111100, then all 1's form a contiguous subsegment, and if the string is 0101, 100001 or 11111111111101, then this condition is not met.You may erase some (possibly none) 0's from the string. What is the minimum number of 0's that you have to erase?",
    "input_details": "The first line contains one integer t (1 <= t <= 100) — the number of test cases.Then t lines follow, each representing a test case. Each line contains one string s (1 <= |s| <= 100); each character of s is either 0 or 1.",
    "output_details": "Print t integers, where the i-th integer is the answer to the i-th testcase (the minimum number of 0's that you have to erase from s).",
    "sample_input": "3\n010011\n0\n1111000",
    "sample_output": "2\n0\n0",
    "tags": ["*special problem", "strings"]
  },
  {
    "name": "Reachable Numbers",
    "question_id": "reachable-numbers",
    "question": "Let's denote a function f(x) in such a way: we add 1 to x, then, while there is at least one trailing zero in the resulting number, we remove that zero. For example,   f(599) = 6: 599 + 1 = 600 \\rightarrow 60 \\rightarrow 6;  f(7) = 8: 7 + 1 = 8;  f(9) = 1: 9 + 1 = 10 \\rightarrow 1;  f(10099) = 101: 10099 + 1 = 10100 \\rightarrow 1010 \\rightarrow 101. We say that some number y is reachable from x if we can apply function f to x some (possibly zero) times so that we get y as a result. For example, 102 is reachable from 10098 because f(f(f(10098))) = f(f(10099)) = f(101) = 102; and any number is reachable from itself.You are given a number n; your task is to count how many different numbers are reachable from n.",
    "input_details": "The first line contains one integer n (1 <= n <= 10^9).",
    "output_details": "Print one integer: the number of different numbers that are reachable from n.",
    "sample_input": "1098",
    "sample_output": "20",
    "tags": ["*special problem", "implementation"]
  },
  {
    "name": "Shooting",
    "question_id": "shooting",
    "question": "Recently Vasya decided to improve his pistol shooting skills. Today his coach offered him the following exercise. He placed n cans in a row on a table. Cans are numbered from left to right from 1 to n. Vasya has to knock down each can exactly once to finish the exercise. He is allowed to choose the order in which he will knock the cans down.Vasya knows that the durability of the i-th can is a_i. It means that if Vasya has already knocked x cans down and is now about to start shooting the i-th one, he will need (a_i . x + 1) shots to knock it down. You can assume that if Vasya starts shooting the i-th can, he will be shooting it until he knocks it down.Your task is to choose such an order of shooting so that the number of shots required to knock each of the n given cans down exactly once is minimum possible.",
    "input_details": "The first line of the input contains one integer n (2 <= n <= 1\\,000) — the number of cans.The second line of the input contains the sequence a_1, a_2, ..., a_n (1 <= a_i <= 1\\,000), where a_i is the durability of the i-th can.",
    "output_details": "In the first line print the minimum number of shots required to knock each of the n given cans down exactly once.In the second line print the sequence consisting of n distinct integers from 1 to n — the order of indices of cans that minimizes the number of shots required. If there are several answers, you can print any of them.",
    "sample_input": "3\n20 10 20",
    "sample_output": "43\n1 3 2",
    "tags": ["*special problem", "greedy", "implementation"]
  },
  {
    "name": "Yellow Cards",
    "question_id": "yellow-cards",
    "question": "The final match of the Berland Football Cup has been held recently. The referee has shown n yellow cards throughout the match. At the beginning of the match there were a_1 players in the first team and a_2 players in the second team.The rules of sending players off the game are a bit different in Berland football. If a player from the first team receives k_1 yellow cards throughout the match, he can no longer participate in the match — he's sent off. And if a player from the second team receives k_2 yellow cards, he's sent off. After a player leaves the match, he can no longer receive any yellow cards. Each of n yellow cards was shown to exactly one player. Even if all players from one team (or even from both teams) leave the match, the game still continues.The referee has lost his records on who has received each yellow card. Help him to determine the minimum and the maximum number of players that could have been thrown out of the game.",
    "input_details": "The first line contains one integer a_1 (1 <= a_1 <= 1\\,000) — the number of players in the first team.The second line contains one integer a_2 (1 <= a_2 <= 1\\,000) — the number of players in the second team.The third line contains one integer k_1 (1 <= k_1 <= 1\\,000) — the maximum number of yellow cards a player from the first team can receive (after receiving that many yellow cards, he leaves the game).The fourth line contains one integer k_2 (1 <= k_2 <= 1\\,000) — the maximum number of yellow cards a player from the second team can receive (after receiving that many yellow cards, he leaves the game).The fifth line contains one integer n (1 <= n <= a_1 . k_1 + a_2 . k_2) — the number of yellow cards that have been shown during the match.",
    "output_details": "Print two integers — the minimum and the maximum number of players that could have been thrown out of the game.",
    "sample_input": "2\n3\n5\n1\n8",
    "sample_output": "0 4",
    "tags": ["*special problem", "math"]
  },
  {
    "name": "A+B (Trial Problem)",
    "question_id": "a-b-trial-problem",
    "question": "You are given two integers a and b. Print a+b.",
    "input_details": "The first line contains an integer t (1 <= t <= 10^4) — the number of test cases in the input. Then t test cases follow.Each test case is given as a line of two integers a and b (-1000 <= a, b <= 1000).",
    "output_details": "Print t integers — the required numbers a+b.",
    "sample_input": "4\n1 5\n314 15\n-99 99\n123 987",
    "sample_output": "6\n329\n0\n1110",
    "tags": ["*special problem"]
  },
  {
    "name": "Palindromic Hamiltonian Path",
    "question_id": "palindromic-hamiltonian-path",
    "question": "You are given a simple undirected graph with n vertices, n is even. You are going to write a letter on each vertex. Each letter should be one of the first k letters of the Latin alphabet.A path in the graph is called Hamiltonian if it visits each vertex exactly once. A string is called palindromic if it reads the same from left to right and from right to left. A path in the graph is called palindromic if the letters on the vertices in it spell a palindromic string without changing the order.A string of length n is good if:   each letter is one of the first k lowercase Latin letters;  if you write the i-th letter of the string on the i-th vertex of the graph, there will exist a palindromic Hamiltonian path in the graph. Note that the path doesn't necesserily go through the vertices in order 1, 2, ..., n.Count the number of good strings.",
    "input_details": "The first line contains three integers n, m and k (2 <= n <= 12; n is even; 0 <= m <= \\frac{n . (n-1)}{2}; 1 <= k <= 12) — the number of vertices in the graph, the number of edges in the graph and the number of first letters of the Latin alphabet that can be used.Each of the next m lines contains two integers v and u (1 <= v, u <= n; v \nq u) — the edges of the graph. The graph doesn't contain multiple edges and self-loops.",
    "output_details": "Print a single integer — number of good strings.",
    "sample_input": "4 3 3\n1 2\n2 3\n3 4",
    "sample_output": "9",
    "tags": [
      "brute force",
      "dfs and similar",
      "dp",
      "graphs",
      "hashing",
      "*3000"
    ]
  },
  {
    "name": "Playoff Restoration",
    "question_id": "playoff-restoration",
    "question": "2^k teams participate in a playoff tournament. The tournament consists of 2^k - 1 games. They are held as follows: first of all, the teams are split into pairs: team 1 plays against team 2, team 3 plays against team 4 (exactly in this order), and so on (so, 2^{k-1} games are played in that phase). When a team loses a game, it is eliminated, and each game results in elimination of one team (there are no ties). After that, only 2^{k-1} teams remain. If only one team remains, it is declared the champion; otherwise, 2^{k-2} games are played: in the first one of them, the winner of the game \"1 vs 2\" plays against the winner of the game \"3 vs 4\", then the winner of the game \"5 vs 6\" plays against the winner of the game \"7 vs 8\", and so on. This process repeats until only one team remains.After the tournament ends, the teams are assigned places according to the tournament phase when they were eliminated. In particular:  the winner of the tournament gets place 1;  the team eliminated in the finals gets place 2;  both teams eliminated in the semifinals get place 3;  all teams eliminated in the quarterfinals get place 5;  all teams eliminated in the 1/8 finals get place 9, and so on. For example, this picture describes one of the possible ways the tournament can go with k = 3, and the resulting places of the teams:  After a tournament which was conducted by the aforementioned rules ended, its results were encoded in the following way. Let p_i be the place of the i-th team in the tournament. The hash value of the tournament h is calculated as h = (\\sum \\limits_{i=1}^{2^k} i . A^{p_i}) mod 998244353, where A is some given integer.Unfortunately, due to a system crash, almost all tournament-related data was lost. The only pieces of data that remain are the values of k, A and h. You are asked to restore the resulting placing of the teams in the tournament, if it is possible at all.",
    "input_details": "The only line contains three integers k, A and h (1 <= k <= 5; 100 <= A <= 10^8; 0 <= h <= 998244352).",
    "output_details": "If it is impossible to find any placing of the teams that is consistent with the data you have, print one integer -1.Otherwise, print 2^k integers, where i-th integer should be equal to p_i (the place of the i-th team). Note that your answer should be consistent with one of the possible ways the tournament could go, and note that the initial structure of the tournament is fixed (for example, teams 1 and 2 always play in the first phase of the tournament against each other). If there are multiple ways to restore the places of the teams which are consistent with the data you have, print any of them.",
    "sample_input": "3 1337 75275197",
    "sample_output": "5 3 5 2 1 5 5 3",
    "tags": [
      "bitmasks",
      "brute force",
      "hashing",
      "implementation",
      "meet-in-the-middle",
      "*2600"
    ]
  },
  {
    "name": "Inconvenient Pairs",
    "question_id": "inconvenient-pairs",
    "question": "There is a city that can be represented as a square grid with corner points in (0, 0) and (10^6, 10^6).The city has n vertical and m horizontal streets that goes across the whole city, i. e. the i-th vertical streets goes from (x_i, 0) to (x_i, 10^6) and the j-th horizontal street goes from (0, y_j) to (10^6, y_j). All streets are bidirectional. Borders of the city are streets as well.There are k persons staying on the streets: the p-th person at point (x_p, y_p) (so either x_p equal to some x_i or y_p equal to some y_j, or both).Let's say that a pair of persons form an inconvenient pair if the shortest path from one person to another going only by streets is strictly greater than the Manhattan distance between them.Calculate the number of inconvenient pairs of persons (pairs (x, y) and (y, x) are the same pair).Let's recall that Manhattan distance between points (x_1, y_1) and (x_2, y_2) is |x_1 - x_2| + |y_1 - y_2|.",
    "input_details": "The first line contains a single integer t (1 <= t <= 1000) — the number of test cases.The first line of each test case contains three integers n, m and k (2 <= n, m <= 2 . 10^5; 2 <= k <= 3 . 10^5) — the number of vertical and horizontal streets and the number of persons.The second line of each test case contains n integers x_1, x_2, ..., x_n (0 = x_1 < x_2 < ... < x_{n - 1} < x_n = 10^6) — the x-coordinates of vertical streets.The third line contains m integers y_1, y_2, ..., y_m (0 = y_1 < y_2 < ... < y_{m - 1} < y_m = 10^6) — the y-coordinates of horizontal streets.Next k lines contains description of people. The p-th line contains two integers x_p and y_p (0 <= x_p, y_p <= 10^6; x_p \\in \\{x_1, ..., x_n\\} or y_p \\in \\{y_1, ..., y_m\\}) — the coordinates of the p-th person. All points are distinct.It guaranteed that sum of n doesn't exceed 2 . 10^5, sum of m doesn't exceed 2 . 10^5 and sum of k doesn't exceed 3 . 10^5.",
    "output_details": "For each test case, print the number of inconvenient pairs.",
    "sample_input": "2\n2 2 4\n0 1000000\n0 1000000\n1 0\n1000000 1\n999999 1000000\n0 999999\n5 4 9\n0 1 2 6 1000000\n0 4 8 1000000\n4 4\n2 5\n2 2\n6 3\n1000000 1\n3 8\n5 8\n8 8\n6 8",
    "sample_output": "2\n5",
    "tags": [
      "binary search",
      "data structures",
      "implementation",
      "sortings",
      "two pointers",
      "*1900"
    ]
  },
  {
    "name": "Jury Meeting",
    "question_id": "jury-meeting",
    "question": "n people gathered to hold a jury meeting of the upcoming competition, the i-th member of the jury came up with a_i tasks, which they want to share with each other.First, the jury decides on the order which they will follow while describing the tasks. Let that be a permutation p of numbers from 1 to n (an array of size n where each integer from 1 to n occurs exactly once).Then the discussion goes as follows:  If a jury member p_1 has some tasks left to tell, then they tell one task to others. Otherwise, they are skipped.  If a jury member p_2 has some tasks left to tell, then they tell one task to others. Otherwise, they are skipped.  ...  If a jury member p_n has some tasks left to tell, then they tell one task to others. Otherwise, they are skipped.  If there are still members with tasks left, then the process repeats from the start. Otherwise, the discussion ends. A permutation p is nice if none of the jury members tell two or more of their own tasks in a row. Count the number of nice permutations. The answer may be really large, so print it modulo 998\\,244\\,353.",
    "input_details": "The first line contains a single integer t (1 <= t <= 10^4) — the number of test cases.The first line of the test case contains a single integer n (2 <= n <= 2 . 10^5) — number of jury members.The second line contains n integers a_1, a_2, ..., a_n (1 <= a_i <= 10^9) — the number of problems that the i-th member of the jury came up with.The sum of n over all test cases does not exceed 2 . 10^5.",
    "output_details": "For each test case, print one integer — the number of nice permutations, taken modulo 998\\,244\\,353.",
    "sample_input": "4\n2\n1 2\n3\n5 5 5\n4\n1 3 3 7\n6\n3 4 2 1 3 3",
    "sample_output": "1\n6\n0\n540",
    "tags": ["combinatorics", "math", "*1500"]
  },
  {
    "name": "Chess Tournament",
    "question_id": "chess-tournament",
    "question": "A chess tournament will be held soon, where n chess players will take part. Every participant will play one game against every other participant. Each game ends in either a win for one player and a loss for another player, or a draw for both players.Each of the players has their own expectations about the tournament, they can be one of two types:  a player wants not to lose any game (i. e. finish the tournament with zero losses);  a player wants to win at least one game. You have to determine if there exists an outcome for all the matches such that all the players meet their expectations. If there are several possible outcomes, print any of them. If there are none, report that it's impossible.",
    "input_details": "The first line contains a single integer t (1 <= t <= 200) — the number of test cases.The first line of each test case contains one integer n (2 <= n <= 50) — the number of chess players.The second line contains the string s (|s| = n; s_i \\in \\{1, 2\\}). If s_i = 1, then the i-th player has expectations of the first type, otherwise of the second type.",
    "output_details": "For each test case, print the answer in the following format:In the first line, print NO if it is impossible to meet the expectations of all players.Otherwise, print YES, and the matrix of size n * n in the next n lines.The matrix element in the i-th row and j-th column should be equal to:  +, if the i-th player won in a game against the j-th player;  -, if the i-th player lost in a game against the j-th player;  =, if the i-th and j-th players' game resulted in a draw;  X, if i = j. ",
    "sample_input": "3\n3\n111\n2\n21\n4\n2122",
    "sample_output": "YES\nX==\n=X=\n==X\nNO\nYES\nX--+\n+X++\n+-X-\n--+X",
    "tags": ["constructive algorithms", "*1000"]
  },
  {
    "name": "Balanced Substring",
    "question_id": "balanced-substring",
    "question": "You are given a string s, consisting of n letters, each letter is either 'a' or 'b'. The letters in the string are numbered from 1 to n.s[l; r] is a continuous substring of letters from index l to r of the string inclusive. A string is called balanced if the number of letters 'a' in it is equal to the number of letters 'b'. For example, strings \"baba\" and \"aabbab\" are balanced and strings \"aaab\" and \"b\" are not.Find any non-empty balanced substring s[l; r] of string s. Print its l and r (1 <= l <= r <= n). If there is no such substring, then print -1 -1.",
    "input_details": "The first line contains a single integer t (1 <= t <= 1000) — the number of testcases.Then the descriptions of t testcases follow.The first line of the testcase contains a single integer n (1 <= n <= 50) — the length of the string.The second line of the testcase contains a string s, consisting of n letters, each letter is either 'a' or 'b'.",
    "output_details": "For each testcase print two integers. If there exists a non-empty balanced substring s[l; r], then print l r (1 <= l <= r <= n). Otherwise, print -1 -1.",
    "sample_input": "4\n1\na\n6\nabbaba\n6\nabbaba\n9\nbabbabbaa",
    "sample_output": "-1 -1\n1 6\n3 6\n2 5",
    "tags": ["implementation", "*800"]
  },
  {
    "name": "One-Four Overload",
    "question_id": "one-four-overload",
    "question": "Alice has an empty grid with n rows and m columns. Some of the cells are marked, and no marked cells are adjacent to the edge of the grid. (Two squares are adjacent if they share a side.) Alice wants to fill each cell with a number such that the following statements are true:   every unmarked cell contains either the number 1 or 4;  every marked cell contains the sum of the numbers in all unmarked cells adjacent to it (if a marked cell is not adjacent to any unmarked cell, this sum is 0);  every marked cell contains a multiple of 5.  Alice couldn't figure it out, so she asks Bob to help her. Help Bob find any such grid, or state that no such grid exists.",
    "input_details": "The first line of input contains two integers n and m (1 <= n, m <= 500) — the number of rows and the number of columns in the grid, respectively.Then n lines follow, each containing m characters. Each of these characters is either '.' or 'X' — an unmarked and a marked cell, respectively. No marked cells are adjacent to the edge of the grid.",
    "output_details": "Output \"'NO\" if no suitable grid exists. Otherwise, output \"'YES\"'. Then output n lines of m space-separated integers — the integers in the grid.",
    "sample_input": "5 5\n.....\n.XXX.\n.X.X.\n.XXX.\n.....",
    "sample_output": "YES\n4 1 4 4 1\n4 5 5 5 1\n4 5 1 5 4\n1 5 5 5 4\n1 4 4 1 4",
    "tags": [
      "constructive algorithms",
      "dfs and similar",
      "dsu",
      "graphs",
      "implementation",
      "*2700"
    ]
  },
  {
    "name": "Non-Decreasing Dilemma",
    "question_id": "non-decreasing-dilemma",
    "question": "Alice has recently received an array a_1, a_2, ..., a_n for her birthday! She is very proud of her array, and when she showed her friend Bob the array, he was very happy with her present too!However, soon Bob became curious, and as any sane friend would do, asked Alice to perform q operations of two types on her array:  1 x y: update the element a_x to y (set a_x = y).  2 l r: calculate how many non-decreasing subarrays exist within the subarray [a_l, a_{l+1}, ..., a_r]. More formally, count the number of pairs of integers (p,q) such that l <= p <= q <= r and a_p <= a_{p+1} <= ... <= a_{q-1} <= a_q. Help Alice answer Bob's queries!",
    "input_details": "The first line contains two integers n and q (1 <= n, q <= 2 . 10^5) — the size of the array, and the number of queries, respectively.The second line contains n integers a_1, a_2, ..., a_n (1 <= a_i <= 10^9) — the elements of Alice's array.The next q lines consist of three integers each. The first integer of the i-th line is t_i, the operation being performed on the i-th step (t_i = 1 or t_i = 2).If t_i = 1, the next two integers are x_i and y_i (1 <= x_i <= n; 1 <= y_i <= 10^9), updating the element at position x_i to y_i (setting a_{x_i} = y_i).If t_i = 2, the next two integers are l_i and r_i (1 <= l_i <= r_i <= n), the two indices Bob asks Alice about for the i-th query.It's guaranteed that there is at least one operation of the second type.",
    "output_details": "For each query of type 2, print a single integer, the answer to the query.",
    "sample_input": "5 6\n3 1 4 1 5\n2 2 5\n2 1 3\n1 4 4\n2 2 5\n1 2 6\n2 2 5",
    "sample_output": "6\n4\n10\n7",
    "tags": ["data structures", "divide and conquer", "math", "*2200"]
  },
  {
    "name": "Expression Evaluation Error",
    "question_id": "expression-evaluation-error",
    "question": "On the board, Bob wrote n positive integers in base 10 with sum s (i. e. in decimal numeral system). Alice sees the board, but accidentally interprets the numbers on the board as base-11 integers and adds them up (in base 11).What numbers should Bob write on the board, so Alice's sum is as large as possible?",
    "input_details": "The input consists of multiple test cases. The first line contains an integer t (1 <= t <= 100) — the number of test cases. The description of the test cases follows.The only line of each test case contains two integers s and n (1 <= s <= 10^9; 1 <= n <= \\min(100, s)) — the sum and amount of numbers on the board, respectively. Numbers s and n are given in decimal notation (base 10).",
    "output_details": "For each test case, output n positive integers — the numbers Bob should write on the board, so Alice's sum is as large as possible. If there are multiple answers, print any of them.",
    "sample_input": "6\n97 2\n17 1\n111 4\n100 2\n10 9\n999999 3",
    "sample_output": "70 27 \n17 \n3 4 100 4\n10 90\n1 1 2 1 1 1 1 1 1 \n999900 90 9",
    "tags": [
      "constructive algorithms",
      "greedy",
      "implementation",
      "math",
      "*2000"
    ]
  },
  {
    "name": "Carrying Conundrum",
    "question_id": "carrying-conundrum",
    "question": "Alice has just learned addition. However, she hasn't learned the concept of \"carrying\" fully — instead of carrying to the next column, she carries to the column two columns to the left.For example, the regular way to evaluate the sum 2039 + 2976 would be as shown:   However, Alice evaluates it as shown:   In particular, this is what she does:   add 9 and 6 to make 15, and carry the 1 to the column two columns to the left, i. e. to the column \"0 9\";  add 3 and 7 to make 10 and carry the 1 to the column two columns to the left, i. e. to the column \"2 2\";  add 1, 0, and 9 to make 10 and carry the 1 to the column two columns to the left, i. e. to the column above the plus sign;  add 1, 2 and 2 to make 5;  add 1 to make 1.  Thus, she ends up with the incorrect result of 15005.Alice comes up to Bob and says that she has added two numbers to get a result of n. However, Bob knows that Alice adds in her own way. Help Bob find the number of ordered pairs of positive integers such that when Alice adds them, she will get a result of n. Note that pairs (a, b) and (b, a) are considered different if a \n b.",
    "input_details": "The input consists of multiple test cases. The first line contains an integer t (1 <= t <= 1000) — the number of test cases. The description of the test cases follows.The only line of each test case contains an integer n (2 <= n <= 10^9) — the number Alice shows Bob.",
    "output_details": "For each test case, output one integer — the number of ordered pairs of positive integers such that when Alice adds them, she will get a result of n. ",
    "sample_input": "5\n100\n12\n8\n2021\n10000",
    "sample_output": "9\n4\n7\n44\n99",
    "tags": ["bitmasks", "combinatorics", "dp", "math", "*1600"]
  },
  {
    "name": "MEXor Mixup",
    "question_id": "me-xor-mixup",
    "question": "Alice gave Bob two integers a and b (a > 0 and b \\ge 0). Being a curious boy, Bob wrote down an array of non-negative integers with \\operatorname{MEX} value of all elements equal to a and \\operatorname{XOR} value of all elements equal to b.What is the shortest possible length of the array Bob wrote?Recall that the \\operatorname{MEX} (Minimum EXcluded) of an array is the minimum non-negative integer that does not belong to the array and the \\operatorname{XOR} of an array is the bitwise XOR of all the elements of the array.",
    "input_details": "The input consists of multiple test cases. The first line contains an integer t (1 <= t <= 5 . 10^4) — the number of test cases. The description of the test cases follows.The only line of each test case contains two integers a and b (1 <= a <= 3 . 10^5; 0 <= b <= 3 . 10^5) — the \\operatorname{MEX} and \\operatorname{XOR} of the array, respectively.",
    "output_details": "For each test case, output one (positive) integer — the length of the shortest array with \\operatorname{MEX} a and \\operatorname{XOR} b. We can show that such an array always exists.",
    "sample_input": "5\n1 1\n2 1\n2 0\n1 10000\n2 10000",
    "sample_output": "3\n2\n3\n2\n3",
    "tags": ["bitmasks", "greedy", "*1000"]
  },
  {
    "name": "Domino Disaster",
    "question_id": "domino-disaster",
    "question": "Alice has a grid with 2 rows and n columns. She fully covers the grid using n dominoes of size 1 * 2 — Alice may place them vertically or horizontally, and each cell should be covered by exactly one domino.Now, she decided to show one row of the grid to Bob. Help Bob and figure out what the other row of the grid looks like!",
    "input_details": "The input consists of multiple test cases. The first line contains an integer t (1 <= t <= 5000) — the number of test cases. The description of the test cases follows.The first line of each test case contains an integer n (1 <= n <= 100) — the width of the grid.The second line of each test case contains a string s consisting of n characters, each of which is either L, R, U, or D, representing the left, right, top, or bottom half of a domino, respectively (see notes for better understanding). This string represents one of the rows of the grid. Additional constraint on the input: each input corresponds to at least one valid tiling.",
    "output_details": "For each test case, output one string — the other row of the grid, using the same format as the input string. If there are multiple answers, print any.",
    "sample_input": "4\n1\nU\n2\nLR\n5\nLRDLR\n6\nUUUUUU",
    "sample_output": "D\nLR\nLRULR\nDDDDDD",
    "tags": ["implementation", "strings", "*800"]
  },
  {
    "name": "Xor-quiz",
    "question_id": "xor-quiz",
    "question": "This is an interactive problem.You are given two integers c and n. The jury has a randomly generated set A of distinct positive integers not greater than c (it is generated from all such possible sets with equal probability). The size of A is equal to n.Your task is to guess the set A. In order to guess it, you can ask at most \\lceil 0.65 . c \\rceil queries.In each query, you choose a single integer 1 <= x <= c. As the answer to this query you will be given the bitwise xor sum of all y, such that y \\in A and gcd(x, y) = 1 (i.e. x and y are coprime). If there is no such y this xor sum is equal to 0.You can ask all queries at the beginning and you will receive the answers to all your queries. After that, you won't have the possibility to ask queries.You should find any set A', such that |A'| = n and A' and A have the same answers for all c possible queries.",
    "input_details": "Firstly you are given two integers c and n (100 <= c <= 10^6, 0 <= n <= c).",
    "output_details": "ctionIn the first line you should print an integer q (0 <= q <= \\lceil 0.65 . c \\rceil) — the number of queries you want to ask. After that in the same line print q integers x_1, x_2, ...., x_q (1 <= x_i <= c) — the queries.For these queries you should read q integers, i-th of them is the answer to the described query for x = x_i.After that you should print n distinct integers A'_1, A'_2, ...., A'_n — the set A' you found.If there are different sets A' that have the same answers for all possible queries, print any of them.If you will ask more than \\lceil 0.65 . c \\rceil queries or if the queries will be invalid, the interactor will terminate immediately and your program will receive verdict Wrong Answer.After printing the queries and answers do not forget to output end of line and flush the output buffer. Otherwise, you will get the Idleness limit exceeded verdict. To do flush use:  fflush(stdout) or cout.flush() in C++;  System.out.flush() in Java;  flush(output) in Pascal;  stdout.flush() in Python;  Read documentation for other languages. HacksYou cannot make hacks in this problem.",
    "sample_input": "10 6\n\n1 4 2 11 4 4 4",
    "sample_output": "7 10 2 3 5 7 1 6\n\n1 4 5 6 8 10",
    "tags": [
      "constructive algorithms",
      "dp",
      "interactive",
      "math",
      "number theory",
      "*3200"
    ]
  },
  {
    "name": "Four Vertices",
    "question_id": "four-vertices",
    "question": "You are given an undirected weighted graph, consisting of n vertices and m edges.Some queries happen with this graph:  Delete an existing edge from the graph.  Add a non-existing edge to the graph. At the beginning and after each query, you should find four different vertices a, b, c, d such that there exists a path between a and b, there exists a path between c and d, and the sum of lengths of two shortest paths from a to b and from c to d is minimal. The answer to the query is the sum of the lengths of these two shortest paths. The length of the path is equal to the sum of weights of edges in this path.",
    "input_details": "The first line contains two integers n and m (4 <= n, m <= 10^5) — the number of vertices and edges in the graph respectively.Each of the next m lines contain three integers v, u, w (1 <= v, u <= n, v \nq u, 1 <= w <= 10^9) — this triple means that there is an edge between vertices v and u with weight w.The next line contains a single integer q (0 <= q <= 10^5) — the number of queries.The next q lines contain the queries of two types:  0 v u — this query means deleting an edge between v and u (1 <= v, u <= n, v \nq u). It is guaranteed that such edge exists in the graph.  1 v u w — this query means adding an edge between vertices v and u with weight w (1 <= v, u <= n, v \nq u, 1 <= w <= 10^9). It is guaranteed that there was no such edge in the graph. It is guaranteed that the initial graph does not contain multiple edges.At the beginning and after each query, the graph doesn't need to be connected.It is guaranteed that at each moment the number of edges will be at least 4. It can be proven, that at each moment there exist some four vertices a, b, c, d such that there exists a path between vertices a and b, and there exists a path between vertices c and d.",
    "output_details": "Print q + 1 integers — the minimal sum of lengths of shortest paths between chosen pairs of vertices before the queries and after each of them.",
    "sample_input": "6 6\n1 3 6\n4 3 1\n1 4 1\n2 6 4\n2 4 2\n5 4 3\n4\n1 2 5 2\n0 1 4\n0 3 4\n1 6 1 3",
    "sample_output": "4\n3\n3\n7\n5",
    "tags": [
      "constructive algorithms",
      "data structures",
      "graphs",
      "greedy",
      "implementation",
      "shortest paths",
      "*3100"
    ]
  },
  {
    "name": "Points Movement",
    "question_id": "points-movement",
    "question": "There are n points and m segments on the coordinate line. The initial coordinate of the i-th point is a_i. The endpoints of the j-th segment are l_j and r_j — left and right endpoints, respectively.You can move the points. In one move you can move any point from its current coordinate x to the coordinate x - 1 or the coordinate x + 1. The cost of this move is 1.You should move the points in such a way that each segment is visited by at least one point. A point visits the segment [l, r] if there is a moment when its coordinate was on the segment [l, r] (including endpoints).You should find the minimal possible total cost of all moves such that all segments are visited.",
    "input_details": "The input consists of multiple test cases. The first line contains a single integer t (1 <= t <= 10^4) — the number of test cases. Description of the test cases follows.The first line of each test case contains two integers n and m (1 <= n, m <= 2 . 10^5) — the number of points and segments respectively.The next line contains n distinct integers a_1, a_2, ...., a_n (-10^9 <= a_i <= 10^9) — the initial coordinates of the points.Each of the next m lines contains two integers l_j, r_j (-10^9 <= l_j <= r_j <= 10^9) — the left and the right endpoints of the j-th segment.It's guaranteed that the sum of n and the sum of m over all test cases does not exceed 2 . 10^5.",
    "output_details": "For each test case print a single integer — the minimal total cost of all moves such that all segments are visited.",
    "sample_input": "2\n4 11\n2 6 14 18\n0 3\n4 5\n11 15\n3 5\n10 13\n16 16\n1 4\n8 12\n17 19\n7 13\n14 19\n4 12\n-9 -16 12 3\n-20 -18\n-14 -13\n-10 -7\n-3 -1\n0 4\n6 11\n7 9\n8 10\n13 15\n14 18\n16 17\n18 19",
    "sample_output": "5\n22",
    "tags": [
      "data structures",
      "dp",
      "greedy",
      "implementation",
      "sortings",
      "*2600"
    ]
  },
  {
    "name": "Buds Re-hanging",
    "question_id": "buds-re-hanging",
    "question": "A tree is a connected graph without cycles. A rooted tree has a special vertex called the root. The parent of a vertex v (different from root) is the previous to v vertex on the shortest path from the root to the vertex v. Children of the vertex v are all vertices for which v is the parent.A vertex is a leaf if it has no children. We call a vertex a bud, if the following three conditions are satisfied:   it is not a root,  it has at least one child, and  all its children are leaves. You are given a rooted tree with n vertices. The vertex 1 is the root. In one operation you can choose any bud with all its children (they are leaves) and re-hang them to any other vertex of the tree. By doing that you delete the edge connecting the bud and its parent and add an edge between the bud and the chosen vertex of the tree. The chosen vertex cannot be the bud itself or any of its children. All children of the bud stay connected to the bud.What is the minimum number of leaves it is possible to get if you can make any number of the above-mentioned operations (possibly zero)?",
    "input_details": "The input consists of multiple test cases. The first line contains a single integer t (1 <= t <= 10^4) — the number of test cases. Description of the test cases follows.The first line of each test case contains a single integer n (2 <= n <= 2 . 10^5) — the number of the vertices in the given tree.Each of the next n-1 lines contains two integers u and v (1 <= u, v <= n, u \nq v) meaning that there is an edge between vertices u and v in the tree.It is guaranteed that the given graph is a tree.It is guaranteed that the sum of n over all test cases doesn't exceed 2 . 10^5.",
    "output_details": "For each test case print a single integer — the minimal number of leaves that is possible to get after some operations.",
    "sample_input": "5\n7\n1 2\n1 3\n1 4\n2 5\n2 6\n4 7\n6\n1 2\n1 3\n2 4\n2 5\n3 6\n2\n1 2\n7\n7 3\n1 5\n1 3\n4 6\n4 7\n2 1\n6\n2 1\n2 3\n4 5\n3 4\n3 6",
    "sample_output": "2\n2\n1\n2\n1",
    "tags": [
      "constructive algorithms",
      "dfs and similar",
      "dp",
      "greedy",
      "trees",
      "*2000"
    ]
  },
  {
    "name": " Seating Arrangements (hard version) ",
    "question_id": "seating-arrangements-hard-version",
    "question": "It is the hard version of the problem. The only difference is that in this version 1 <= n <= 300.In the cinema seats can be represented as the table with n rows and m columns. The rows are numbered with integers from 1 to n. The seats in each row are numbered with consecutive integers from left to right: in the k-th row from m (k - 1) + 1 to m k for all rows 1 <= k <= n. 12.sm - 1mm + 1m + 2.s2 m - 12 m2m + 12m + 2.s3 m - 13 m\\vdots\\vdots\\ddots\\vdots\\vdotsm (n - 1) + 1m (n - 1) + 2.sn m - 1n m The table with seats indices There are nm people who want to go to the cinema to watch a new film. They are numbered with integers from 1 to nm. You should give exactly one seat to each person.It is known, that in this cinema as lower seat index you have as better you can see everything happening on the screen. i-th person has the level of sight a_i. Let's define s_i as the seat index, that will be given to i-th person. You want to give better places for people with lower sight levels, so for any two people i, j such that a_i < a_j it should be satisfied that s_i < s_j.After you will give seats to all people they will start coming to their seats. In the order from 1 to nm, each person will enter the hall and sit in their seat. To get to their place, the person will go to their seat's row and start moving from the first seat in this row to theirs from left to right. While moving some places will be free, some will be occupied with people already seated. The inconvenience of the person is equal to the number of occupied seats he or she will go through.Let's consider an example: m = 5, the person has the seat 4 in the first row, the seats 1, 3, 5 in the first row are already occupied, the seats 2 and 4 are free. The inconvenience of this person will be 2, because he will go through occupied seats 1 and 3.Find the minimal total inconvenience (the sum of inconveniences of all people), that is possible to have by giving places for all people (all conditions should be satisfied).",
    "input_details": "The input consists of multiple test cases. The first line contains a single integer t (1 <= t <= 100) — the number of test cases. Description of the test cases follows.The first line of each test case contains two integers n and m (1 <= n, m <= 300) — the number of rows and places in each row respectively.The second line of each test case contains n . m integers a_1, a_2, ...., a_{n . m} (1 <= a_i <= 10^9), where a_i is the sight level of i-th person.It's guaranteed that the sum of n . m over all test cases does not exceed 10^5.",
    "output_details": "For each test case print a single integer — the minimal total inconvenience that can be achieved.",
    "sample_input": "7\n1 2\n1 2\n3 2\n1 1 2 2 3 3\n3 3\n3 4 4 1 1 1 1 1 2\n2 2\n1 1 2 1\n4 2\n50 50 50 50 3 50 50 50\n4 2\n6 6 6 6 2 2 9 6\n2 9\n1 3 3 3 3 3 1 1 3 1 3 1 1 3 3 1 1 3",
    "sample_output": "1\n0\n4\n0\n0\n0\n1",
    "tags": [
      "data structures",
      "greedy",
      "implementation",
      "sortings",
      "two pointers",
      "*1600"
    ]
  },
  {
    "name": " Seating Arrangements (easy version) ",
    "question_id": "seating-arrangements-easy-version",
    "question": "It is the easy version of the problem. The only difference is that in this version n = 1.In the cinema seats can be represented as the table with n rows and m columns. The rows are numbered with integers from 1 to n. The seats in each row are numbered with consecutive integers from left to right: in the k-th row from m (k - 1) + 1 to m k for all rows 1 <= k <= n. 12.sm - 1mm + 1m + 2.s2 m - 12 m2m + 12m + 2.s3 m - 13 m\\vdots\\vdots\\ddots\\vdots\\vdotsm (n - 1) + 1m (n - 1) + 2.sn m - 1n m The table with seats indices There are nm people who want to go to the cinema to watch a new film. They are numbered with integers from 1 to nm. You should give exactly one seat to each person.It is known, that in this cinema as lower seat index you have as better you can see everything happening on the screen. i-th person has the level of sight a_i. Let's define s_i as the seat index, that will be given to i-th person. You want to give better places for people with lower sight levels, so for any two people i, j such that a_i < a_j it should be satisfied that s_i < s_j.After you will give seats to all people they will start coming to their seats. In the order from 1 to nm, each person will enter the hall and sit in their seat. To get to their place, the person will go to their seat's row and start moving from the first seat in this row to theirs from left to right. While moving some places will be free, some will be occupied with people already seated. The inconvenience of the person is equal to the number of occupied seats he or she will go through.Let's consider an example: m = 5, the person has the seat 4 in the first row, the seats 1, 3, 5 in the first row are already occupied, the seats 2 and 4 are free. The inconvenience of this person will be 2, because he will go through occupied seats 1 and 3.Find the minimal total inconvenience (the sum of inconveniences of all people), that is possible to have by giving places for all people (all conditions should be satisfied).",
    "input_details": "The input consists of multiple test cases. The first line contains a single integer t (1 <= t <= 100) — the number of test cases. Description of the test cases follows.The first line of each test case contains two integers n and m (n = 1, 1 <= m <= 300) — the number of rows and places in each row respectively.The second line of each test case contains n . m integers a_1, a_2, ...., a_{n . m} (1 <= a_i <= 10^9), where a_i is the sight level of i-th person.It's guaranteed that the sum of n . m over all test cases does not exceed 10^5.",
    "output_details": "For each test case print a single integer — the minimal total inconvenience that can be achieved.",
    "sample_input": "4\n1 3\n1 2 3\n1 5\n2 1 5 3 3\n1 2\n2 1\n1 6\n2 3 2 1 1 1",
    "sample_output": "3\n6\n0\n1",
    "tags": ["data structures", "greedy", "sortings", "*1100"]
  },
  {
    "name": "MAX-MEX Cut",
    "question_id": "max-mex-cut",
    "question": "A binary string is a string that consists of characters 0 and 1. A bi-table is a table that has exactly two rows of equal length, each being a binary string.Let \\operatorname{MEX} of a bi-table be the smallest digit among 0, 1, or 2 that does not occur in the bi-table. For example, \\operatorname{MEX} for \\begin{bmatrix} 0011\\\\ 1010 \\end{bmatrix} is 2, because 0 and 1 occur in the bi-table at least once. \\operatorname{MEX} for \\begin{bmatrix} 111\\\\ 111 \\end{bmatrix} is 0, because 0 and 2 do not occur in the bi-table, and 0 < 2.You are given a bi-table with n columns. You should cut it into any number of bi-tables (each consisting of consecutive columns) so that each column is in exactly one bi-table. It is possible to cut the bi-table into a single bi-table — the whole bi-table.What is the maximal sum of \\operatorname{MEX} of all resulting bi-tables can be?",
    "input_details": "The input consists of multiple test cases. The first line contains a single integer t (1 <= t <= 10^4) — the number of test cases. Description of the test cases follows.The first line of the description of each test case contains a single integer n (1 <= n <= 10^5) — the number of columns in the bi-table.Each of the next two lines contains a binary string of length n — the rows of the bi-table.It's guaranteed that the sum of n over all test cases does not exceed 10^5.",
    "output_details": "For each test case print a single integer — the maximal sum of \\operatorname{MEX} of all bi-tables that it is possible to get by cutting the given bi-table optimally.",
    "sample_input": "4\n7\n0101000\n1101100\n5\n01100\n10101\n2\n01\n01\n6\n000000\n111111",
    "sample_output": "8\n8\n2\n12",
    "tags": ["bitmasks", "constructive algorithms", "dp", "greedy", "*1000"]
  },
  {
    "name": "MIN-MEX Cut",
    "question_id": "min-mex-cut",
    "question": "A binary string is a string that consists of characters 0 and 1.Let \\operatorname{MEX} of a binary string be the smallest digit among 0, 1, or 2 that does not occur in the string. For example, \\operatorname{MEX} of 001011 is 2, because 0 and 1 occur in the string at least once, \\operatorname{MEX} of 1111 is 0, because 0 and 2 do not occur in the string and 0 < 2.A binary string s is given. You should cut it into any number of substrings such that each character is in exactly one substring. It is possible to cut the string into a single substring — the whole string.A string a is a substring of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters from the beginning and several (possibly, zero or all) characters from the end.What is the minimal sum of \\operatorname{MEX} of all substrings pieces can be?",
    "input_details": "The input consists of multiple test cases. The first line contains a single integer t (1 <= t <= 10^4) — the number of test cases. Description of the test cases follows.Each test case contains a single binary string s (1 <= |s| <= 10^5).It's guaranteed that the sum of lengths of s over all test cases does not exceed 10^5.",
    "output_details": "For each test case print a single integer — the minimal sum of \\operatorname{MEX} of all substrings that it is possible to get by cutting s optimally.",
    "sample_input": "6\n01\n1111\n01100\n101\n0000\n01010",
    "sample_output": "1\n0\n2\n1\n1\n2",
    "tags": ["bitmasks", "constructive algorithms", "dp", "greedy", "*800"]
  },
  {
    "name": "Median Maximization",
    "question_id": "median-maximization",
    "question": "You are given two positive integers n and s. Find the maximum possible median of an array of n non-negative integers (not necessarily distinct), such that the sum of its elements is equal to s.A median of an array of integers of length m is the number standing on the \\lceil {\\frac{m}{2}} \\rceil-th (rounding up) position in the non-decreasing ordering of its elements. Positions are numbered starting from 1. For example, a median of the array [20,40,20,50,50,30] is the \\lceil \\frac{m}{2} \\rceil-th element of [20,20,30,40,50,50], so it is 30. There exist other definitions of the median, but in this problem we use the described definition.",
    "input_details": "The input consists of multiple test cases. The first line contains a single integer t (1 <= t <= 10^4) — the number of test cases. Description of the test cases follows.Each test case contains a single line with two integers n and s (1 <= n, s <= 10^9) — the length of the array and the required sum of the elements.",
    "output_details": "For each test case print a single integer — the maximum possible median.",
    "sample_input": "8\n1 5\n2 5\n3 5\n2 1\n7 17\n4 14\n1 1000000000\n1000000000 1",
    "sample_output": "5\n2\n2\n0\n4\n4\n1000000000\n0",
    "tags": ["binary search", "greedy", "math", "*800"]
  },
  {
    "name": "Tubular Bells",
    "question_id": "tubular-bells",
    "question": "Do you know what tubular bells are? They are a musical instrument made up of cylindrical metal tubes. In an orchestra, tubular bells are used to mimic the ringing of bells.Mike has tubular bells, too! They consist of n tubes, and each of the tubes has a length that can be expressed by a integer from l to r inclusive. It is clear that the lengths of all the tubes are different (it makes no sense to make the same tubes). It is also known that r-l+1 = n.Formally, we can say that Mike's tubular bells are described by a permutation a of length n that contains all numbers from l to r inclusive, with a_i denoting the length of the i-th tube.You are offered an interesting task: to guess what Mike's instrument looks like. Simply, you must guess the permutation.Mike won't tell you l or r. He will only tell you n, and will allow you to ask no more than n + 5000 queries.In each query, you name two positive integers x, y such that 1 <= x, y <= n, x \nq y. In response to this query, the program written by Mike will give you \\mathrm{lcm}(a_x, a_y), where \\mathrm{lcm}(c,d) denotes the least common multiple of c and d.Solve Mike's problem!",
    "input_details": "Each test contains multiple test cases.The first line contains one positive integer t (1 <= t <= 20), denoting the number of test cases. Description of the test cases follows.The single line of each test case contains one positive integer n (3 <= n <= 10^5) — number of tubes in Mike's tubular bells. Also 1 <= l <= r <= 2 . 10^5, i.e. the lengths of the tubes do not exceed 2 . 10^5.It is guaranteed that the sum of maximal number of queries (i.e. n + 5000) over all test cases does not exceed 10^5 + 5000. It means that sum of n does not exceed 10^5 + 5000 - t . 5000.",
    "output_details": "ctionFor each set of input data, read one integer n. You are allowed to make no more than n + 5000 queries.If you want to make a query, output it in the format \"? x y\", where x and y — the numbers of tubes for which you learn the lcm (least common multiple) of their lengths. Note that 1 <= x, y <= n, x \nq y must be satisfied. The interactor will return a single integer —the answer to your query.If you are ready to print the answer, print it in the format \"! a_1 a_2 ... a_n\". The output of the answer is not considered a query and is not included in the number of queries.After each query and answer output, don't forget to output the line translation and reset the output buffer. Otherwise you will get the verdict \"Idleness limit exceeded\". To reset the buffer use:  fflush(stdout) or cout.flush() in C++;  System.out.flush() in Java;  flush(output) in Pascal;  stdout.flush() in Python;  see documentation for other languages. Note that the interactor is not adaptive. That is, the original permutation is fixed in the beginning and don't depend on your queries.Hacks:Use the following format for hacks:The first line contains a single positive integer t (1 <= t <= 20) — the number of input datasets. A description of the input data sets is given below.The first line of each test case contains one positive integer n (3 <= n <= 10^5) —the number of tubes. It is known that 1 <= l <= r <= 2 . 10^5, i.e. the lengths of the tubes do not exceed 2 . 10^5.The second line of each test case contains an array a of n positive integers — the lengths of the tubes in each input dataset. Remember that l <= a_i <= r and r-l+1 = n, and that all a_i are different.",
    "sample_input": "3\n5\n8 10 7 6 9\n5\n24 25 28 27 26\n7\n1 2 3 4 5 6 7",
    "sample_output": "? 1 2\n40\n? 2 5\n90\n? 3 1\n56\n? 4 5\n18\n! 8 10 7 6 9\n? 1 5\n312\n? 2 4\n675\n! 24 25 28 27 26\n? 1 4\n4\n? 2 5\n10\n? 3 7\n21\n? 6 2\n6\n? 2 5\n10\n? 1 2\n2\n? 1 2\n2\n? 1 2\n2\n? 1 2\n2\n? 1 2\n2\n! 1 2 3 4 5 6 7",
    "tags": ["interactive", "math", "number theory", "probabilities", "*2900"]
  },
  {
    "name": "Rescue Niwen!",
    "question_id": "rescue-niwen",
    "question": " Morning desert sun horizonRise above the sands of time...Fates Warning, \"Exodus\"After crossing the Windswept Wastes, Ori has finally reached the Windtorn Ruins to find the Heart of the Forest! However, the ancient repository containing this priceless Willow light did not want to open!Ori was taken aback, but the Voice of the Forest explained to him that the cunning Gorleks had decided to add protection to the repository.The Gorleks were very fond of the \"string expansion\" operation. They were also very fond of increasing subsequences.Suppose a string s_1s_2s_3 .... s_n is given. Then its \"expansion\" is defined as the sequence of strings s_1, s_1 s_2, ..., s_1 s_2 .... s_n, s_2, s_2 s_3, ..., s_2 s_3 .... s_n, s_3, s_3 s_4, ..., s_{n-1} s_n, s_n. For example, the \"expansion\" the string 'abcd' will be the following sequence of strings: 'a', 'ab', 'abc', 'abcd', 'b', 'bc', 'bcd', 'c', 'cd', 'd'. To open the ancient repository, Ori must find the size of the largest increasing subsequence of the \"expansion\" of the string s. Here, strings are compared lexicographically.Help Ori with this task!A string a is lexicographically smaller than a string b if and only if one of the following holds: a is a prefix of b, but a \n b; in the first position where a and b differ, the string a has a letter that appears earlier in the alphabet than the corresponding letter in b.",
    "input_details": "ing desert sun horizonRise above the sands of time...Fates Warning, \"Exodus\"",
    "output_details": "Warning, \"Exodus\"",
    "sample_input": "leInput7\n5\nacbac\n8\nacabacba\n12\naaaaaaaaaaaa\n10\nabacabadac\n8\ndcbaabcd\n3\ncba\n6\nsparky\nOutput9\n17\n12\n29\n14\n3\n9",
    "sample_output": "5\nacbac\n8\nacabacba\n12\naaaaaaaaaaaa\n10\nabacabadac\n8\ndcbaabcd\n3\ncba\n6\nsparky\nOutput9\n17\n12\n29\n14\n3\n9",
    "tags": ["dp", "greedy", "string suffix structures", "strings", "*2500"]
  },
  {
    "name": " Two Hundred Twenty One (hard version)",
    "question_id": "two-hundred-twenty-one-hard-version",
    "question": "This is the hard version of the problem. The difference between the versions is that the hard version does require you to output the numbers of the rods to be removed. You can make hacks only if all versions of the problem are solved.Stitch likes experimenting with different machines with his friend Sparky. Today they built another machine.The main element of this machine are n rods arranged along one straight line and numbered from 1 to n inclusive. Each of these rods must carry an electric charge quantitatively equal to either 1 or -1 (otherwise the machine will not work). Another condition for this machine to work is that the sign-variable sum of the charge on all rods must be zero.More formally, the rods can be represented as an array of n numbers characterizing the charge: either 1 or -1. Then the condition must hold: a_1 - a_2 + a_3 - a_4 + .... = 0, or \\sum\\limits_{i=1}^n (-1)^{i-1} . a_i = 0.Sparky charged all n rods with an electric current, but unfortunately it happened that the rods were not charged correctly (the sign-variable sum of the charge is not zero). The friends decided to leave only some of the rods in the machine. Sparky has q questions. In the ith question Sparky asks: if the machine consisted only of rods with numbers l_i to r_i inclusive, what minimal number of rods could be removed from the machine so that the sign-variable sum of charges on the remaining ones would be zero? Also Sparky wants to know the numbers of these rods. Perhaps the friends got something wrong, and the sign-variable sum is already zero. In that case, you don't have to remove the rods at all.If the number of rods is zero, we will assume that the sign-variable sum of charges is zero, that is, we can always remove all rods.Help your friends and answer all of Sparky's questions!",
    "input_details": "Each test contains multiple test cases.The first line contains one positive integer t (1 <= t <= 10^3), denoting the number of test cases. Description of the test cases follows.The first line of each test case contains two positive integers n and q (1 <= n, q <= 3 . 10^5) — the number of rods and the number of questions.The second line of each test case contains a non-empty string s of length n, where the charge of the i-th rod is 1 if s_i is the \"+\" symbol, or -1 if s_i is the \"-\" symbol.Each next line from the next q lines contains two positive integers l_i ans r_i (1 <= l_i <= r_i <= n) — numbers, describing Sparky's questions.It is guaranteed that the sum of n over all test cases does not exceed 3 . 10^5, and the sum of q over all test cases does not exceed 3 . 10^5.It is guaranteed that the sum of the answers (minimal number of rods that can be removed) over all test cases does not exceed 10^6.",
    "output_details": "For each test case, print the answer in the following format:In the first line print a single integer k — the minimal number of rods that can be removed.In the second line print k numbers separated by a space — the numbers of rods to be removed.If there is more than one correct answer, you can print any.",
    "sample_input": "3\n14 1\n+--++---++-++-\n1 14\n14 3\n+--++---+++---\n1 14\n6 12\n3 10\n4 10\n+-+-\n1 1\n1 2\n1 3\n1 4\n2 2\n2 3\n2 4\n3 3\n3 4\n4 4",
    "sample_output": "2\n5 8\n2\n1 11\n1\n9\n0\n1\n1\n2\n1 2\n1\n2\n2\n1 3\n1\n2\n2\n2 3\n1\n3\n1\n3\n2\n3 4\n1\n4",
    "tags": ["data structures", "math", "*2200"]
  },
  {
    "name": " Two Hundred Twenty One (easy version)",
    "question_id": "two-hundred-twenty-one-easy-version",
    "question": "This is the easy version of the problem. The difference between the versions is that the easy version does not require you to output the numbers of the rods to be removed. You can make hacks only if all versions of the problem are solved.Stitch likes experimenting with different machines with his friend Sparky. Today they built another machine.The main element of this machine are n rods arranged along one straight line and numbered from 1 to n inclusive. Each of these rods must carry an electric charge quantitatively equal to either 1 or -1 (otherwise the machine will not work). Another condition for this machine to work is that the sign-variable sum of the charge on all rods must be zero.More formally, the rods can be represented as an array of n numbers characterizing the charge: either 1 or -1. Then the condition must hold: a_1 - a_2 + a_3 - a_4 + .... = 0, or \\sum\\limits_{i=1}^n (-1)^{i-1} . a_i = 0.Sparky charged all n rods with an electric current, but unfortunately it happened that the rods were not charged correctly (the sign-variable sum of the charge is not zero). The friends decided to leave only some of the rods in the machine. Sparky has q questions. In the ith question Sparky asks: if the machine consisted only of rods with numbers l_i to r_i inclusive, what minimal number of rods could be removed from the machine so that the sign-variable sum of charges on the remaining ones would be zero? Perhaps the friends got something wrong, and the sign-variable sum is already zero. In that case, you don't have to remove the rods at all.If the number of rods is zero, we will assume that the sign-variable sum of charges is zero, that is, we can always remove all rods.Help your friends and answer all of Sparky's questions!",
    "input_details": "Each test contains multiple test cases.The first line contains one positive integer t (1 <= t <= 10^3), denoting the number of test cases. Description of the test cases follows.The first line of each test case contains two positive integers n and q (1 <= n, q <= 3 . 10^5) — the number of rods and the number of questions.The second line of each test case contains a non-empty string s of length n, where the charge of the i-th rod is 1 if s_i is the \"+\" symbol, or -1 if s_i is the \"-\" symbol.Each next line from the next q lines contains two positive integers l_i ans r_i (1 <= l_i <= r_i <= n) — numbers, describing Sparky's questions.It is guaranteed that the sum of n over all test cases does not exceed 3 . 10^5, and the sum of q over all test cases does not exceed 3 . 10^5.",
    "output_details": "For each test case, print a single integer — the minimal number of rods that can be removed.",
    "sample_input": "3\n14 1\n+--++---++-++-\n1 14\n14 3\n+--++---+++---\n1 14\n6 12\n3 10\n4 10\n+-+-\n1 1\n1 2\n1 3\n1 4\n2 2\n2 3\n2 4\n3 3\n3 4\n4 4",
    "sample_output": "2\n2\n1\n0\n1\n2\n1\n2\n1\n2\n1\n1\n2\n1",
    "tags": ["data structures", "dp", "math", "*1700"]
  },
  {
    "name": "Rings",
    "question_id": "rings",
    "question": " Frodo was caught by Saruman. He tore a pouch from Frodo's neck, shook out its contents —there was a pile of different rings: gold and silver...\"How am I to tell which is the One?!\" the mage howled.\"Throw them one by one into the Cracks of Doom and watch when Mordor falls!\" Somewhere in a parallel Middle-earth, when Saruman caught Frodo, he only found n rings. And the i-th ring was either gold or silver. For convenience Saruman wrote down a binary string s of n characters, where the i-th character was 0 if the i-th ring was gold, and 1 if it was silver.Saruman has a magic function f, which takes a binary string and returns a number obtained by converting the string into a binary number and then converting the binary number into a decimal number. For example, f(001010) = 10, f(111) = 7, f(11011101) = 221.Saruman, however, thinks that the order of the rings plays some important role. He wants to find 2 pairs of integers (l_1, r_1), (l_2, r_2), such that: 1 <= l_1 <= n, 1 <= r_1 <= n, r_1-l_1+1\\ge \\lfloor \\frac{n}{2} \\rfloor  1 <= l_2 <= n, 1 <= r_2 <= n, r_2-l_2+1\\ge \\lfloor \\frac{n}{2} \\rfloor  Pairs (l_1, r_1) and (l_2, r_2) are distinct. That is, at least one of l_1 \nq l_2 and r_1 \nq r_2 must hold. Let t be the substring s[l_1:r_1] of s, and w be the substring s[l_2:r_2] of s. Then there exists non-negative integer k, such that f(t) = f(w) . k.Here substring s[l:r] denotes s_ls_{l+1}.... s_{r-1}s_r, and \\lfloor x \\rfloor denotes rounding the number down to the nearest integer.Help Saruman solve this problem! It is guaranteed that under the constraints of the problem at least one solution exists.",
    "input_details": "o was caught by Saruman. He tore a pouch from Frodo's neck, shook out its contents —there was a pile of different rings: gold and silver...\"How am I to tell which is the One?!\" the mage howled.\"Throw them one by one into the Cracks of Doom and watch when Mordor falls!\" ",
    "output_details": "ach test contains multiple test cases.The first line contains one positive integer t (1 <= t <= 10^3), denoting the number of test cases. Description of the test cases follows.The first line of each test case contains one positive integer n (2 <= n <= 2 . 10^4) — length of the string.The second line of each test case contains a non-empty binary string of length n.It is guaranteed that the sum of n over all test cases does not exceed 10^5.",
    "sample_input": "le",
    "sample_output": "6\n101111\n9\n111000111\n8\n10000000\n5\n11011\n6\n001111\n3\n101\n30\n100000000000000100000000000000",
    "tags": ["constructive algorithms", "math", "*1500"]
  },
  {
    "name": "Scenes From a Memory",
    "question_id": "scenes-from-a-memory",
    "question": "During the hypnosis session, Nicholas suddenly remembered a positive integer n, which doesn't contain zeros in decimal notation. Soon, when he returned home, he got curious: what is the maximum number of digits that can be removed from the number so that the number becomes not prime, that is, either composite or equal to one?For some numbers doing so is impossible: for example, for number 53 it's impossible to delete some of its digits to obtain a not prime integer. However, for all n in the test cases of this problem, it's guaranteed that it's possible to delete some of their digits to obtain a not prime number.Note that you cannot remove all the digits from the number.A prime number is a number that has no divisors except one and itself. A composite is a number that has more than two divisors. 1 is neither a prime nor a composite number.",
    "input_details": "Each test contains multiple test cases.The first line contains one positive integer t (1 <= t <= 10^3), denoting the number of test cases. Description of the test cases follows.The first line of each test case contains one positive integer k (1 <= k <= 50) — the number of digits in the number.The second line of each test case contains a positive integer n, which doesn't contain zeros in decimal notation (10^{k-1} <= n < 10^{k}). It is guaranteed that it is always possible to remove less than k digits to make the number not prime.It is guaranteed that the sum of k over all test cases does not exceed 10^4.",
    "output_details": "For every test case, print two numbers in two lines. In the first line print the number of digits, that you have left in the number. In the second line print the digits left after all delitions. If there are multiple solutions, print any.",
    "sample_input": "7\n3\n237\n5\n44444\n3\n221\n2\n35\n3\n773\n1\n4\n30\n626221626221626221626221626221",
    "sample_output": "2\n27\n1\n4\n1\n1\n2\n35\n2\n77\n1\n4\n1\n6",
    "tags": [
      "brute force",
      "constructive algorithms",
      "implementation",
      "math",
      "number theory",
      "*1000"
    ]
  },
  {
    "name": "The Miracle and the Sleeper",
    "question_id": "the-miracle-and-the-sleeper",
    "question": "You are given two integers l and r, l<= r. Find the largest possible value of a mod b over all pairs (a, b) of integers for which r\\ge a \\ge b \\ge l.As a reminder, a mod b is a remainder we get when dividing a by b. For example, 26 mod 8 = 2.",
    "input_details": "Each test contains multiple test cases.The first line contains one positive integer t (1<= t<= 10^4), denoting the number of test cases. Description of the test cases follows.The only line of each test case contains two integers l, r (1<= l <= r <= 10^9).",
    "output_details": "For every test case, output the largest possible value of a mod b over all pairs (a, b) of integers for which r\\ge a \\ge b \\ge l.",
    "sample_input": "4\n1 1\n999999999 1000000000\n8 26\n1 999999999",
    "sample_output": "0\n1\n12\n499999999",
    "tags": ["greedy", "math", "*800"]
  },
  {
    "name": " Up the Strip (simplified version)",
    "question_id": "up-the-strip-simplified-version",
    "question": "This version of the problem differs from the next one only in the constraint on n.Note that the memory limit in this problem is lower than in others.You have a vertical strip with n cells, numbered consecutively from 1 to n from top to bottom.You also have a token that is initially placed in cell n. You will move the token up until it arrives at cell 1.Let the token be in cell x > 1 at some moment. One shift of the token can have either of the following kinds:   Subtraction: you choose an integer y between 1 and x-1, inclusive, and move the token from cell x to cell x - y.  Floored division: you choose an integer z between 2 and x, inclusive, and move the token from cell x to cell \\lfloor \\frac{x}{z} \\rfloor (x divided by z rounded down). Find the number of ways to move the token from cell n to cell 1 using one or more shifts, and print it modulo m. Note that if there are several ways to move the token from one cell to another in one shift, all these ways are considered distinct (check example explanation for a better understanding).",
    "input_details": "The only line contains two integers n and m (2 <= n <= 2 . 10^5; 10^8 < m < 10^9; m is a prime number) — the length of the strip and the modulo.",
    "output_details": "Print the number of ways to move the token from cell n to cell 1, modulo m.",
    "sample_input": "3 998244353",
    "sample_output": "5",
    "tags": [
      "brute force",
      "data structures",
      "dp",
      "math",
      "number theory",
      "*1700"
    ]
  },
  {
    "name": "Deep Down Below",
    "question_id": "deep-down-below",
    "question": "In a certain video game, the player controls a hero characterized by a single integer value: power. The hero will have to beat monsters that are also characterized by a single integer value: armor.On the current level, the hero is facing n caves. To pass the level, the hero must enter all the caves in some order, each cave exactly once, and exit every cave safe and sound. When the hero enters cave i, he will have to fight k_i monsters in a row: first a monster with armor a_{i, 1}, then a monster with armor a_{i, 2} and so on, finally, a monster with armor a_{i, k_i}.The hero can beat a monster if and only if the hero's power is strictly greater than the monster's armor. If the hero can't beat the monster he's fighting, the game ends and the player loses. Note that once the hero enters a cave, he can't exit it before he fights all the monsters in it, strictly in the given order.Each time the hero beats a monster, the hero's power increases by 1.Find the smallest possible power the hero must start the level with to be able to enter all the caves in some order and beat all the monsters.",
    "input_details": "Each test contains multiple test cases. The first line contains the number of test cases t (1 <= t <= 10^5). Description of the test cases follows.The first line of each test case contains a single integer n (1 <= n <= 10^5) — the number of caves.The i-th of the next n lines contains an integer k_i (1 <= k_i <= 10^5) — the number of monsters in the i-th cave, followed by k_i integers a_{i, 1}, a_{i, 2}, ...., a_{i, k_i} (1 <= a_{i, j} <= 10^9) — armor levels of the monsters in cave i in order the hero has to fight them.It is guaranteed that the sum of k_i over all test cases does not exceed 10^5.",
    "output_details": "For each test case print a single integer — the smallest possible power the hero must start the level with to be able to enter all the caves in some order and beat all the monsters.",
    "sample_input": "2\n1\n1 42\n2\n3 10 15 8\n2 12 11",
    "sample_output": "43\n13",
    "tags": ["binary search", "greedy", "sortings", "*1300"]
  },
  {
    "name": "Simply Strange Sort",
    "question_id": "simply-strange-sort",
    "question": "You have a permutation: an array a = [a_1, a_2, ...., a_n] of distinct integers from 1 to n. The length of the permutation n is odd.Consider the following algorithm of sorting the permutation in increasing order.A helper procedure of the algorithm, f(i), takes a single argument i (1 <= i <= n-1) and does the following. If a_i > a_{i+1}, the values of a_i and a_{i+1} are exchanged. Otherwise, the permutation doesn't change.The algorithm consists of iterations, numbered with consecutive integers starting with 1. On the i-th iteration, the algorithm does the following:   if i is odd, call f(1), f(3), ...., f(n - 2);  if i is even, call f(2), f(4), ...., f(n - 1). It can be proven that after a finite number of iterations the permutation will be sorted in increasing order.After how many iterations will this happen for the first time?",
    "input_details": "Each test contains multiple test cases. The first line contains the number of test cases t (1 <= t <= 100). Description of the test cases follows.The first line of each test case contains a single integer n (3 <= n <= 999; n is odd) — the length of the permutation.The second line contains n distinct integers a_1, a_2, ...., a_n (1 <= a_i <= n) — the permutation itself. It is guaranteed that the sum of n over all test cases does not exceed 999.",
    "output_details": "For each test case print the number of iterations after which the permutation will become sorted in increasing order for the first time.If the given permutation is already sorted, print 0.",
    "sample_input": "3\n3\n3 2 1\n7\n4 5 7 1 3 2 6\n5\n1 2 3 4 5",
    "sample_output": "3\n5\n0",
    "tags": ["brute force", "implementation", "sortings", "*800"]
  },
  {
    "name": " Nearest Beautiful Number (hard version)",
    "question_id": "nearest-beautiful-number-hard-version",
    "question": "It is a complicated version of problem F1. The difference between them is the constraints (F1: k <= 2, F2: k <= 10).You are given an integer n. Find the minimum integer x such that x \\ge n and the number x is k-beautiful.A number is called k-beautiful if its decimal representation having no leading zeroes contains no more than k different digits. E.g. if k = 2, the numbers 3434443, 55550, 777 and 21 are k-beautiful whereas the numbers 120, 445435 and 998244353 are not.",
    "input_details": "The first line contains one integer t (1 <= t <= 10^4) — the number of test cases. Then t test cases follow.Each test case consists of one line containing two integers n and k (1 <= n <= 10^9, 1 <= k <= 10).",
    "output_details": "For each test case output on a separate line x — the minimum k-beautiful integer such that x \\ge n.",
    "sample_input": "6\n2021 3\n177890 2\n34512 3\n724533 4\n998244353 1\n12345678 10",
    "sample_output": "2021\n181111\n34533\n724542\n999999999\n12345678",
    "tags": [
      "bitmasks",
      "brute force",
      "constructive algorithms",
      "dfs and similar",
      "dp",
      "greedy",
      "*2100"
    ]
  },
  {
    "name": " Nearest Beautiful Number (easy version)",
    "question_id": "nearest-beautiful-number-easy-version",
    "question": "It is a simplified version of problem F2. The difference between them is the constraints (F1: k <= 2, F2: k <= 10).You are given an integer n. Find the minimum integer x such that x \\ge n and the number x is k-beautiful.A number is called k-beautiful if its decimal representation having no leading zeroes contains no more than k different digits. E.g. if k = 2, the numbers 3434443, 55550, 777 and 21 are k-beautiful whereas the numbers 120, 445435 and 998244353 are not.",
    "input_details": "The first line contains one integer t (1 <= t <= 10^4) — the number of test cases. Then t test cases follow.Each test case consists of one line containing two integers n and k (1 <= n <= 10^9, 1 <= k <= 2).",
    "output_details": "For each test case output on a separate line x — the minimum k-beautiful integer such that x \\ge n.",
    "sample_input": "4\n1 1\n221 2\n177890 2\n998244353 1",
    "sample_output": "1\n221\n181111\n999999999",
    "tags": [
      "binary search",
      "bitmasks",
      "brute force",
      "constructive algorithms",
      "dfs and similar",
      "greedy",
      "*1900"
    ]
  },
  {
    "name": "Polycarp and String Transformation",
    "question_id": "polycarp-and-string-transformation",
    "question": "Polycarp has a string s. Polycarp performs the following actions until the string s is empty (t is initially an empty string):  he adds to the right to the string t the string s, i.e. he does t = t + s, where t + s is a concatenation of the strings t and s;  he selects an arbitrary letter of s and removes from s all its occurrences (the selected letter must occur in the string s at the moment of performing this action). Polycarp performs this sequence of actions strictly in this order.Note that after Polycarp finishes the actions, the string s will be empty and the string t will be equal to some value (that is undefined and depends on the order of removing).E.g. consider s=\"abacaba\" so the actions may be performed as follows:  t=\"abacaba\", the letter 'b' is selected, then s=\"aacaa\";  t=\"abacabaaacaa\", the letter 'a' is selected, then s=\"c\";  t=\"abacabaaacaac\", the letter 'c' is selected, then s=\"\" (the empty string). You need to restore the initial value of the string s using only the final value of t and find the order of removing letters from s.",
    "input_details": "The first line contains one integer T (1 <= T <= 10^4) — the number of test cases. Then T test cases follow.Each test case contains one string t consisting of lowercase letters of the Latin alphabet. The length of t doesn't exceed 5 . 10^5. The sum of lengths of all strings t in the test cases doesn't exceed 5 . 10^5.",
    "output_details": "For each test case output in a separate line:  -1, if the answer doesn't exist;  two strings separated by spaces. The first one must contain a possible initial value of s. The second one must contain a sequence of letters — it's in what order one needs to remove letters from s to make the string t. E.g. if the string \"bac\" is outputted, then, first, all occurrences of the letter 'b' were deleted, then all occurrences of 'a', and then, finally, all occurrences of 'c'. If there are multiple solutions, print any one. ",
    "sample_input": "7\nabacabaaacaac\nnowyouknowthat\npolycarppoycarppoyarppyarppyrpprppp\nisi\neverywherevrywhrvryhrvrhrvhv\nhaaha\nqweqeewew",
    "sample_output": "abacaba bac\n-1\npolycarp lcoayrp\nis si\neverywhere ewyrhv\n-1\n-1",
    "tags": ["binary search", "implementation", "sortings", "strings", "*1800"]
  },
  {
    "name": "Make a Power of Two",
    "question_id": "make-a-power-of-two",
    "question": "You are given an integer n. In 1 move, you can do one of the following actions:  erase any digit of the number (it's acceptable that the number before the operation has exactly one digit and after the operation, it is \"empty\");  add one digit to the right. The actions may be performed in any order any number of times.Note that if, after deleting some digit from a number, it will contain leading zeroes, they will not be deleted. E.g. if you delete from the number 301 the digit 3, the result is the number 01 (not 1).You need to perform the minimum number of actions to make the number any power of 2 (i.e. there's an integer k (k \\ge 0) such that the resulting number is equal to 2^k). The resulting number must not have leading zeroes.E.g. consider n=1052. The answer is equal to 2. First, let's add to the right one digit 4 (the result will be 10524). Then let's erase the digit 5, so the result will be 1024 which is a power of 2.E.g. consider n=8888. The answer is equal to 3. Let's erase any of the digits 8 three times. The result will be 8 which is a power of 2.",
    "input_details": "The first line contains one integer t (1 <= t <= 10^4) — the number of test cases. Then t test cases follow.Each test case consists of one line containing one integer n (1 <= n <= 10^9).",
    "output_details": "For each test case, output in a separate line one integer m — the minimum number of moves to transform the number into any power of 2.",
    "sample_input": "12\n1052\n8888\n6\n75\n128\n1\n301\n12048\n1504\n6656\n1000000000\n687194767",
    "sample_output": "2\n3\n1\n3\n0\n0\n2\n1\n3\n4\n9\n2",
    "tags": ["greedy", "math", "strings", "*1300"]
  },
  {
    "name": "Infinity Table",
    "question_id": "infinity-table",
    "question": "Polycarp has found a table having an infinite number of rows and columns. The rows are numbered from 1, starting from the topmost one. The columns are numbered from 1, starting from the leftmost one.Initially, the table hasn't been filled and Polycarp wants to fix it. He writes integers from 1 and so on to the table as follows.  The figure shows the placement of the numbers from 1 to 10. The following actions are denoted by the arrows. The leftmost topmost cell of the table is filled with the number 1. Then he writes in the table all positive integers beginning from 2 sequentially using the following algorithm.First, Polycarp selects the leftmost non-filled cell in the first row and fills it. Then, while the left neighbor of the last filled cell is filled, he goes down and fills the next cell. So he goes down until the last filled cell has a non-filled neighbor to the left (look at the vertical arrow going down in the figure above).After that, he fills the cells from the right to the left until he stops at the first column (look at the horizontal row in the figure above). Then Polycarp selects the leftmost non-filled cell in the first row, goes down, and so on.A friend of Polycarp has a favorite number k. He wants to know which cell will contain the number. Help him to find the indices of the row and the column, such that the intersection of the row and the column is the cell containing the number k.",
    "input_details": "The first line contains one integer t (1 <= t <= 100) — the number of test cases. Then t test cases follow.Each test case consists of one line containing one integer k (1 <= k <= 10^9) which location must be found.",
    "output_details": "For each test case, output in a separate line two integers r and c (r, c \\ge 1) separated by spaces — the indices of the row and the column containing the cell filled by the number k, respectively.",
    "sample_input": "7\n11\n14\n5\n4\n1\n2\n1000000000",
    "sample_output": "2 4\n4 3\n1 3\n2 1\n1 1\n1 2\n31623 14130",
    "tags": ["implementation", "math", "*800"]
  },
  {
    "name": "Who's Opposite?",
    "question_id": "whos-opposite",
    "question": "Some number of people (this number is even) have stood in a circle. The people stand in the circle evenly. They are numbered clockwise starting from a person with the number 1. Each person is looking through the circle's center at the opposite person.    A sample of a circle of 6 persons. The orange arrows indicate who is looking at whom. You don't know the exact number of people standing in the circle (but this number is even, no doubt). It is known that the person with the number a is looking at the person with the number b (and vice versa, of course). What is the number associated with a person being looked at by the person with the number c? If, for the specified a, b, and c, no such circle exists, output -1.",
    "input_details": "The first line contains one integer t (1 <= t <= 10^4) — the number of test cases. Then t test cases follow.Each test case consists of one line containing three distinct integers a, b, c (1 <= a,b,c <= 10^8).",
    "output_details": "For each test case output in a separate line a single integer d — the number of the person being looked at by the person with the number c in a circle such that the person with the number a is looking at the person with the number b. If there are multiple solutions, print any of them. Output -1 if there's no circle meeting the given conditions.",
    "sample_input": "7\n6 2 4\n2 3 1\n2 4 10\n5 3 4\n1 3 2\n2 5 4\n4 3 2",
    "sample_output": "8\n-1\n-1\n-1\n4\n1\n-1",
    "tags": ["math", "*800"]
  },
  {
    "name": "Dislike of Threes",
    "question_id": "dislike-of-threes",
    "question": "Polycarp doesn't like integers that are divisible by 3 or end with the digit 3 in their decimal representation. Integers that meet both conditions are disliked by Polycarp, too.Polycarp starts to write out the positive (greater than 0) integers which he likes: 1, 2, 4, 5, 7, 8, 10, 11, 14, 16, .... Output the k-th element of this sequence (the elements are numbered from 1).",
    "input_details": "The first line contains one integer t (1 <= t <= 100) — the number of test cases. Then t test cases follow.Each test case consists of one line containing one integer k (1 <= k <= 1000).",
    "output_details": "For each test case, output in a separate line one integer x — the k-th element of the sequence that was written out by Polycarp.",
    "sample_input": "10\n1\n2\n3\n4\n5\n6\n7\n8\n9\n1000",
    "sample_output": "1\n2\n4\n5\n7\n8\n10\n11\n14\n1666",
    "tags": ["implementation", "*800"]
  },
  {
    "name": "Mocha and Stars",
    "question_id": "mocha-and-stars",
    "question": "Mocha wants to be an astrologer. There are n stars which can be seen in Zhijiang, and the brightness of the i-th star is a_i. Mocha considers that these n stars form a constellation, and she uses (a_1,a_2,....,a_n) to show its state. A state is called mathematical if all of the following three conditions are satisfied:  For all i (1<= i<= n), a_i is an integer in the range [l_i, r_i]. \\sum \\limits _{i=1} ^ n a_i <= m. gcd(a_1,a_2,....,a_n)=1. Here, gcd(a_1,a_2,....,a_n) denotes the greatest common divisor (GCD) of integers a_1,a_2,....,a_n.Mocha is wondering how many different mathematical states of this constellation exist. Because the answer may be large, you must find it modulo 998\\,244\\,353.Two states (a_1,a_2,....,a_n) and (b_1,b_2,....,b_n) are considered different if there exists i (1<= i<= n) such that a_i \n b_i.",
    "input_details": "The first line contains two integers n and m (2 <= n <= 50, 1 <= m <= 10^5) — the number of stars and the upper bound of the sum of the brightness of stars.Each of the next n lines contains two integers l_i and r_i (1 <= l_i <= r_i <= m) — the range of the brightness of the i-th star.",
    "output_details": "Print a single integer — the number of different mathematical states of this constellation, modulo 998\\,244\\,353.",
    "sample_input": "2 4\n1 3\n1 2",
    "sample_output": "4",
    "tags": ["combinatorics", "dp", "fft", "math", "number theory", "*2200"]
  },
  {
    "name": " Mocha and Diana (Hard Version)",
    "question_id": "mocha-and-diana-hard-version",
    "question": "This is the hard version of the problem. The only difference between the two versions is the constraint on n. You can make hacks only if all versions of the problem are solved.A forest is an undirected graph without cycles (not necessarily connected).Mocha and Diana are friends in Zhijiang, both of them have a forest with nodes numbered from 1 to n, and they would like to add edges to their forests such that:   After adding edges, both of their graphs are still forests.  They add the same edges. That is, if an edge (u, v) is added to Mocha's forest, then an edge (u, v) is added to Diana's forest, and vice versa. Mocha and Diana want to know the maximum number of edges they can add, and which edges to add.",
    "input_details": "The first line contains three integers n, m_1 and m_2 (1 <= n <= 10^5, 0 <= m_1, m_2 < n) — the number of nodes and the number of initial edges in Mocha's forest and Diana's forest.Each of the next m_1 lines contains two integers u and v (1 <= u, v <= n, u \nq v) — the edges in Mocha's forest.Each of the next m_2 lines contains two integers u and v (1 <= u, v <= n, u \nq v) — the edges in Diana's forest.",
    "output_details": "The first line contains only one integer h, the maximum number of edges Mocha and Diana can add.Each of the next h lines contains two integers u and v (1 <= u, v <= n, u \nq v) — the edge you add each time.If there are multiple correct answers, you can print any one of them.",
    "sample_input": "3 2 2\n1 2\n2 3\n1 2\n1 3",
    "sample_output": "0",
    "tags": [
      "brute force",
      "constructive algorithms",
      "dfs and similar",
      "dsu",
      "graphs",
      "greedy",
      "trees",
      "two pointers",
      "*2500"
    ]
  },
  {
    "name": " Mocha and Diana (Easy Version)",
    "question_id": "mocha-and-diana-easy-version",
    "question": "This is the easy version of the problem. The only difference between the two versions is the constraint on n. You can make hacks only if all versions of the problem are solved.A forest is an undirected graph without cycles (not necessarily connected).Mocha and Diana are friends in Zhijiang, both of them have a forest with nodes numbered from 1 to n, and they would like to add edges to their forests such that:   After adding edges, both of their graphs are still forests.  They add the same edges. That is, if an edge (u, v) is added to Mocha's forest, then an edge (u, v) is added to Diana's forest, and vice versa. Mocha and Diana want to know the maximum number of edges they can add, and which edges to add.",
    "input_details": "The first line contains three integers n, m_1 and m_2 (1 <= n <= 1000, 0 <= m_1, m_2 < n) — the number of nodes and the number of initial edges in Mocha's forest and Diana's forest.Each of the next m_1 lines contains two integers u and v (1 <= u, v <= n, u \nq v) — the edges in Mocha's forest.Each of the next m_2 lines contains two integers u and v (1 <= u, v <= n, u \nq v) — the edges in Diana's forest.",
    "output_details": "The first line contains only one integer h, the maximum number of edges Mocha and Diana can add (in each forest).Each of the next h lines contains two integers u and v (1 <= u, v <= n, u \nq v) — the edge you add each time.If there are multiple correct answers, you can print any one of them.",
    "sample_input": "3 2 2\n1 2\n2 3\n1 2\n1 3",
    "sample_output": "0",
    "tags": [
      "brute force",
      "constructive algorithms",
      "dsu",
      "graphs",
      "greedy",
      "trees",
      "*1400"
    ]
  },
  {
    "name": "Mocha and Hiking",
    "question_id": "mocha-and-hiking",
    "question": "The city where Mocha lives in is called Zhijiang. There are n+1 villages and 2n-1 directed roads in this city. There are two kinds of roads:  n-1 roads are from village i to village i+1, for all 1<= i <= n-1.  n roads can be described by a sequence a_1,....,a_n. If a_i=0, the i-th of these roads goes from village i to village n+1, otherwise it goes from village n+1 to village i, for all 1<= i<= n. Mocha plans to go hiking with Taki this weekend. To avoid the trip being boring, they plan to go through every village exactly once. They can start and finish at any villages. Can you help them to draw up a plan? ",
    "input_details": "Each test contains multiple test cases. The first line contains a single integer t (1 <= t <= 20) — the number of test cases. Each test case consists of two lines.The first line of each test case contains a single integer n (1 <= n <= 10^4) — indicates that the number of villages is n+1.The second line of each test case contains n integers a_1, a_2, ...., a_n (0 <= a_i <= 1). If a_i=0, it means that there is a road from village i to village n+1. If a_i=1, it means that there is a road from village n+1 to village i.It is guaranteed that the sum of n over all test cases does not exceed 10^4.",
    "output_details": "For each test case, print a line with n+1 integers, where the i-th number is the i-th village they will go through. If the answer doesn't exist, print -1.If there are multiple correct answers, you can print any one of them.",
    "sample_input": "2\n3\n0 1 0\n3\n1 1 0",
    "sample_output": "1 4 2 3 \n4 1 2 3",
    "tags": ["constructive algorithms", "graphs", "*1200"]
  },
  {
    "name": "Mocha and Red and Blue",
    "question_id": "mocha-and-red-and-blue",
    "question": "As their story unravels, a timeless tale is told once again...Shirahime, a friend of Mocha's, is keen on playing the music game Arcaea and sharing Mocha interesting puzzles to solve. This day, Shirahime comes up with a new simple puzzle and wants Mocha to solve them. However, these puzzles are too easy for Mocha to solve, so she wants you to solve them and tell her the answers. The puzzles are described as follow.There are n squares arranged in a row, and each of them can be painted either red or blue.Among these squares, some of them have been painted already, and the others are blank. You can decide which color to paint on each blank square.Some pairs of adjacent squares may have the same color, which is imperfect. We define the imperfectness as the number of pairs of adjacent squares that share the same color.For example, the imperfectness of \"BRRRBBR\" is 3, with \"BB\" occurred once and \"RR\" occurred twice.Your goal is to minimize the imperfectness and print out the colors of the squares after painting. ",
    "input_details": "Each test contains multiple test cases. The first line contains a single integer t (1 <= t <= 100) — the number of test cases. Each test case consists of two lines.The first line of each test case contains an integer n (1<= n<= 100) — the length of the squares row.The second line of each test case contains a string s with length n, containing characters 'B', 'R' and '?'. Here 'B' stands for a blue square, 'R' for a red square, and '?' for a blank square.",
    "output_details": "For each test case, print a line with a string only containing 'B' and 'R', the colors of the squares after painting, which imperfectness is minimized. If there are multiple solutions, print any of them.",
    "sample_input": "5\n7\n?R???BR\n7\n???R???\n1\n?\n1\nB\n10\n?R??RB??B?",
    "sample_output": "BRRBRBR\nBRBRBRB\nB\nB\nBRRBRBBRBR",
    "tags": ["dp", "greedy", "*900"]
  },
  {
    "name": "Mocha and Math",
    "question_id": "mocha-and-math",
    "question": "Mocha is a young girl from high school. She has learned so much interesting knowledge from her teachers, especially her math teacher. Recently, Mocha is learning about binary system and very interested in bitwise operation.This day, Mocha got a sequence a of length n. In each operation, she can select an arbitrary interval [l, r] and for all values i (0<= i <= r-l), replace a_{l+i} with a_{l+i} \\,\\&\\, a_{r-i} at the same time, where \\& denotes the bitwise AND operation. This operation can be performed any number of times.For example, if n=5, the array is [a_1,a_2,a_3,a_4,a_5], and Mocha selects the interval [2,5], then the new array is [a_1,a_2\\,\\&\\, a_5, a_3\\,\\&\\, a_4, a_4\\,\\&\\, a_3, a_5\\,\\&\\, a_2].Now Mocha wants to minimize the maximum value in the sequence. As her best friend, can you help her to get the answer?",
    "input_details": "Each test contains multiple test cases. The first line contains a single integer t (1 <= t <= 100) — the number of test cases. Each test case consists of two lines.The first line of each test case contains a single integer n (1 <= n <= 100) — the length of the sequence.The second line of each test case contains n integers a_1, a_2, ...., a_n (0 <= a_i <= 10^9).",
    "output_details": "For each test case, print one integer — the minimal value of the maximum value in the sequence.",
    "sample_input": "4\n2\n1 2\n3\n1 1 3\n4\n3 11 3 7\n5\n11 7 15 3 7",
    "sample_output": "0\n1\n3\n3",
    "tags": ["bitmasks", "constructive algorithms", "math", "*900"]
  },
  {
    "name": "Strange Sort",
    "question_id": "strange-sort",
    "question": "You have a permutation: an array a = [a_1, a_2, ...., a_n] of distinct integers from 1 to n. The length of the permutation n is odd.Consider the following algorithm of sorting the permutation in increasing order.A helper procedure of the algorithm, f(i), takes a single argument i (1 <= i <= n-1) and does the following. If a_i > a_{i+1}, the values of a_i and a_{i+1} are exchanged. Otherwise, the permutation doesn't change.The algorithm consists of iterations, numbered with consecutive integers starting with 1. On the i-th iteration, the algorithm does the following:   if i is odd, call f(1), f(3), ...., f(n - 2);  if i is even, call f(2), f(4), ...., f(n - 1). It can be proven that after a finite number of iterations the permutation will be sorted in increasing order.After how many iterations will this happen for the first time?",
    "input_details": "Each test contains multiple test cases. The first line contains the number of test cases t (1 <= t <= 10^4). Description of the test cases follows.The first line of each test case contains a single integer n (3 <= n <= 2 . 10^5 - 1; n is odd) — the length of the permutation.The second line contains n distinct integers a_1, a_2, ...., a_n (1 <= a_i <= n) — the permutation itself. It is guaranteed that the sum of n over all test cases does not exceed 2 . 10^5 - 1.",
    "output_details": "For each test case print the number of iterations after which the permutation will become sorted in increasing order for the first time.If the given permutation is already sorted, print 0.",
    "sample_input": "3\n3\n3 2 1\n7\n4 5 7 1 3 2 6\n5\n1 2 3 4 5",
    "sample_output": "3\n5\n0",
    "tags": ["data structures", "sortings", "*3300"]
  },
  {
    "name": "Down Below",
    "question_id": "down-below",
    "question": "In a certain video game, the player controls a hero characterized by a single integer value: power.On the current level, the hero got into a system of n caves numbered from 1 to n, and m tunnels between them. Each tunnel connects two distinct caves. Any two caves are connected with at most one tunnel. Any cave can be reached from any other cave by moving via tunnels.The hero starts the level in cave 1, and every other cave contains a monster.The hero can move between caves via tunnels. If the hero leaves a cave and enters a tunnel, he must finish his movement and arrive at the opposite end of the tunnel.The hero can use each tunnel to move in both directions. However, the hero can not use the same tunnel twice in a row. Formally, if the hero has just moved from cave i to cave j via a tunnel, he can not head back to cave i immediately after, but he can head to any other cave connected to cave j with a tunnel.It is known that at least two tunnels come out of every cave, thus, the hero will never find himself in a dead end even considering the above requirement.To pass the level, the hero must beat the monsters in all the caves. When the hero enters a cave for the first time, he will have to fight the monster in it. The hero can beat the monster in cave i if and only if the hero's power is strictly greater than a_i. In case of beating the monster, the hero's power increases by b_i. If the hero can't beat the monster he's fighting, the game ends and the player loses.After the hero beats the monster in cave i, all subsequent visits to cave i won't have any consequences: the cave won't have any monsters, and the hero's power won't change either.Find the smallest possible power the hero must start the level with to be able to beat all the monsters and pass the level.",
    "input_details": "Each test contains multiple test cases. The first line contains the number of test cases t (1 <= t <= 100). Description of the test cases follows.The first line of each test case contains two integers n and m (3 <= n <= 1000; n <= m <= min(\\frac{n(n-1)}{2}, 2000)) — the number of caves and tunnels.The second line contains n-1 integers a_2, a_3, ...., a_n (1 <= a_i <= 10^9) — values the hero's power are compared to while fighting monsters in caves 2, 3, ...., n.The third line contains n-1 integers b_2, b_3, ...., b_n (1 <= b_i <= 10^9) — increases applied to the hero's power for beating monsters in caves 2, 3, ...., n.Each of the next m lines contains two integers u_i and v_i (1 <= u_i, v_i <= n; u_i \n v_i) — the numbers of caves connected with a tunnel.No two caves are connected with more than one tunnel. Any cave can be reached from any other cave by moving via tunnels. At least two tunnels come out of every cave.It is guaranteed that the sum of n over all test cases does not exceed 1000, and the sum of m over all test cases does not exceed 2000.",
    "output_details": "For each test case print a single integer — the smallest possible power the hero must start the level with to be able to beat all the monsters and pass the level.",
    "sample_input": "3\n4 4\n11 22 13\n8 7 5\n1 2\n2 3\n3 4\n4 1\n4 4\n11 22 13\n5 7 8\n1 2\n2 3\n3 4\n4 1\n5 7\n10 40 20 30\n7 2 10 5\n1 2\n1 5\n2 3\n2 4\n2 5\n3 4\n4 5",
    "sample_output": "15\n15\n19",
    "tags": [
      "binary search",
      "dfs and similar",
      "graphs",
      "greedy",
      "meet-in-the-middle",
      "shortest paths",
      "*3000"
    ]
  },
  {
    "name": "Top-Notch Insertions",
    "question_id": "top-notch-insertions",
    "question": "Consider the insertion sort algorithm used to sort an integer sequence [a_1, a_2, ...., a_n] of length n in non-decreasing order.For each i in order from 2 to n, do the following. If a_i \\ge a_{i-1}, do nothing and move on to the next value of i. Otherwise, find the smallest j such that a_i < a_j, shift the elements on positions from j to i-1 by one position to the right, and write down the initial value of a_i to position j. In this case we'll say that we performed an insertion of an element from position i to position j.It can be noticed that after processing any i, the prefix of the sequence [a_1, a_2, ...., a_i] is sorted in non-decreasing order, therefore, the algorithm indeed sorts any sequence.For example, sorting [4, 5, 3, 1, 3] proceeds as follows:   i = 2: a_2 \\ge a_1, do nothing;  i = 3: j = 1, insert from position 3 to position 1: [3, 4, 5, 1, 3];  i = 4: j = 1, insert from position 4 to position 1: [1, 3, 4, 5, 3];  i = 5: j = 3, insert from position 5 to position 3: [1, 3, 3, 4, 5]. You are given an integer n and a list of m integer pairs (x_i, y_i). We are interested in sequences such that if you sort them using the above algorithm, exactly m insertions will be performed: first from position x_1 to position y_1, then from position x_2 to position y_2, ..., finally, from position x_m to position y_m.How many sequences of length n consisting of (not necessarily distinct) integers between 1 and n, inclusive, satisfy the above condition? Print this number modulo 998\\,244\\,353.",
    "input_details": "Each test contains multiple test cases. The first line contains the number of test cases t (1 <= t <= 10^5). Description of the test cases follows.The first line of each test case contains two integers n and m (2 <= n <= 2 . 10^5; 0 <= m < n) — the length of the sequence and the number of insertions.The i-th of the following m lines contains two integers x_i and y_i (2 <= x_1 < x_2 < .... < x_m <= n; 1 <= y_i < x_i). These lines describe the sequence of insertions in chronological order.It is guaranteed that the sum of m over all test cases does not exceed 2 . 10^5. Note that there is no constraint on the sum of n of the same kind.",
    "output_details": "For each test case, print the number of sequences of length n consisting of integers from 1 to n such that sorting them with the described algorithm produces the given sequence of insertions, modulo 998\\,244\\,353.",
    "sample_input": "3\n3 0\n3 2\n2 1\n3 1\n5 3\n3 1\n4 1\n5 3",
    "sample_output": "10\n1\n21",
    "tags": ["combinatorics", "data structures", "*2600"]
  },
  {
    "name": "Bottom-Tier Reversals",
    "question_id": "bottom-tier-reversals",
    "question": "You have a permutation: an array a = [a_1, a_2, ...., a_n] of distinct integers from 1 to n. The length of the permutation n is odd.You need to sort the permutation in increasing order.In one step, you can choose any prefix of the permutation with an odd length and reverse it. Formally, if a = [a_1, a_2, ...., a_n], you can choose any odd integer p between 1 and n, inclusive, and set a to [a_p, a_{p-1}, ...., a_1, a_{p+1}, a_{p+2}, ...., a_n].Find a way to sort a using no more than \\frac{5n}{2} reversals of the above kind, or determine that such a way doesn't exist. The number of reversals doesn't have to be minimized.",
    "input_details": "Each test contains multiple test cases. The first line contains the number of test cases t (1 <= t <= 100). Description of the test cases follows.The first line of each test case contains a single integer n (3 <= n <= 2021; n is odd) — the length of the permutation.The second line contains n distinct integers a_1, a_2, ...., a_n (1 <= a_i <= n) — the permutation itself. It is guaranteed that the sum of n over all test cases does not exceed 2021.",
    "output_details": "For each test case, if it's impossible to sort the given permutation in at most \\frac{5n}{2} reversals, print a single integer -1.Otherwise, print an integer m (0 <= m <= \\frac{5n}{2}), denoting the number of reversals in your sequence of steps, followed by m integers p_i (1 <= p_i <= n; p_i is odd), denoting the lengths of the prefixes of a to be reversed, in chronological order.Note that m doesn't have to be minimized. If there are multiple answers, print any.",
    "sample_input": "3\n3\n1 2 3\n5\n3 4 5 2 1\n3\n2 1 3",
    "sample_output": "4\n3 3 3 3\n2\n3 5\n-1",
    "tags": ["constructive algorithms", "greedy", "*2000"]
  },
  {
    "name": "Up the Strip",
    "question_id": "up-the-strip",
    "question": "Note that the memory limit in this problem is lower than in others.You have a vertical strip with n cells, numbered consecutively from 1 to n from top to bottom.You also have a token that is initially placed in cell n. You will move the token up until it arrives at cell 1.Let the token be in cell x > 1 at some moment. One shift of the token can have either of the following kinds:   Subtraction: you choose an integer y between 1 and x-1, inclusive, and move the token from cell x to cell x - y.  Floored division: you choose an integer z between 2 and x, inclusive, and move the token from cell x to cell \\lfloor \\frac{x}{z} \\rfloor (x divided by z rounded down). Find the number of ways to move the token from cell n to cell 1 using one or more shifts, and print it modulo m. Note that if there are several ways to move the token from one cell to another in one shift, all these ways are considered distinct (check example explanation for a better understanding).",
    "input_details": "The only line contains two integers n and m (2 <= n <= 4 . 10^6; 10^8 < m < 10^9; m is a prime number) — the length of the strip and the modulo.",
    "output_details": "Print the number of ways to move the token from cell n to cell 1, modulo m.",
    "sample_input": "3 998244353",
    "sample_output": "5",
    "tags": [
      "brute force",
      "dp",
      "math",
      "number theory",
      "two pointers",
      "*1900"
    ]
  },
  {
    "name": "Charmed by the Game",
    "question_id": "charmed-by-the-game",
    "question": "Alice and Borys are playing tennis.A tennis match consists of games. In each game, one of the players is serving and the other one is receiving.Players serve in turns: after a game where Alice is serving follows a game where Borys is serving, and vice versa.Each game ends with a victory of one of the players. If a game is won by the serving player, it's said that this player holds serve. If a game is won by the receiving player, it's said that this player breaks serve.It is known that Alice won a games and Borys won b games during the match. It is unknown who served first and who won which games.Find all values of k such that exactly k breaks could happen during the match between Alice and Borys in total.",
    "input_details": "Each test contains multiple test cases. The first line contains the number of test cases t (1 <= t <= 10^3). Description of the test cases follows.Each of the next t lines describes one test case and contains two integers a and b (0 <= a, b <= 10^5; a + b > 0) — the number of games won by Alice and Borys, respectively.It is guaranteed that the sum of a + b over all test cases does not exceed 2 . 10^5.",
    "output_details": "For each test case print two lines.In the first line, print a single integer m (1 <= m <= a + b + 1) — the number of values of k such that exactly k breaks could happen during the match.In the second line, print m distinct integers k_1, k_2, ...., k_m (0 <= k_1 < k_2 < .... < k_m <= a + b) — the sought values of k in increasing order.",
    "sample_input": "3\n2 1\n1 1\n0 5",
    "sample_output": "4\n0 1 2 3\n2\n0 2\n2\n2 3",
    "tags": ["brute force", "math", "*1300"]
  },
  {
    "name": "Assiut Chess",
    "question_id": "assiut-chess",
    "question": "This is an interactive problem.ICPC Assiut Community decided to hold a unique chess contest, and you were chosen to control a queen and hunt down the hidden king, while a member of ICPC Assiut Community controls this king.You compete on an 8*8 chessboard, the rows are numerated from top to bottom, and the columns are numerated left to right, and the cell in row x and column y is denoted as (x, y).In one turn you can move the queen to any of the squares on the same horizontal line, vertical line, or any of the diagonals. For example, if the queen was on square (4, 5), you can move to (q_1, 5), (4, q_1), (q_1, 9-q_1), or (q_2, q_2+1) where (1 <= q_1 <= 8, q_1 \n 4, 1 <= q_2 <= 7, q_2 \n 4). Note that the queen cannot stay on its current cell.   In one turn, the king can move \"Right\", \"Left\", \"Up\", \"Down\", \"Down-Right\", \"Down-Left\", \"Up-Left\", or \"Up-Right\" such that he doesn't get out of the board. The king cannot move into a cell that is on the same row, column or diagonal with the queen (including the position of the queen itself). For example, if the king was on square (4, 5), he can move to (4+k_1, 5+k_2) where (-1 <= k_1,k_2 <= 1, (k_1, k_2) \n (0, 0)).   At the start of the game, you should place the queen at any location on the board, and this is done once per game. After that the king is secretly placed at any cell different from the queen's location. You do not know the position of the king. Then, the king and the queen take turns with the king moving first. The king moves to one of the possible directions (\"Right\", \"Down\", \"Up-Left\", etc.), and you are only given the direction it moves to. After that, you should move your queen by declaring the square to which your queen will move. The game follows like this until you win the game or run out of moves.You win if the king has no valid moves. You lose if after 130 moves of the queen the king still has valid moves.",
    "input_details": "The first line contains a single integer t (1 <= t <= 60) — the number of test cases.",
    "output_details": "ctionIn each test case, you should print the queen's starting cell immediately. If you placed the queen at the king's cell, you will win immediately.After that, you may make at most 130 moves. Each move is made in the format x y, where x and y are two integers (1 <= x,y <= 8) that denote the new row and column of the queen respectively. Your move should be a valid queen move.After the initial queen placement and after each move you will receive a string s that represents the direction of the king's move. It will be one of the following: \"Right\", \"Left\", \"Up\", \"Down\", \"Down-Right\", \"Down-Left\", \"Up-Left\", \"Up-Right\", or \"Done\" if you win the game. You should consider \"Done\" as the end of each test case.After printing a query do not forget to output end of line and flush the output. Otherwise, you will get Idleness limit exceeded. To do this, use: fflush(stdout) or cout.flush() in C++; System.out.flush() in Java; flush(output) in Pascal; stdout.flush() in Python; see documentation for other languages.If at any point you make an invalid query or try to make more than 130 queries for each test case, the game will terminate immediately and you will receive a Wrong Answer verdict.",
    "sample_input": "1\nLeft\nRight\nDone",
    "sample_output": "7 5\n7 6\n7 7",
    "tags": ["brute force", "constructive algorithms", "interactive", "*2800"]
  },
  {
    "name": "Ezzat and Grid",
    "question_id": "ezzat-and-grid",
    "question": "Moamen was drawing a grid of n rows and 10^9 columns containing only digits 0 and 1. Ezzat noticed what Moamen was drawing and became interested in the minimum number of rows one needs to remove to make the grid beautiful.A grid is beautiful if and only if for every two consecutive rows there is at least one column containing 1 in these two rows.Ezzat will give you the number of rows n, and m segments of the grid that contain digits 1. Every segment is represented with three integers i, l, and r, where i represents the row number, and l and r represent the first and the last column of the segment in that row.For example, if n = 3, m = 6, and the segments are (1,1,1), (1,7,8), (2,7,7), (2,15,15), (3,1,1), (3,15,15), then the grid is:  Your task is to tell Ezzat the minimum number of rows that should be removed to make the grid beautiful.",
    "input_details": "The first line contains two integers n and m (1 <= n, m <= 3.10^5).Each of the next m lines contains three integers i, l, and r (1 <= i <= n, 1 <= l <= r <= 10^9). Each of these m lines means that row number i contains digits 1 in columns from l to r, inclusive.Note that the segments may overlap.",
    "output_details": "In the first line, print a single integer k — the minimum number of rows that should be removed.In the second line print k distinct integers r_1, r_2, ...., r_k, representing the rows that should be removed (1 <= r_i <= n), in any order.If there are multiple answers, print any.",
    "sample_input": "3 6\n1 1 1\n1 7 8\n2 7 7\n2 15 15\n3 1 1\n3 15 15",
    "sample_output": "0",
    "tags": ["data structures", "dp", "greedy", "*2200"]
  },
  {
    "name": "Moamen and XOR",
    "question_id": "moamen-and-xor",
    "question": "Moamen and Ezzat are playing a game. They create an array a of n non-negative integers where every element is less than 2^k.Moamen wins if a_1 \\,\\&\\, a_2 \\,\\&\\, a_3 \\,\\&\\, .... \\,\\&\\, a_n \\ge a_1 \\oplus a_2 \\oplus a_3 \\oplus .... \\oplus a_n.Here \\& denotes the bitwise AND operation, and \\oplus denotes the bitwise XOR operation.Please calculate the number of winning for Moamen arrays a.As the result may be very large, print the value modulo 1\\,000\\,000\\,007 (10^9 + 7).",
    "input_details": "The first line contains a single integer t (1 <= t <= 5)— the number of test cases. Each test case consists of one line containing two integers n and k (1 <= n<= 2. 10^5, 0 <= k <= 2. 10^5).",
    "output_details": "For each test case, print a single value — the number of different arrays that Moamen wins with.Print the result modulo 1\\,000\\,000\\,007 (10^9 + 7).",
    "sample_input": "3\n3 1\n2 1\n4 0",
    "sample_output": "5\n2\n1",
    "tags": ["bitmasks", "combinatorics", "dp", "math", "matrices", "*1700"]
  },
  {
    "name": "Moamen and k-subarrays",
    "question_id": "moamen-and-k-subarrays",
    "question": "Moamen has an array of n distinct integers. He wants to sort that array in non-decreasing order by doing the following operations in order exactly once:  Split the array into exactly k non-empty subarrays such that each element belongs to exactly one subarray.  Reorder these subarrays arbitrary.  Merge the subarrays in their new order. A sequence a is a subarray of a sequence b if a can be obtained from b by deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end.Can you tell Moamen if there is a way to sort the array in non-decreasing order using the operations written above?",
    "input_details": "The first line contains a single integer t (1 <= t <= 10^3) — the number of test cases. The description of the test cases follows.The first line of each test case contains two integers n and k (1 <= k <= n <= 10^5).The second line contains n integers a_1, a_2, ...., a_n (0 <= |a_i| <= 10^9). It is guaranteed that all numbers are distinct.It is guaranteed that the sum of n over all test cases does not exceed 3.10^5.",
    "output_details": "For each test case, you should output a single string.If Moamen can sort the array in non-decreasing order, output \"YES\" (without quotes). Otherwise, output \"NO\" (without quotes).You can print each letter of \"YES\" and \"NO\" in any case (upper or lower).",
    "sample_input": "3\n5 4\n6 3 4 2 1\n4 2\n1 -4 0 -2\n5 1\n1 2 3 4 5",
    "sample_output": "Yes\nNo\nYes",
    "tags": ["greedy", "sortings", "*1100"]
  },
  {
    "name": "Ezzat and Two Subsequences",
    "question_id": "ezzat-and-two-subsequences",
    "question": "Ezzat has an array of n integers (maybe negative). He wants to split it into two non-empty subsequences a and b, such that every element from the array belongs to exactly one subsequence, and the value of f(a) + f(b) is the maximum possible value, where f(x) is the average of the subsequence x. A sequence x is a subsequence of a sequence y if x can be obtained from y by deletion of several (possibly, zero or all) elements.The average of a subsequence is the sum of the numbers of this subsequence divided by the size of the subsequence.For example, the average of [1,5,6] is (1+5+6)/3 = 12/3 = 4, so f([1,5,6]) = 4.",
    "input_details": "The first line contains a single integer t (1 <= t <= 10^3)— the number of test cases. Each test case consists of two lines.The first line contains a single integer n (2 <= n <= 10^5).The second line contains n integers a_1, a_2, ...., a_n (-10^9 <= a_i <= 10^9).It is guaranteed that the sum of n over all test cases does not exceed 3.10^5.",
    "output_details": "For each test case, print a single value — the maximum value that Ezzat can achieve.Your answer is considered correct if its absolute or relative error does not exceed 10^{-6}.Formally, let your answer be a, and the jury's answer be b. Your answer is accepted if and only if \\frac{|a - b|}{\\max{(1, |b|)}} <= 10^{-6}.",
    "sample_input": "4\n3\n3 1 2\n3\n-7 -6 -6\n3\n2 2 2\n4\n17 3 5 -3",
    "sample_output": "4.500000000\n-12.500000000\n4.000000000\n18.666666667",
    "tags": ["brute force", "math", "sortings", "*800"]
  },
  {
    "name": "DIY Tree",
    "question_id": "diy-tree",
    "question": "  William really likes puzzle kits. For one of his birthdays, his friends gifted him a complete undirected edge-weighted graph consisting of n vertices.He wants to build a spanning tree of this graph, such that for the first k vertices the following condition is satisfied: the degree of a vertex with index i does not exceed d_i. Vertices from k + 1 to n may have any degree.William wants you to find the minimum weight of a spanning tree that satisfies all the conditions.A spanning tree is a subset of edges of a graph that forms a tree on all n vertices of the graph. The weight of a spanning tree is defined as the sum of weights of all the edges included in a spanning tree.",
    "input_details": "The first line of input contains two integers n, k (2 <= n <= 50, 1 <= k <= min(n - 1, 5)).The second line contains k integers d_1, d_2, ...., d_k (1 <= d_i <= n). The i-th of the next n - 1 lines contains n - i integers w_{i,i+1}, w_{i,i+2}, ...., w_{i,n} (1 <= w_{i,j} <= 100): weights of edges (i,i+1),(i,i+2),....,(i,n).",
    "output_details": "Print one integer: the minimum weight of a spanning tree under given degree constraints for the first k vertices. ",
    "sample_input": "10 5\n5 3 4 2 1\n29 49 33 12 55 15 32 62 37\n61 26 15 58 15 22 8 58\n37 16 9 39 20 14 58\n10 15 40 3 19 55\n53 13 37 44 52\n23 59 58 4\n69 80 29\n89 28\n48",
    "sample_output": "95",
    "tags": ["graphs", "greedy", "math", "probabilities", "*3300"]
  },
  {
    "name": "Gates to Another World",
    "question_id": "gates-to-another-world",
    "question": "  As mentioned previously William really likes playing video games. In one of his favorite games, the player character is in a universe where every planet is designated by a binary number from 0 to 2^n - 1. On each planet, there are gates that allow the player to move from planet i to planet j if the binary representations of i and j differ in exactly one bit.William wants to test you and see how you can handle processing the following queries in this game universe:  Destroy planets with numbers from l to r inclusively. These planets cannot be moved to anymore. Figure out if it is possible to reach planet b from planet a using some number of planetary gates. It is guaranteed that the planets a and b are not destroyed. ",
    "input_details": "The first line contains two integers n, m (1 <= n <= 50, 1 <= m <= 5 . 10^4), which are the number of bits in binary representation of each planets' designation and the number of queries, respectively.Each of the next m lines contains a query of two types:block l r — query for destruction of planets with numbers from l to r inclusively (0 <= l <= r < 2^n). It's guaranteed that no planet will be destroyed twice.ask a b — query for reachability between planets a and b (0 <= a, b < 2^n). It's guaranteed that planets a and b hasn't been destroyed yet.",
    "output_details": "For each query of type ask you must output \"1\" in a new line, if it is possible to reach planet b from planet a and \"0\" otherwise (without quotation marks).",
    "sample_input": "3 3\nask 0 7\nblock 3 6\nask 0 7",
    "sample_output": "1\n0",
    "tags": ["bitmasks", "data structures", "dsu", "two pointers", "*3300"]
  }
]
